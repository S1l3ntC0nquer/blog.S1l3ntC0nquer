<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>All-in-One PicoCTF Writeups: Crypto | CX330</title><meta name="keywords" content="資安,PicoCTF"><meta name="author" content="CX330"><meta name="copyright" content="CX330"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="All-in-One PicoCTF Writeups: Crypto"><meta name="application-name" content="All-in-One PicoCTF Writeups: Crypto"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="All-in-One PicoCTF Writeups: Crypto"><meta property="og:url" content="https://blog.cx330.tw/posts/624b1c44/index.html"><meta property="og:site_name" content="CX330"><meta property="og:description" content="前言 其實好像也沒什麼好講前言的，但就是不想要一開始就是題目分類，所以還是放了個前言 XD。 自己在刷 PicoCTF 的時候常常發現，幾乎所有的 writeup 都是英文的居多，所以想說來寫個完整一點的中文版！總之呢這裡就是會盡量彙整所有的 picoCTF 的題目在這邊（但是因為已經寫了 60 題"><meta property="og:locale" content="en"><meta property="og:image" content="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"><meta property="article:author" content="CX330"><meta property="article:tag" content="CX330, 陳子雋, CX330 universe, CX330 Blog, Blog, CTF, CX330 hacker, hacker, 資安, 駭客, 黑客, 程式設計, 程式設計師, 程式設計博客, 程式設計部落格, 程式設計日誌, 程式設計師日誌, 程式設計部落格日誌, Blake Chen"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"><meta name="description" content="前言 其實好像也沒什麼好講前言的，但就是不想要一開始就是題目分類，所以還是放了個前言 XD。 自己在刷 PicoCTF 的時候常常發現，幾乎所有的 writeup 都是英文的居多，所以想說來寫個完整一點的中文版！總之呢這裡就是會盡量彙整所有的 picoCTF 的題目在這邊（但是因為已經寫了 60 題"><link rel="shortcut icon" href="/assets/favicon.ico"><link rel="canonical" href="https://blog.cx330.tw/posts/624b1c44/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload='this.media="all"'><script async src="https://www.googletagmanager.com/gtag/js?id=G-PM5RRNPNEB"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PM5RRNPNEB")</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={linkPageTop:{enable:!0,title:"Connect with others",addFriendPlaceholder:"Nickname：\nSite URL：\nAvatar URL：\nDescription："},peoplecanvas:void 0,postHeadAiDescription:{enable:!0,gptName:"CX330",mode:"local",switchBtn:!1,btnLink:"https://afdian.net/item/886a79d4db6711eda42a52540025c377",randomNum:3,basicWordCount:1e3,key:"xxxx",Referer:"https://xx.xx/"},diytitle:void 0,LA51:void 0,greetingBox:void 0,twikooEnvId:"https://comments.cx330.tw/",commentBarrageConfig:{enable:!0,maxBarrage:1,barrageTime:8e3,accessToken:"8e5a0f02d2d6b6604e700a856bf586e7",mailMd5:"25de757f9696b310771b584e7bf5b238"},root:"/",preloader:{source:3},friends_vue_info:void 0,navMusic:!0,mainTone:{mode:"api",api:"https://img2color.cx330.tw/api?img=",cover_change:!0},authorStatus:{skills:["Hacker","CTFer","Developer","Programmer",1337]},algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"We didn't find any results for the search: ${query}"}},translate:{defaultEncoding:1,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"简",rightMenuMsgToTraditionalChinese:"Simp / Trad",rightMenuMsgToSimplifiedChinese:"Simp / Trad"},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:330},copy:{success:"Copy successfully",error:"Copy error",noSupport:"The browser does not support"},relativeDate:{homepage:!1,simplehomepage:!0,post:!1},runtime:"days",date_suffix:{just:"Just",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:{copy:!0,copyrightEbable:!1,limitCount:50,languages:{author:"Author: CX330",link:"Link: ",source:"Source: CX330",info:"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.",copySuccess:"Copy success, copy and reprint please mark the address of this article"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"Traditional Chinese Activated Manually",cht_to_chs:"Simplified Chinese Activated Manually",day_to_night:"Dark Mode Activated Manually",night_to_day:"Light Mode Activated Manually",bgLight:"#425AEF",bgDark:"#1f1f1f",position:"top-center"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!0,isAnchor:!1,shortcutKey:void 0,autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"CX330",title:"All-in-One PicoCTF Writeups: Crypto",postAI:"",pageFillDescription:"前言, Easy1, Caesar, New Caesar, rotation, Mind your Ps and Qs, No padding no problem, interencdec, Easy peasy, Custom encryption, Mini RSA, miniRSA, b00tl3gRSA2, b00tl3gRSA3, Vigenere, Pixelated, HideToSee, college-rowing-team, substitution0, substitution1, substitution2, ReadMyCert, transposition-trial, spelling-quiz, rail-fence, Dachshund Attacks, waves over lambda前言其實好像也沒什麼好講前言的但就是不想要一開始就是題目分類所以還是放了個前言自己在刷的時候常常發現幾乎所有的都是英文的居多所以想說來寫個完整一點的中文版總之呢這裡就是會盡量彙整所有的的題目在這邊但是因為已經寫了題左右才開始打算來寫所以可能前面的部分會等其他都寫完再來補如果有需要就可以直接來這邊看所有的就這樣啦希望能幫忙到你密碼學任督二脈這題是一個維吉尼亞密碼維吉尼亞密碼法語又譯維熱納爾密碼是使用一系列凱撒密碼組成密碼字母表的加密算法屬於多表密碼的一種簡單形式維基百科解密的方式也很簡單最上面一列是明文最左邊那行是這樣對應起來中間的字元就是密文知道了這個之後回推回去就可以得到明文獲取密鑰字母的偏移量獲取密文當中目前的字母用偏移量進行解密而最後的如下如同題目所說這題就是個基本的凱薩加密題目給了加密過的就把裡面那串拿去解密因為不知道偏移量是多少所以就暴力破解跑出來的結果中看起來是最合理所以這就是了題目給了一個密文和一個腳本先觀察這個加密腳本發現他是把明文每個字母的值轉為後從左邊補補到個然後每位元分為一塊每塊的二進制數字映射到的字符集再把這個東西拿去做就是凱薩加密的變形總之解密的話就是反著來就不詳細解釋了如下暴力破解後看起來最像的就是這個了最後自己幫它包上提交果然是正確的這題給了一個加密後的密文看起來就是直接拿去網路上那種凱薩密碼暴力破解這邊使用這題是個加密先來複習一下加密裡面的流程和參數複習完後看一下題目的說明這題的敘述中告訴我們當太小的時候我們可以使用小公鑰指數攻擊而題目要我們思考當太小的時候我們可以如何利用回去看一下加密的流程後我們發現是兩個質數的乘積而當太小的時候我們就可以暴力破解出兩個跟這裡我們直接使用去找的因數就可以找到和了而有了和我們就可以順著流程找到明文了我寫了個幫我找出明文如下最後找到的明文會是一個很大的數字這時候再用的並將其轉為字符串就可以得到了可以先看過這篇離散數學同餘是什麼當我們把題目給的密文拿去解密他會說代表題目的這支程式應該是在偵測我們輸入的是否為而我們知道所以我們利用題目給的和相加後輸入到他的程式會得到接著只要再利用的方法就可以找到明文如下題目給了密文如下因為他最後面的兩個讓他看起來很像是的格式所以就用先一下這邊用的是這款工具他可以線上進行很多種的編碼解碼加密等等解碼一次後長這樣還是很像的格式所以我又做了一次解碼注意這邊要把前面的拿掉只留引號中的內容再解碼一次後變成了這樣的形狀看起來已經有的雛型了因為大括號所以猜測它是某種置換密碼就用最普遍的凱薩密碼來暴力解解看吧如下想了解可以去看看這個一次性密碼本先看題目在這題中我們要先閱讀他給我們的在函式中我們可以看到一些事情因為題目給的的長度為又因為他是以十六進制的方式輸出所以我們可以知道他用掉的長度為也就是說我們下次在加密的時候是用第位開始的這裡從開始知道了我們第一次輸入要加密的銘文是從第個開始後我們要想辦法可以使用到跟題目一樣的那組而在程式碼的這個區段我們可以發現一些事在這邊如果我們讓和相等讓的話就會被設定為所以我們就可以讓被重複使用了所以我們先輸入一堆沒用的字元去填充那個區間段讓他把第一個循環結束再進入一次循環後我們就可以得到跟題目一樣的了然後因為他加密的方法是用計算的方式所以我們可以簡單地透過再計算一次得到明文如下這題給了兩個檔案一個是加密後的裡面還包含了加密需要的一些變量另一個是加密腳本既然給了腳本那就先來看看吧我結合了題目給的加密後的的資訊把註解直接寫在了代碼裡面看看吧密文明文的每個字元碼密鑰並到一個從明文的末尾開始循環裡面每個字元對應的密文明文密鑰由上面的代碼可以知道它是經過了兩次的加密一次是把明文反過來並讓其對循環做第二次是把第一次加密得到的東西轉並乘以再乘以解密的話就反過來先去除以再除以這裡為得到一個半密文接下來這個半密文要先反轉再用它寫好的去做因為它的裡面又有一次反轉所以這樣剛好會是和加密時相同的順序最後得到的這個明文還要再反轉一次才會得到正確的至於為甚麼要反轉兩次解釋如下假設題目的為明文為加密解密第一次反轉把變為所以在裡就會計算對的第二次反轉把轉為希望這樣解釋有比較清楚一點總之照這樣解密就可以得到啦以下是我的解密的代碼使用返回將密文反轉題目給了一組加密的密文還有公鑰如下不難發現這題的公鑰指數超小只有所以我們使用小公鑰指數攻擊由於題目有說略大於故其解題原理如下為密文為明文是公鑰指數是公鑰模數為了計算明文我寫了一個腳本如下宣告題目所給的暴力破解的次方根數字轉字串執行後就可以找到啦這題的原理和上面那題一模一樣都是太小所以用小公鑰指數攻擊想知道更詳細原理看上面那題這邊直接上宣告題目所給的暴力破解的次方根數字轉字串這題給了一個連接方式先連進去主機看看吧連進去後可以得到公鑰跟密文在題目的描述中他說意思是在這題裡面他把和互換了用來加密下面這篇文章有詳細說了為甚麼不應該使用這種做法簡而言之當私鑰指數比較小的時候可以使用這邊可以使用一個開源工具來幫助我們快速執行攻擊使用方式請查看官方文檔總之如下總之就是把參數都設定好就可以成功得到了這題和上一題一樣先用連線到主機得到資訊如下題目說了意思是這題的初始質數不只有和所以我們只要找到歐拉函數並且正常走流程就可以了由於他不只有和兩個質數分解起來會容易很多如下返回一個字典為質因數為該質因數的冪宣告題目給的資訊這邊的是用到了以下的求歐拉函數的公式這樣求出來後就可以用正常計算流程找到明文了這題給了一個加密後的密文跟然後題目也告訴我們是直接拿去解就行我也不知道為甚麼他難度是這題給了兩張圖片並且是一個叫做的東西題目圖片如下這邊我用去兩張圖片先打開第一張圖片後點選再點選第二張圖片之後它會跳出一個介面讓你選擇的方式預設是一直點向右的箭頭直到方法變成的時候就可以看到啦解完後我有看了一下其他人的我發現有人是用解的覺得很酷附上來給大家看看這題給了一個圖片圖片上寫的字說這是一個查了一下就是一種把字母順序反過來的提示有說要所以猜測是用這邊先把資料提取出來這會提取出一個文件看一下內容直接把這個拿去網路上的解密工具就出來了這題給了一個加密腳本和一個密文含公鑰先來看看加密腳本雖然他把一些訊息跟打亂在一起了不知道哪個才是我們要的但可以看到他的公鑰指數都固定設為那就可以用小公鑰指數攻擊試試把每一組都爆出來啦接著我們看看密文好那既然看加密腳本已經發現了他的弱點那就直接來寫吧就出來啦這題給了一個加密後的密文如下最後一行看起來很像但因為他給的是很大段的文字所以可以直接去用暴力破解我推薦使用這個網站直接把整段輸入進去他就會幫你找出最可能的解這題照理說應該跟上一題一樣但是我覺得他題目可能有改過然後答案忘了改因為我看了好多人的都是這樣解可是每個人的都不一樣所以就先跳過了這題也一樣用那個線上工具這題給了一個文件要我們去檢查這份文件因為文件的編碼方式是一種特定格式不是單純的編碼我們可以用以下命令查看他但為了方便我們可以直接使用線上的幫我們解碼先看題目敘述這代表每三個字為一個區塊並且每個區塊都被相同的方式打亂了密文長下面這樣我們可以發現前三個字是所以能推測出他打亂的方式是每個中的最後一個變為第一個其餘不變那就來構造吧這樣就出來啦這題給了三個文件和先來看看加密腳本可以看出他就是一個然後因為我們確定裡面都是正常的單字題目說的所以我們可以直接把接在後面接著拿去給一些線上工具解密就可以了這邊我用的是這個工具最後記得用包起來這題給了一個密文如下他就是一個經典的柵欄密碼可以直接拿去線上工具解密記得要把下面這個選項開啟然後就可以解出啦這題連接上去後會吐密文然後是個直接拿去線上的詞頻分析破解他然後這題並沒有用包起來",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-11-24 03:46:55",postMainColor:"#040404"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:(e,t,a)=>{if(0===a)return;const o={value:t,expiry:Date.now()+864e5*a};localStorage.setItem(e,JSON.stringify(o))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const a=JSON.parse(t);if(!(Date.now()>a.expiry))return a.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((a,o)=>{const c=document.createElement("script");c.src=e,c.async=!0,c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},Object.keys(t).forEach(e=>{c.setAttribute(e,t[e])}),document.head.appendChild(c)}),e.getCSS=(e,t=!1)=>new Promise((a,o)=>{const c=document.createElement("link");c.rel="stylesheet",c.href=e,t&&(c.id=t),c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},document.head.appendChild(c)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#18171d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#f7f9fe")};const t=saveToLocal.get("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches,o=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!a&&!o&&!c;if(void 0===t){if(o)activateLightMode();else if(a)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=6||e>=18?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener(e=>{void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())})}else"light"===t?activateLightMode():activateDarkMode();const d=saveToLocal.get("aside-status");void 0!==d&&("hide"===d?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="cx330" data-description="Support me on Buy me a coffee!" data-message="Hackers need COFFEE ☕" data-color="var(--anzhiyu-theme)" data-position="Right" data-x_margin="18" data-y_margin="18"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="CX330" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加載頭像" src="/assets/me.jpg"><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",()=>{preloader.endLoading()}),setTimeout((function(){preloader.endLoading()}),1e4),document.addEventListener("pjax:send",()=>{preloader.initLoading()}),document.addEventListener("pjax:complete",()=>{preloader.endLoading()})</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.min.css"><script async src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Contact</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://x.com/CX330Blake" title="X"><img class="back-menu-item-icon" src="/assets/x.png" alt="X"><span class="back-menu-item-text">X</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100011698690769" title="Facebook"><img class="back-menu-item-icon" src="/assets/fb.png" alt="Facebook"><span class="back-menu-item-text">Facebook</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><img class="back-menu-item-icon" src="/assets/linkedin.png" alt="LinkedIn"><span class="back-menu-item-text">LinkedIn</span></a><a class="back-menu-item" href="/assets/Resume.pdf" title="Resume"><img class="back-menu-item-icon" src="/assets/me.jpg" alt="Resume"><span class="back-menu-item-text">Resume</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Others</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://cx330.tw" title="Portfolio"><img class="back-menu-item-icon" src="/assets/me.jpg" alt="Portfolio"><span class="back-menu-item-text">Portfolio</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://admin.cx330.tw" title="Admin"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="Admin"><span class="back-menu-item-text">Admin</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Useful Tools</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://revshells.cx330.tw" title="RevShells"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="RevShells"><span class="back-menu-item-text">RevShells</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://ohmycv.cx330.tw" title="OhMyCV"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="OhMyCV"><span class="back-menu-item-text">OhMyCV</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gtfobins.cx330.tw" title="GTFOBins"><img class="back-menu-item-icon" src="/assets/hacker.png" alt="GTFOBins"><span class="back-menu-item-text">GTFOBins</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">CX330</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articles</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-solid fa-file-zipper faa-tada"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-solid fa-icons faa-tada"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-solid fa-hashtag faa-tada"></i><span> Tags</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="fa-solid fa-dice faa-tada"></i><span> Random</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>My</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/assets/Resume.pdf"><i class="fa-solid fa-file faa-tada"></i><span> Resume</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="fa-solid fa-music faa-tada"></i><span> Music bar</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="fa-solid fa-medal faa-tada"></i><span> Collections</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://cx330tw.notion.site/Bullet-Journal-c79ab73909d94fa387d4b58e85d90494"><i class="fa-solid fa-clipboard-list faa-tada"></i><span> Notes</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>About</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="fa-solid fa-id-badge faa-tada"></i><span> Whoami</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/subscribe/"><i class="fa-solid fa-bell faa-tada"></i><span> Subscribe</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://cx330.tw/"><i class="fa-solid fa-user faa-tada"></i><span> Portfolio</span></a></li></ul></div></div></div><div id="nav-right"><div id="nav-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="Discover a random post" href="javascript:void(0);"><i class="fontawesome fa-solid fa-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="Search🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> Search</span></a></div><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://buymeacoffee.com/cx330" target="_blank"><img class="post-qr-code-img" alt="Buy Me a Coffee" src="/assets/buymeacoffee.png"></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://blog.cx330.tw" target="_blank"><img class="post-qr-code-img" alt="CX330" src="/assets/me.jpg"></a><div class="post-qr-code-desc">CX330</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互動</div><span class="author-content-item-title">Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">興趣點</div><span class="author-content-item-title">尋找你感興趣的領域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size:1.05rem">AI<sup>1</sup></a><a href="/tags/AIS3/" style="font-size:1.05rem">AIS3<sup>1</sup></a><a href="/tags/Assembly-Code/" style="font-size:1.05rem">Assembly Code<sup>1</sup></a><a href="/tags/Blog/" style="font-size:1.05rem">Blog<sup>1</sup></a><a href="/tags/Byte-Code/" style="font-size:1.05rem">Byte Code<sup>1</sup></a><a href="/tags/CCEP/" style="font-size:1.05rem">CCEP<sup>1</sup></a><a href="/tags/CRT/" style="font-size:1.05rem">CRT<sup>1</sup></a><a href="/tags/CTF/" style="font-size:1.05rem">CTF<sup>33</sup></a><a href="/tags/Crypto/" style="font-size:1.05rem">Crypto<sup>7</sup></a><a href="/tags/Cryptography/" style="font-size:1.05rem">Cryptography<sup>2</sup></a><a href="/tags/CyberSec/" style="font-size:1.05rem">CyberSec<sup>29</sup></a><a href="/tags/GDSC/" style="font-size:1.05rem">GDSC<sup>1</sup></a><a href="/tags/GamePwn/" style="font-size:1.05rem">GamePwn<sup>1</sup></a><a href="/tags/HITCON/" style="font-size:1.05rem">HITCON<sup>1</sup></a><a href="/tags/HTB/" style="font-size:1.05rem">HTB<sup>14</sup></a><a href="/tags/HackTheBox/" style="font-size:1.05rem">HackTheBox<sup>10</sup></a><a href="/tags/Hacker/" style="font-size:1.05rem">Hacker<sup>1</sup></a><a href="/tags/Hacking/" style="font-size:1.05rem">Hacking<sup>1</sup></a><a href="/tags/HacktTheBox/" style="font-size:1.05rem">HacktTheBox<sup>1</sup></a><a href="/tags/Hardware/" style="font-size:1.05rem">Hardware<sup>2</sup></a><a href="/tags/Machine-Code/" style="font-size:1.05rem">Machine Code<sup>1</sup></a><a href="/tags/Math/" style="font-size:1.05rem">Math<sup>2</sup></a><a href="/tags/Misc/" style="font-size:1.05rem">Misc<sup>1</sup></a><a href="/tags/NCKU/" style="font-size:1.05rem">NCKU<sup>1</sup></a><a href="/tags/PicoCTF/" style="font-size:1.05rem">PicoCTF<sup>13</sup></a><a href="/tags/Pwn/" style="font-size:1.05rem">Pwn<sup>15</sup></a><a href="/tags/Registers/" style="font-size:1.05rem">Registers<sup>1</sup></a><a href="/tags/Reverse/" style="font-size:1.05rem">Reverse<sup>1</sup></a><a href="/tags/SCIST/" style="font-size:1.05rem">SCIST<sup>2</sup></a><a href="/tags/SQLi/" style="font-size:1.05rem">SQLi<sup>1</sup></a><a href="/tags/Security/" style="font-size:1.05rem">Security<sup>1</sup></a><a href="/tags/TechStreak30/" style="font-size:1.05rem">TechStreak30<sup>9</sup></a><a href="/tags/Web/" style="font-size:1.05rem">Web<sup>3</sup></a><a href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/" style="font-size:1.05rem">密碼學<sup>1</sup></a><a href="/tags/%E7%AD%86%E8%A8%98/" style="font-size:1.05rem">筆記<sup>1</sup></a><a href="/tags/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC/" style="font-size:1.05rem">網頁開發<sup>1</sup></a><a href="/tags/%E8%B3%87%E5%AE%89/" style="font-size:1.05rem">資安<sup>11</sup></a><a href="/tags/%E9%A7%AD%E5%AE%A2/" style="font-size:1.05rem">駭客<sup>1</sup></a></div></div><hr></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">August 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">26</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">June 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">May 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>Post(s)</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="顯示模式切換" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="邊欄顯示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="熱評開關"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音樂開關"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切換"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">Original</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/PicoCTF/" itemprop="url">PicoCTF</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E8%B3%87%E5%AE%89/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>資安</span></a><a class="article-meta__tags" href="/tags/PicoCTF/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>PicoCTF</span></a></span></div></div><h1 class="post-title" itemprop="name headline">All-in-One PicoCTF Writeups: Crypto</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-06-01T02:27:03.000Z" title="Created 2024-06-01 07:57:03">2024-06-01</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-11-23T22:16:55.197Z" title="Updated 2024-11-24 03:46:55">2024-11-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字數"></i><span class="post-meta-label" title="文章字數">Word count:</span><span class="word-count" title="文章字數">6.8k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="閱讀時長"></i><span class="post-meta-label" title="閱讀時長">Reading time:</span><span>32min</span></span><span class="post-meta-separator"></span><span data-flag-title="All-in-One PicoCTF Writeups: Crypto"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="閱讀量">Post views:</span><span id="twikoo_visitors" title="訪問量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator"> </span><span class="post-meta-position" title="作者IP屬地爲Taiwan"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>Taiwan</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/posts/624b1c44/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://blog.cx330.tw/posts/624b1c44/"><header><a class="post-meta-categories" href="/categories/PicoCTF/" itemprop="url">PicoCTF</a><a href="/tags/%E8%B3%87%E5%AE%89/" tabindex="-1" itemprop="url">資安</a><a href="/tags/PicoCTF/" tabindex="-1" itemprop="url">PicoCTF</a><h1 id="CrawlerTitle" itemprop="name headline">All-in-One PicoCTF Writeups: Crypto</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">CX330</span><time itemprop="dateCreated datePublished" datetime="2024-06-01T02:27:03.000Z" title="Created 2024-06-01 07:57:03">2024-06-01</time><time itemprop="dateCreated datePublished" datetime="2024-11-23T22:16:55.197Z" title="Updated 2024-11-24 03:46:55">2024-11-24</time></header><h1 id="前言">前言</h1><p>其實好像也沒什麼好講前言的，但就是不想要一開始就是題目分類，所以還是放了個前言 XD。</p><p>自己在刷 PicoCTF 的時候常常發現，幾乎所有的 writeup 都是英文的居多，所以想說來寫個完整一點的中文版！總之呢這裡就是會盡量彙整所有的 picoCTF 的題目在這邊（但是因為已經寫了 60 題左右才開始打算來寫 writeup，所以可能前面的部分會等其他都寫完再來補），如果有需要就可以直接來這邊看所有的 writeup，就這樣啦！希望能幫忙到你。</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/CX330Blake/Crypto_Notebook">My scripts &amp; note on Github</a></li><li><a href="https://blog.cx330.tw/StudyNotes/Cryptography-Notes-%E5%AF%86%E7%A2%BC%E5%AD%B8%E4%BB%BB%E7%9D%A3%E4%BA%8C%E8%84%88/">Cryptography Notebook 密碼學任督二脈</a></li></ul><h1 id="Easy1">Easy1</h1><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
   +----------------------------------------------------
A | A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
B | B C D E F G H I J K L M N O P Q R S T U V W X Y Z A
C | C D E F G H I J K L M N O P Q R S T U V W X Y Z A B
D | D E F G H I J K L M N O P Q R S T U V W X Y Z A B C
E | E F G H I J K L M N O P Q R S T U V W X Y Z A B C D
F | F G H I J K L M N O P Q R S T U V W X Y Z A B C D E
G | G H I J K L M N O P Q R S T U V W X Y Z A B C D E F
H | H I J K L M N O P Q R S T U V W X Y Z A B C D E F G
I | I J K L M N O P Q R S T U V W X Y Z A B C D E F G H
J | J K L M N O P Q R S T U V W X Y Z A B C D E F G H I
K | K L M N O P Q R S T U V W X Y Z A B C D E F G H I J
L | L M N O P Q R S T U V W X Y Z A B C D E F G H I J K
M | M N O P Q R S T U V W X Y Z A B C D E F G H I J K L
N | N O P Q R S T U V W X Y Z A B C D E F G H I J K L M
O | O P Q R S T U V W X Y Z A B C D E F G H I J K L M N
P | P Q R S T U V W X Y Z A B C D E F G H I J K L M N O
Q | Q R S T U V W X Y Z A B C D E F G H I J K L M N O P
R | R S T U V W X Y Z A B C D E F G H I J K L M N O P Q
S | S T U V W X Y Z A B C D E F G H I J K L M N O P Q R
T | T U V W X Y Z A B C D E F G H I J K L M N O P Q R S
U | U V W X Y Z A B C D E F G H I J K L M N O P Q R S T
V | V W X Y Z A B C D E F G H I J K L M N O P Q R S T U
W | W X Y Z A B C D E F G H I J K L M N O P Q R S T U V
X | X Y Z A B C D E F G H I J K L M N O P Q R S T U V W
Y | Y Z A B C D E F G H I J K L M N O P Q R S T U V W X
Z | Z A B C D E F G H I J K L M N O P Q R S T U V W X Y

Cipher: UFJKXQZQUNB
Key: SOLVECRYPTO<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這題是一個維吉尼亞密碼。維吉尼亞密碼（法語：Chiffre de Vigenère，又譯維熱納爾密碼）是使用一系列凱撒密碼組成密碼字母表的加密算法，屬於多表密碼的一種簡單形式。<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-tw/%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81">維基百科</a><br>解密的方式也很簡單，最上面一列是明文，最左邊那行是 KEY，這樣對應起來中間的字元就是密文。知道了這個之後回推回去就可以得到明文。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cipher <span class="token operator">=</span> <span class="token string">"UFJKXQZQUNB"</span>
key <span class="token operator">=</span> <span class="token string">"SOLVECRYPTO"</span>

pt <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    shift <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">65</span>  <span class="token comment"># 獲取密鑰字母的偏移量</span>
    c <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 獲取密文當中目前的字母</span>

    c <span class="token operator">=</span> <span class="token punctuation">(</span>c <span class="token operator">-</span> shift <span class="token operator">-</span> <span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span>  <span class="token comment"># 用偏移量進行解密</span>
    pt <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Message: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>pt<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>而最後的 flag 如下</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;CRYPTOISFUN&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Caesar">Caesar</h1><p>如同題目所說，這題就是個基本的凱薩加密。題目給了加密過的 flag</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;gvswwmrkxlivyfmgsrhnrisegl&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>就把裡面那串拿去解密，因為不知道偏移量是多少，所以就暴力破解。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cipher <span class="token operator">=</span> <span class="token string">"gvswwmrkxlivyfmgsrhnrisegl"</span>


<span class="token keyword">def</span> <span class="token function">caesar_cipher</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> shift<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plaintext <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> text<span class="token punctuation">:</span>
        plaintext <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">97</span> <span class="token operator">+</span> shift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> plaintext


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plaintext <span class="token operator">=</span> caesar_cipher<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Shift </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>plaintext<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>跑出來的結果中，看起來是 <code>crossingtherubicondjneoach</code>最合理，所以這就是 flag 了</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;crossingtherubicondjneoach&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="New-Caesar">New Caesar</h1><p>題目給了一個密文和一個 Python 腳本。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">apbopjbobpnjpjnmnnnmnlnbamnpnononpnaaaamnlnkapndnkncamnpapncnbannaapncndnlnpna<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string

LOWERCASE_OFFSET <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>
ALPHABET <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">b16_encode</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">:</span>
	enc <span class="token operator">=</span> <span class="token string">""</span>
	<span class="token keyword">for</span> c <span class="token keyword">in</span> plain<span class="token punctuation">:</span>
		binary <span class="token operator">=</span> <span class="token string">"&#123;0:08b&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
		enc <span class="token operator">+=</span> ALPHABET<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>binary<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
		enc <span class="token operator">+=</span> ALPHABET<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>binary<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
	<span class="token keyword">return</span> enc

<span class="token keyword">def</span> <span class="token function">shift</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
	t1 <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> LOWERCASE_OFFSET
	t2 <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> LOWERCASE_OFFSET
	<span class="token keyword">return</span> ALPHABET<span class="token punctuation">[</span><span class="token punctuation">(</span>t1 <span class="token operator">+</span> t2<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ALPHABET<span class="token punctuation">)</span><span class="token punctuation">]</span>

flag <span class="token operator">=</span> <span class="token string">"redacted"</span>
key <span class="token operator">=</span> <span class="token string">"redacted"</span>
<span class="token keyword">assert</span> <span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>k <span class="token keyword">in</span> ALPHABET <span class="token keyword">for</span> k <span class="token keyword">in</span> key<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>

b16 <span class="token operator">=</span> b16_encode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
enc <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>b16<span class="token punctuation">)</span><span class="token punctuation">:</span>
	enc <span class="token operator">+=</span> shift<span class="token punctuation">(</span>c<span class="token punctuation">,</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>先觀察這個加密腳本。發現他是把明文每個字母的 Ascii 值轉為 Binary 後，從左邊補 0 補到 8 個 Bits，然後每 4 位元分為一塊，每塊的二進制數字（0 ～ 15）映射到 Base16 的字符集（a ～ p）。再把這個東西拿去做 shift，就是凱薩加密的變形。</p><p>總之解密的話就是反著來，就不詳細解釋了。Exploit 如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string

LOWERCASE_OFFSET <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>
ALPHABET <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">b16_encode</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">:</span>
    enc <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> plain<span class="token punctuation">:</span>
        binary <span class="token operator">=</span> <span class="token string">"&#123;0:08b&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
        enc <span class="token operator">+=</span> ALPHABET<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>binary<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># Since 4 bits can represent 16 characters</span>
        enc <span class="token operator">+=</span> ALPHABET<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>binary<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> enc


<span class="token keyword">def</span> <span class="token function">b16_decode</span><span class="token punctuation">(</span>b16<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dec <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b16<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        first <span class="token operator">=</span> b16<span class="token punctuation">[</span>c<span class="token punctuation">]</span>
        second <span class="token operator">=</span> b16<span class="token punctuation">[</span>c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
        first_index <span class="token operator">=</span> ALPHABET<span class="token punctuation">.</span>index<span class="token punctuation">(</span>first<span class="token punctuation">)</span>
        second_index <span class="token operator">=</span> ALPHABET<span class="token punctuation">.</span>index<span class="token punctuation">(</span>second<span class="token punctuation">)</span>
        binary <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>first_index<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>second_index<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
        dec <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>binary<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> dec


<span class="token keyword">def</span> <span class="token function">shift</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    t1 <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> LOWERCASE_OFFSET  <span class="token comment"># (c - 97 + k - 97) % 16 = result</span>
    t2 <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> LOWERCASE_OFFSET
    <span class="token keyword">return</span> ALPHABET<span class="token punctuation">[</span><span class="token punctuation">(</span>t1 <span class="token operator">+</span> t2<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ALPHABET<span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># two numbers sum modulo 16</span>


<span class="token keyword">def</span> <span class="token function">inverse_shift</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    t1 <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> LOWERCASE_OFFSET
    t2 <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> LOWERCASE_OFFSET
    <span class="token keyword">return</span> ALPHABET<span class="token punctuation">[</span><span class="token punctuation">(</span>t1 <span class="token operator">-</span> t2<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ALPHABET<span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># two numbers difference modulo 16</span>


enc <span class="token operator">=</span> <span class="token string">"apbopjbobpnjpjnmnnnmnlnbamnpnononpnaaaamnlnkapndnkncamnpapncnbannaapncndnlnpna"</span>
<span class="token keyword">for</span> key <span class="token keyword">in</span> ALPHABET<span class="token punctuation">:</span>
    dec <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dec <span class="token operator">+=</span> inverse_shift<span class="token punctuation">(</span>c<span class="token punctuation">,</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    b16_dec <span class="token operator">=</span> b16_decode<span class="token punctuation">(</span>dec<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Decrypted flag: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>b16_dec<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>暴力破解後，看起來最像 Flag 的就是 <code>et_tu?_23217b54456fb10e908b5e87c6e89156</code>這個了。最後自己幫它包上 <code>picoCTF&#123;&#125;</code>提交，果然是正確的。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;et_tu?_23217b54456fb10e908b5e87c6e89156&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="rotation">rotation</h1><p>這題給了一個加密後的密文。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">xqkwKBN&#123;z0bib1wv_l3kzgxb3l_949in1i1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>看起來就是 Transposition Cipher，直接拿去網路上那種凱薩密碼暴力破解。這邊使用<a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">CyberChef</a>。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240706165309173.png" alt="Pwned!"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;r0tat1on_d3crypt3d_949af1a1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Mind-your-Ps-and-Qs">Mind your Ps and Qs</h1><p>這題是個 RSA 加密，先來複習一下 RSA 加密裡面的流程和參數。</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Find two prime numbers </mtext><mi>p</mi><mtext> and </mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">\text{Find two prime numbers } p \text{ and } q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord text"><span class="mord">Find two prime numbers </span></span><span class="mord mathnormal">p</span><span class="mord text"><span class="mord"> and </span></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">n = p \times q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n) = (p-1) \times (q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mtext> is the encryption exponent</mtext></mrow><annotation encoding="application/x-tex">e \text{ is the encryption exponent}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">e</span><span class="mord text"><span class="mord"> is the encryption exponent</span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d = e^{-1} \mod \phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8141em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mtext> is the encrypted message</mtext><mo separator="true">;</mo><mspace width="1em"><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c \text{ is the encrypted message}; \quad c = m^e \mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">c</span><span class="mord text"><span class="mord"> is the encrypted message</span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6644em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6644em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mtext> is the message</mtext><mo separator="true">;</mo><mspace width="1em"><mi>m</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">m \text{ is the message}; \quad m = c^d \mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">m</span><span class="mord text"><span class="mord"> is the message</span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8491em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Public key</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Public key} = (e, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord text"><span class="mord">Public key</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Private key</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>d</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Private key} = (d, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord text"><span class="mord">Private key</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li></ul><p>複習完後，看一下題目的說明。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Description:
In RSA, a small e value can be problematic, but what about N? Can you decrypt this?
==============================
Decrypt my super sick RSA:
c: 421345306292040663864066688931456845278496274597031632020995583473619804626233684
n: 631371953793368771804570727896887140714495090919073481680274581226742748040342637
e: 65537<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這題的敘述中告訴我們，當 e 太小的時候我們可以使用小公鑰指數攻擊(Low public exponent attack)，而題目要我們思考當 N 太小的時候我們可以如何利用。</p><p>回去看一下 RSA 加密的流程後，我們發現 N 是兩個質數的乘積，而當 N 太小的時候我們就可以暴力破解出兩個 P 跟 Q。這裡我們直接使用 FactorDB 去找 N 的因數，就可以找到 P 和 Q 了。</p><p>而有了 P 和 Q，我們就可以順著 RSA 流程找到明文 M 了，我寫了個 Python 幫我找出明文，如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> inverse<span class="token punctuation">,</span> long_to_bytes
<span class="token keyword">from</span> factordb<span class="token punctuation">.</span>factordb <span class="token keyword">import</span> FactorDB


<span class="token keyword">def</span> <span class="token function">long2str</span><span class="token punctuation">(</span>long_int<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> long_to_bytes<span class="token punctuation">(</span>long_int<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>


c <span class="token operator">=</span> <span class="token number">421345306292040663864066688931456845278496274597031632020995583473619804626233684</span>
n <span class="token operator">=</span> <span class="token number">631371953793368771804570727896887140714495090919073481680274581226742748040342637</span>
e <span class="token operator">=</span> <span class="token number">65537</span>

<span class="token comment"># From Factor db find p and q</span>
f <span class="token operator">=</span> FactorDB<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
f<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
factors <span class="token operator">=</span> f<span class="token punctuation">.</span>get_factor_list<span class="token punctuation">(</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> factors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
q <span class="token operator">=</span> factors<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

phi_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Private key: d = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>d<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Decrypted message: m = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>long2str<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最後找到的明文會是一個很大的數字，這時候再用 Crypto.Util.number 的 long_to_bytes 並 decode，將其轉為字符串，就可以得到 flag 了。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;sma11_N_n0_g0od_55304594&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="No-padding-no-problem">No padding, no problem</h1><blockquote><p>可以先看過這篇 <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10205727">Day 14:[離散數學]同餘（Mod）是什麼？</a></p></blockquote><p>當我們把題目給的密文拿去解密，他會說 <code>Will not decrypt the ciphertext. Try Again</code>。代表題目的這支程式應該是在偵測我們輸入的是否為 Ciphertext。而我們知道</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">Plaintext = c^d \mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">Pl</span><span class="mord mathnormal">ain</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8991em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>c</mi><mi>d</mi></msup><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><mi>c</mi><mo>+</mo><mi>n</mi><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c^d \mod n = (c+n)^d \mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8991em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-.25em"></span><span class="mord mathnormal">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span></span></p><p>所以我們利用題目給的 c 和 n 相加後，輸入到他的程式會得到:</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Here you go: 290275030195850039473456618367455885069965748851278076756743720446703314517401359267322769037469251445384426639837648598397<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>接著只要再利用 Crypto 的 long_to_bytes3 方法就可以找到明文，如下:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"mercury.picoctf.net"</span><span class="token punctuation">,</span> <span class="token number">10333</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"n:"</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"ciphertext:"</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
num <span class="token operator">=</span> n <span class="token operator">+</span> c
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Here you go:"</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;m4yb3_Th0se_m3s54g3s_4r3_difurrent_1772735&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="interencdec">interencdec</h1><p>題目給了密文 enc_flag，如下。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">YidkM0JxZGtwQlRYdHFhR3g2YUhsZmF6TnFlVGwzWVROclh6YzRNalV3YUcxcWZRPT0nCg==<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>因為他最後面的兩個 <code>==</code>讓他看起來很像是 base64 的格式，所以就用 base64 先 Decode 一下。這邊用的是<a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">CyberChef</a>這款工具，他可以線上進行很多種的編碼解碼、加密等等。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240704163439113.png" alt="b64 decode"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">d3BqdkpBTXtqaGx6aHlfazNqeTl3YTNrXzc4MjUwaG1qfQ==<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>解碼一次後長這樣，還是很像 base64 的格式，所以我又做了一次 base64 解碼。（注意：這邊要把前面的 b 拿掉，只留引號中的內容）</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240704163700571.png" alt="b64 decode"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">wpjvJAM&#123;jhlzhy_k3jy9wa3k_78250hmj&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>再解碼一次後變成了這樣的形狀，看起來已經有 Flag 的雛型了（因為大括號），所以猜測它是某種置換密碼。就用最普遍的凱薩密碼來暴力解解看吧！Exploit 如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">enc_flag <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the encrypted flag: "</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dec_flag <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> char <span class="token keyword">in</span> enc_flag<span class="token punctuation">:</span>
        <span class="token keyword">if</span> char<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> char<span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                dec_flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                dec_flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            dec_flag <span class="token operator">+=</span> char
    <span class="token keyword">if</span> <span class="token string">"pico"</span> <span class="token keyword">in</span> dec_flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>dec_flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;caesar_d3cr9pt3d_78250afc&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Easy-peasy">Easy peasy</h1><blockquote><p>想了解 OTP 可以去看看這個 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-tw/%E4%B8%80%E6%AC%A1%E6%80%A7%E5%AF%86%E7%A2%BC%E6%9C%AC">一次性密碼本</a></p></blockquote><p>先看題目。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">******************Welcome to our OTP implementation!******************
This is the encrypted flag!
551e6c4c5e55644b56566d1b5100153d4004026a4b52066b4a5556383d4b0007

What data would you like to encrypt?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在這題中，我們要先閱讀他給我們的 Code。在 encrypt 函式中我們可以看到一些事情。因為題目給的 Cipher 的長度為 64，又因為他是以十六進制的方式輸出 Cipher，所以我們可以知道他用掉的 <code>key_location</code>長度為 32，也就是說，我們下次在加密的時候是用第 33 位開始的 key。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>key_location<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ui <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"What data would you like to encrypt? "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ui<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ui<span class="token punctuation">)</span> <span class="token operator">></span> KEY_LEN<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>

    start <span class="token operator">=</span> key_location  <span class="token comment"># 這裡從32開始</span>
    stop <span class="token operator">=</span> key_location <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ui<span class="token punctuation">)</span>

    kf <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>KEY_FILE<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> stop <span class="token operator">>=</span> KEY_LEN<span class="token punctuation">:</span>
        stop <span class="token operator">=</span> stop <span class="token operator">%</span> KEY_LEN
        key <span class="token operator">=</span> kf<span class="token punctuation">[</span>start<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> kf<span class="token punctuation">[</span><span class="token punctuation">:</span>stop<span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        key <span class="token operator">=</span> kf<span class="token punctuation">[</span>start<span class="token punctuation">:</span>stop<span class="token punctuation">]</span>
    key_location <span class="token operator">=</span> stop

    result <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> p<span class="token punctuation">,</span> k<span class="token punctuation">:</span> <span class="token string">"&#123;:02x&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">^</span> k<span class="token punctuation">)</span><span class="token punctuation">,</span> ui<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Here ya go!\n&#123;&#125;\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> key_location<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>知道了我們第一次輸入要加密的銘文是從第 32 個 key 開始後，我們要想辦法可以使用到跟題目一樣的那組 key，而在程式碼的這個區段我們可以發現一些事。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> stop <span class="token operator">>=</span> KEY_LEN<span class="token punctuation">:</span>
        stop <span class="token operator">=</span> stop <span class="token operator">%</span> KEY_LEN
        key <span class="token operator">=</span> kf<span class="token punctuation">[</span>start<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> kf<span class="token punctuation">[</span><span class="token punctuation">:</span>stop<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>在這邊，如果我們讓 <code>stop</code>和 <code>KEY_LEN</code>相等，讓 <code>stop % KEY_LEN == 0</code>的話，<code>stop</code>就會被設定為 0，所以我們就可以讓 one-time pad 被重複使用了！所以我們先輸入一堆沒用的字元去填充那個區間段，讓他把第一個 50000 循環結束，再進入一次循環後我們就可以得到跟題目一樣的 key 了。</p><p>然後因為他加密的方法是用計算 XOR 的方式，所以我們可以簡單地透過再計算一次 XOR 得到明文，如下:</p><blockquote><p>key \oplus pt = ct$$ $$key \oplus ct = pt$$ $$pt \oplus ct = key</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> binascii  <span class="token comment"># binascii.unhexlify() is used to convert hex to binary</span>

offset <span class="token operator">=</span> <span class="token number">50000</span> <span class="token operator">-</span> <span class="token number">32</span>

r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"mercury.picoctf.net"</span><span class="token punctuation">,</span> <span class="token number">11188</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
encrypted_flag <span class="token operator">=</span> r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>encrypted_flag<span class="token punctuation">)</span>

r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"?"</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"A"</span> <span class="token operator">*</span> offset<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"?"</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"A"</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>

encoded <span class="token operator">=</span> r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
encoded <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>encoded<span class="token punctuation">)</span>

message <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> <span class="token number">32</span>
key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    key<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>message<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> encoded<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
encrypted_flag <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>encrypted_flag<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encrypted_flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> encrypted_flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

flag <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Custom-encryption">Custom encryption</h1><p>這題給了兩個檔案。一個是加密後的 flag，裡面還包含了加密需要的一些變量；另一個是加密腳本。既然給了腳本，那就先來看看 Code 吧。我結合了題目給的加密後的 flag 的資訊，把註解直接寫在了代碼裡面，看看吧！</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randint
<span class="token keyword">import</span> sys


<span class="token keyword">def</span> <span class="token function">generator</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">%</span> p


<span class="token comment"># 密文 = 明文的每個字元ASCII碼 * 密鑰 * 311並append到一個list</span>
<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> char <span class="token keyword">in</span> plaintext<span class="token punctuation">:</span>
        cipher<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">*</span> key <span class="token operator">*</span> <span class="token number">311</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> cipher


<span class="token keyword">def</span> <span class="token function">is_prime</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    v <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> p <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            v <span class="token operator">=</span> v <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">if</span> v <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>


<span class="token keyword">def</span> <span class="token function">dynamic_xor_encrypt</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> text_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher_text <span class="token operator">=</span> <span class="token string">""</span>
    key_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text_key<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> char <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 從明文的末尾開始</span>
        key_char <span class="token operator">=</span> text_key<span class="token punctuation">[</span>i <span class="token operator">%</span> key_length<span class="token punctuation">]</span>  <span class="token comment"># 循環text_key裡面每個字元</span>
        encrypted_char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key_char<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 對應的密文 = 明文 ^ 密鑰</span>
        cipher_text <span class="token operator">+=</span> encrypted_char
    <span class="token keyword">return</span> cipher_text


<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>plain_text<span class="token punctuation">,</span> text_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> <span class="token number">97</span>
    g <span class="token operator">=</span> <span class="token number">31</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> is_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">not</span> is_prime<span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter prime numbers"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    a <span class="token operator">=</span> randint<span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    b <span class="token operator">=</span> randint<span class="token punctuation">(</span>g <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> g<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"a = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"b = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>b<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token comment"># a = 89</span>
    <span class="token comment"># b = 27</span>
    <span class="token comment"># p = 97</span>
    <span class="token comment"># g = 31</span>
    u <span class="token operator">=</span> generator<span class="token punctuation">(</span>g<span class="token punctuation">,</span> a<span class="token punctuation">,</span> p<span class="token punctuation">)</span>  <span class="token comment"># u = 31 ** 89 % 97 = 49</span>
    v <span class="token operator">=</span> generator<span class="token punctuation">(</span>g<span class="token punctuation">,</span> b<span class="token punctuation">,</span> p<span class="token punctuation">)</span>  <span class="token comment"># u = 31** 27 % 97 = 85</span>
    key <span class="token operator">=</span> generator<span class="token punctuation">(</span>v<span class="token punctuation">,</span> a<span class="token punctuation">,</span> p<span class="token punctuation">)</span>  <span class="token comment"># key = 85 ** 89 % 97 = 12</span>
    b_key <span class="token operator">=</span> generator<span class="token punctuation">(</span>u<span class="token punctuation">,</span> b<span class="token punctuation">,</span> p<span class="token punctuation">)</span>  <span class="token comment"># b_key = 49 ** 27 % 97 = 12</span>
    shared_key <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">if</span> key <span class="token operator">==</span> b_key<span class="token punctuation">:</span>
        shared_key <span class="token operator">=</span> key  <span class="token comment"># shared_key = 12</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Invalid key"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    semi_cipher <span class="token operator">=</span> dynamic_xor_encrypt<span class="token punctuation">(</span>plain_text<span class="token punctuation">,</span> text_key<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>semi_cipher<span class="token punctuation">,</span> shared_key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"cipher is: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cipher<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    message <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    test<span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">"trudeau"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由上面的代碼可以知道，它是經過了兩次的加密，一次是把明文反過來並讓其對 <code>text_key</code>循環做 XOR，第二次是把第一次加密得到的東西轉 ASCII 並乘以 key 再乘以 311。</p><p>解密的話就反過來，先去除以 311 再除以 key（這裡為 12），得到一個半密文（semi_cipher）。接下來這個半密文要先反轉，再用它寫好的 function 去做 XOR（因為它的 function 裡面又有一次反轉，所以這樣剛好會是和加密時相同的順序），最後得到的這個明文還要再反轉一次，才會得到正確的 flag。至於為甚麼要反轉兩次，解釋如下：</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">假設題目的dynamic_xor_encrypt為f，明文為ABC

加密：
f(ABC, KEY) = C'B'A'

解密：
第一次反轉，把C'B'A變為A'B'C，所以在f裡就會計算C'B'A對KEY的XOR
f(A'B'C, KEY) = CBA
第二次反轉，把CBA轉為ABC
flag = ABC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>希望這樣解釋有比較清楚一點！總之照這樣解密就可以得到 flag 啦，以下是我的解密的代碼：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>cipher<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> text_key<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    semi_cipher <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> encrypted_value <span class="token keyword">in</span> cipher<span class="token punctuation">:</span>
        decrypted_value <span class="token operator">=</span> encrypted_value <span class="token operator">//</span> <span class="token punctuation">(</span>key <span class="token operator">*</span> <span class="token number">311</span><span class="token punctuation">)</span>  <span class="token comment"># 使用 // 返回int</span>
        semi_cipher <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>decrypted_value<span class="token punctuation">)</span>
    semi_cipher <span class="token operator">=</span> semi_cipher<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 將密文反轉</span>
    plaintext <span class="token operator">=</span> dynamic_xor_encrypt<span class="token punctuation">(</span>semi_cipher<span class="token punctuation">,</span> text_key<span class="token punctuation">)</span>
    <span class="token keyword">return</span> plaintext


cipher <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">33588</span><span class="token punctuation">,</span>
    <span class="token number">276168</span><span class="token punctuation">,</span>
    <span class="token number">261240</span><span class="token punctuation">,</span>
    <span class="token number">302292</span><span class="token punctuation">,</span>
    <span class="token number">343344</span><span class="token punctuation">,</span>
    <span class="token number">328416</span><span class="token punctuation">,</span>
    <span class="token number">242580</span><span class="token punctuation">,</span>
    <span class="token number">85836</span><span class="token punctuation">,</span>
    <span class="token number">82104</span><span class="token punctuation">,</span>
    <span class="token number">156744</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">309756</span><span class="token punctuation">,</span>
    <span class="token number">78372</span><span class="token punctuation">,</span>
    <span class="token number">18660</span><span class="token punctuation">,</span>
    <span class="token number">253776</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">82104</span><span class="token punctuation">,</span>
    <span class="token number">320952</span><span class="token punctuation">,</span>
    <span class="token number">3732</span><span class="token punctuation">,</span>
    <span class="token number">231384</span><span class="token punctuation">,</span>
    <span class="token number">89568</span><span class="token punctuation">,</span>
    <span class="token number">100764</span><span class="token punctuation">,</span>
    <span class="token number">22392</span><span class="token punctuation">,</span>
    <span class="token number">22392</span><span class="token punctuation">,</span>
    <span class="token number">63444</span><span class="token punctuation">,</span>
    <span class="token number">22392</span><span class="token punctuation">,</span>
    <span class="token number">97032</span><span class="token punctuation">,</span>
    <span class="token number">190332</span><span class="token punctuation">,</span>
    <span class="token number">119424</span><span class="token punctuation">,</span>
    <span class="token number">182868</span><span class="token punctuation">,</span>
    <span class="token number">97032</span><span class="token punctuation">,</span>
    <span class="token number">26124</span><span class="token punctuation">,</span>
    <span class="token number">44784</span><span class="token punctuation">,</span>
    <span class="token number">63444</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
plaintext <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">"trudeau"</span><span class="token punctuation">)</span>  <span class="token comment"># since we know the key is 12</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"plaintext is: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>plaintext<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token format-spec">-1]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;custom_d2cr0pt6d_dc499538&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Mini-RSA">Mini RSA</h1><p>題目給了一組 RSA 加密的密文，還有公鑰（n, e），如下。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">N: 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287
e: 3

ciphertext (c): 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808147130204332030239454609548193370732857240300019596815816006860639254992255194738107991811397196500685989396810773222940007523267032630601449381770324467476670441511297695830038371195786166055669921467988355155696963689199852044947912413082022187178952733134865103084455914904057821890898745653261258346107276390058792338949223415878232277034434046142510780902482500716765933896331360282637705554071922268580430157241598567522324772752885039646885713317810775113741411461898837845999905524246804112266440620557624165618470709586812253893125417659761396612984740891016230905299327084673080946823376058367658665796414168107502482827882764000030048859751949099453053128663379477059252309685864790106<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>不難發現，這題的公鑰指數 e 超小，只有 3。所以我們使用小公鑰指數攻擊（Coppersmith’s attack, Low public exponent attack）。由於題目有說<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mi>e</mi></msup></mrow><annotation encoding="application/x-tex">m^e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6644em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6644em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span>略大於<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span>，故其解題原理如下（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">c</span></span></span></span>為密文，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">m</span></span></span></span>為明文，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span>是公鑰指數，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span>是公鑰模數）：</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c=m^e\mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6644em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6644em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mi>e</mi></msup><mo>=</mo><mi>k</mi><mo>×</mo><mi>n</mi><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">m^e=k\times n+c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6644em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6644em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">c</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Bruteforce k and find the eth root of </mtext><mi>k</mi><mo>×</mo><mi>n</mi><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\text{Bruteforce k and find the eth root of }k\times n+c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord text"><span class="mord">Bruteforce k and find the eth root of </span></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">c</span></span></span></span></p><p>為了計算明文，我寫了一個 Python 腳本，如下。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes

<span class="token comment"># 宣告題目所給的n, e, c</span>
n <span class="token operator">=</span> <span class="token number">1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287</span>
e <span class="token operator">=</span> <span class="token number">3</span>
c <span class="token operator">=</span> <span class="token number">1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808147130204332030239454609548193370732857240300019596815816006860639254992255194738107991811397196500685989396810773222940007523267032630601449381770324467476670441511297695830038371195786166055669921467988355155696963689199852044947912413082022187178952733134865103084455914904057821890898745653261258346107276390058792338949223415878232277034434046142510780902482500716765933896331360282637705554071922268580430157241598567522324772752885039646885713317810775113741411461898837845999905524246804112266440620557624165618470709586812253893125417659761396612984740891016230905299327084673080946823376058367658665796414168107502482827882764000030048859751949099453053128663379477059252309685864790106</span>

<span class="token comment"># 暴力破解 k * n + c 的 e 次方根</span>
k <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> is_root <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>k <span class="token operator">*</span> n <span class="token operator">+</span> c<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    <span class="token keyword">if</span> is_root<span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        k <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token comment"># 數字轉字串</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>執行後就可以找到 flag 啦～</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240702161343132.png" alt="Flag"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;e_sh0u1d_b3_lArg3r_7adb35b1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="miniRSA">miniRSA</h1><p>這題的原理和上面那題一模一樣，都是 e 太小所以用小公鑰指數攻擊。想知道更詳細原理看<a target="_blank" rel="noopener" href="http://localhost:4000/CTF/All-in-One%20PicoCTF-Writeups/#Mini-RSA">上面那題</a>，這邊直接上 Exploit。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes

<span class="token comment"># 宣告題目所給的n, e, c</span>
n <span class="token operator">=</span> <span class="token number">29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673</span>
e <span class="token operator">=</span> <span class="token number">3</span>
c <span class="token operator">=</span> <span class="token number">2205316413931134031074603746928247799030155221252519872650080519263755075355825243327515211479747536697517688468095325517209911688684309894900992899707504087647575997847717180766377832435022794675332132906451858990782325436498952049751141</span>
<span class="token comment"># 暴力破解 k * n + c 的 e 次方根</span>
k <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> is_root <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>k <span class="token operator">*</span> n <span class="token operator">+</span> c<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    <span class="token keyword">if</span> is_root<span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        k <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token comment"># 數字轉字串</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;n33d_a_lArg3r_e_d0cd6eae&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="b00tl3gRSA2">b00tl3gRSA2</h1><p>這題給了一個 Netcat 連接方式 <code>nc jupiter.challenges.picoctf.org 57464</code>。先連進去主機看看吧。連進去後可以得到公鑰（e, n）跟密文 C。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">c: 34445152657892770965998909208982810010756495888304322276986171688963957553047312382212965383503534206383273951160130679579064667281298014647933151624988393675732505770685953145935008017740630822545491396331269103186466894080672218590474311310524848042116230603776754439341606635542489964403857509012413327600
n: 68119657260892882095325897664190568273401102037961904922092525598421583896728037063388427153386051029888075348478917163527609699475528597669779479757588723783858410926089233944915463760773669961431608182207070211704104302242228666666950454789023679482670607533342993172566630254264627616929496230133089420521
e: 37080866881034431981182406871995949206609767233841813908107646836499839869322256469420054910921271502986970536597423895034064361029486896285600240175045808110268909882526287214985406985265436522819284777174250321264328876332147142628536767687999620602780344780826878645902905435208326564999474536627301460973<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>在題目的描述中他說：</p><blockquote><p>In RSA d is a lot bigger than e, why don’t we use d to encrypt instead of e?</p></blockquote><p>意思是在這題裡面他把 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">d</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span> 互換了，用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">d</span></span></span></span> 來加密 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span>。下面這篇文章有詳細說了為甚麼不應該使用這種做法。</p><ul><li><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/54557/rsa-does-it-matter-if-you-use-e-or-d-to-encrypt">RSA: Does it matter if you use e or d to encrypt?</a></li></ul><p>簡而言之，當私鑰指數（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">d</span></span></span></span>）比較小的時候，可以使用<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Wiener%27s_attack">Wiener’s attack</a>。這邊可以使用一個開源工具來幫助我們快速執行攻擊。</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/RsaCtfTool/RsaCtfTool">RsaCtfTool</a></li></ul><p>使用方式請查看官方文檔。總之 Exploit 如下。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python RsaCtfTool.py <span class="token parameter variable">-e</span> <span class="token number">37080866881034431981182406871995949206609767233841813908107646836499839869322256469420054910921271502986970536597423895034064361029486896285600240175045808110268909882526287214985406985265436522819284777174250321264328876332147142628536767687999620602780344780826878645902905435208326564999474536627301460973</span> <span class="token parameter variable">-n</span> <span class="token number">68119657260892882095325897664190568273401102037961904922092525598421583896728037063388427153386051029888075348478917163527609699475528597669779479757588723783858410926089233944915463760773669961431608182207070211704104302242228666666950454789023679482670607533342993172566630254264627616929496230133089420521</span> <span class="token parameter variable">--decrypt</span> <span class="token number">34445152657892770965998909208982810010756495888304322276986171688963957553047312382212965383503534206383273951160130679579064667281298014647933151624988393675732505770685953145935008017740630822545491396331269103186466894080672218590474311310524848042116230603776754439341606635542489964403857509012413327600</span> <span class="token parameter variable">--attack</span> wiener<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240707150749451.png" alt="Pwned!"></p><p>總之就是把參數都設定好，就可以成功得到 Flag 了。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;bad_1d3a5_2152720&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="b00tl3gRSA3">b00tl3gRSA3</h1><p>這題和上一題一樣，先用 Netcat 連線到主機，得到資訊如下。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">c: 1155413374658603081887942538070618568058048531029758454280998255793925425541835159695263849863790503010031220771999047690488595295467625987010931696477313386062384452816188902386984531395080585643524053777943484599038478398898775019494628236550977835910935567524611329303821647514235510296512723444159728500460371101677191814101634547011569775
n: 3009815969095519381043948515174929441467634594821498333858615496361783804562611599728570248270874306617036697889577813844217713194056663725350522605669349001546826005570895246471872723077264759401472551915667965016802426155245585986786567513487278588996436597960321248870612409759311004096684257474660765774013406405351078796165091907796029759
e: 65537<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>題目說了</p><blockquote><p>Why use p and q when I can use more?</p></blockquote><p>意思是，這題的初始質數不只有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">p</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span>。所以我們只要找到歐拉函數 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，並且正常走流程就可以了。由於他不只有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">p</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 兩個質數，分解起來會容易很多。Exploit 如下。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy<span class="token punctuation">.</span>ntheory <span class="token keyword">import</span> factorint
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes


<span class="token keyword">def</span> <span class="token function">get_phi</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    f <span class="token operator">=</span> factorint<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># 返回一個字典，key為質因數，value為該質因數的冪</span>
    phi <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> f<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        phi <span class="token operator">*=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> phi


<span class="token comment"># 宣告題目給的資訊</span>
c <span class="token operator">=</span> <span class="token number">1155413374658603081887942538070618568058048531029758454280998255793925425541835159695263849863790503010031220771999047690488595295467625987010931696477313386062384452816188902386984531395080585643524053777943484599038478398898775019494628236550977835910935567524611329303821647514235510296512723444159728500460371101677191814101634547011569775</span>
n <span class="token operator">=</span> <span class="token number">3009815969095519381043948515174929441467634594821498333858615496361783804562611599728570248270874306617036697889577813844217713194056663725350522605669349001546826005570895246471872723077264759401472551915667965016802426155245585986786567513487278588996436597960321248870612409759311004096684257474660765774013406405351078796165091907796029759</span>
e <span class="token operator">=</span> <span class="token number">65537</span>

phi <span class="token operator">=</span> get_phi<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這邊的 <code>get_phi(n)</code>是用到了以下的求歐拉函數的公式：</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>p</mi><mn>1</mn><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn></mrow></msubsup><mo>×</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><msubsup><mi>p</mi><mn>2</mn><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn></mrow></msubsup><mo>×</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo>⋯</mo><mo>×</mo><msubsup><mi>p</mi><mi>m</mi><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>−</mo><mn>1</mn></mrow></msubsup><mo>×</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mi>m</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n) = p_1^{k_1 - 1} \times (p_1 - 1) \times p_2^{k_2 - 1} \times (p_2 - 1) \times \cdots \times p_m^{k_m - 1} \times (p_m - 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1973em;vertical-align:-.2663em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.931em"><span style="top:-2.4337em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1449em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3173em"><span style="top:-2.357em;margin-left:-.0315em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2663em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.1973em;vertical-align:-.2663em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.931em"><span style="top:-2.4337em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1449em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3173em"><span style="top:-2.357em;margin-left:-.0315em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2663em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.0961em;vertical-align:-.247em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8491em"><span style="top:-2.453em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1645em"><span style="top:-2.357em;margin-left:-.0315em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>這樣求出來 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 後就可以用正常計算流程找到明文 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">m</span></span></span></span> 了。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;too_many_fact0rs_8606199&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Vigenere">Vigenere</h1><p>這題給了一個加密後的密文跟 Key，然後題目也告訴我們是 Vigenere Cipher，直接拿去 Online decoder 解就行。（我也不知道為甚麼他難度是 Medium LMAO）</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240902145151045.png" alt="Pwned"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;D0NT_US3_V1G3N3R3_C1PH3R_d85729g7&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Pixelated">Pixelated</h1><p>這題給了兩張圖片，並且是一個叫做 Visual Cryptography 的東西。題目圖片如下。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/scrambled1.png" alt="scrambled1"></p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/scrambled2.png" alt="scrambled2"></p><p>這邊我用 <a target="_blank" rel="noopener" href="https://github.com/zardus/ctf-tools/blob/master/stegsolve/install">Stegsolve</a> 去 Combine 兩張圖片。先打開第一張圖片後點選 Analyze &gt; Image Combiner，再點選第二張圖片。之後它會跳出一個介面讓你選擇 Combine 的方式，預設是 XOR，一直點向右的箭頭直到方法變成 ADD 的時候就可以看到 Flag 啦。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240902152127776.png" alt="Pwned"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;d562333d&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>解完後我有看了一下其他人的 Writeups，我發現有人是用 Python 解的覺得很酷，附上來給大家看看。（<a target="_blank" rel="noopener" href="https://ctftime.org/writeup/28930">Writeup</a>）</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># import Image</span>
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token comment"># open both photos</span>
i1 <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'scrambled1.png'</span><span class="token punctuation">)</span>
i2 <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'scrambled2.png'</span><span class="token punctuation">)</span>

<span class="token comment"># get width and height</span>
width1<span class="token punctuation">,</span> height1 <span class="token operator">=</span> i1<span class="token punctuation">.</span>size

<span class="token comment"># open new image</span>
i3 <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>width1<span class="token punctuation">,</span> height1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># load the pixels</span>
pixels <span class="token operator">=</span> i3<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># loop through all pixels</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height1<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># xor the values</span>
        x <span class="token operator">=</span> i1<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> i2<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        y <span class="token operator">=</span> i1<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> i2<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        z <span class="token operator">=</span> i1<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> i2<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

        <span class="token comment"># if all white then convert to black</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>

        <span class="token comment"># put the new pixels in place</span>
        i3<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># save the image</span>
i3<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"test.png"</span><span class="token punctuation">,</span> <span class="token string">"PNG"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="HideToSee">HideToSee</h1><p>這題給了一個圖片，圖片上寫的字說這是一個 Atbash Cipher，查了一下，就是一種把字母順序反過來的 Substitution Cipher。提示有說要 Extract it，所以猜測是用 Steghide，這邊先把資料提取出來。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">steghide extract <span class="token parameter variable">-sf</span> atbash.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>這會提取出一個<code>encrypted.txt</code>文件，看一下內容。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">krxlXGU&#123;zgyzhs_xizxp_8z0uvwwx&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>直接把這個拿去<a target="_blank" rel="noopener" href="https://www.dcode.fr/atbash-cipher">網路上的解密工具</a>，Flag 就出來了。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;atbash_crack_8a0feddc&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="college-rowing-team">college-rowing-team</h1><p>這題給了一個加密腳本和一個密文（含公鑰），先來看看加密腳本<code>encrypt.py</code>。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">import</span> random
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> bytes_to_long


<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    flag <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

msgs <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">b"I just cannot wait for rowing practice today!"</span><span class="token punctuation">,</span>
    <span class="token string">b"I hope we win that big rowing match next week!"</span><span class="token punctuation">,</span>
    <span class="token string">b"Rowing is such a fun sport!"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

msgs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
msgs <span class="token operator">*=</span> <span class="token number">3</span>
random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>msgs<span class="token punctuation">)</span>

<span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs<span class="token punctuation">:</span>
    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    n <span class="token operator">=</span> p <span class="token operator">*</span> q
    e <span class="token operator">=</span> <span class="token number">3</span>
    m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"encrypted-messages.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"e: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token string">\n\n"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>雖然他把一些訊息跟 Flag 打亂在一起了，不知道哪個才是我們要的。但可以看到他的公鑰指數<code>e</code>都固定設為 3，那就可以用<strong>小公鑰指數攻擊</strong>試試，把每一組都爆出來啦！接著我們看看密文<code>encrypted-message.txt</code>。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">n: 12426348204210593270343924563278821305386892683425418957350363905840484905896816630189546938112358425679727243103082954824537007026886458498690134225705484501535835385800730412220192564706251228021192115494699150390312107794005569764411063907390563937247515046052549753641884721864426154021041082461015103337120756347692245843318676049947569653604616584167536958803278688355036036887022591104659059883622072052793378468850702811804337808760402077376453702190206077039468600466511349923882037572540505571672225260106649075841827340894515208811788428239691505001675042096850318994923571686175381862745049100863883977473
e: 3
c: 5065488652323342174251548936130018278628515304559137485528400780060697119682927936946069625772269234638180036633146283242714689277793018059046463458498115311853401434289264038408827377579534270489217094049453933816452196508276029690068611901872786195723358744119490651499187556193711866091991489262948739533990000464588752544599393

n: 19928073532667002674271126242460424264678302463110874370548818138542019092428748404842979311103440183470341730391245820461360581989271804887458051852613435204857098017249255006951581790650329570721461311276897625064269097611296994752278236116594018565111511706468113995740555227723579333780825133947488456834006391113674719045468317242000478209048237262125983164844808938206933531765230386987211125968246026721916610034981306385276396371953013685639581894384852327010462345466019070637326891690322855254242653309376909918630162231006323084408189767751387637751885504520154800908122596020421247199812233589471220112129
e: 3
c: 86893891006724995283854813014390877172735163869036169496565461737741926829273252426484138905500712279566881578262823696620415864916590651557711035982810690227377784525466265776922625254135896966472905776613722370871107640819140591627040592402867504449339363559108090452141753194477174987394954897424151839006206598186417617292433784471465084923195909989

n: 13985338100073848499962346750699011512326742990711979583786294844886470425669389469764474043289963969088280475141324734604981276497038537100708836322845411656572006418427866013918729379798636491260028396348617844015862841979175195453570117422353716544166507768864242921758225721278003979256590348823935697123804897560450268775282548700587951487598672539626282196784513553910086002350034101793371250490240347953205377022300063974640289625028728548078378424148385027286992809999596692826238954331923568004396053037776447946561133762767800447991022277806874834150264326754308297071271019402461938938062378926442519736239
e: 3
c: 86893891006724995283854813014390877172735163869036169496565461737741926829273252426484138905500712279566881578262823696620415864916590651557711035982810690227377784525466265776922625254135896966472905776613722370871107640819140591627040592402867504449339363559108090452141753194477174987394954897424151839006206598186417617292433784471465084923195909989

n: 19594695114938628314229388830603768544844132388459850777761001630275366893884362012318651705573995962720323983057152055387059580452986042765567426880931775302981922724052340073927578619711314305880220746467095847890382386552455126586101506301413099830377279091457182155755872971840333906012240683526684419808580343325425793078160255607072901213979561554799496270708954359438916048029174155327818898336335540262711330304350220907460431976899556849537752397478305745520053275803008830388002531739866400985634978857874446527750647566158509254171939570515941307939440401043123899494711660946335200589223377770449028735883
e: 3
c: 5065488652323342174251548936130018278628515304559137485528400780060697119682927936946069625772269234638180036633146283242714689277793018059046463458498115311853401434289264038408827377579534270489217094049453933816452196508276029690068611901872786195723358744119490651499187556193711866091991489262948739533990000464588752544599393

n: 12091176521446155371204073404889525876314588332922377487429571547758084816238235861014745356614376156383931349803571788181930149440902327788407963355833344633600023056350033929156610144317430277928585033022575359124565125831690297194603671159111264262415101279175084559556136660680378784536991429981314493539364539693532779328875047664128106745970757842693549568630897393185902686036462324740537748985174226434204877493901859632719320905214814513984041502139355907636120026375145132423688329342458126031078786420472123904754125728860419063694343614392723677636114665080333174626159191829467627600232520864728015961207
e: 3
c: 301927034179130315172951479434750678833634853032331571873622664841337454556713005601858152523700291841415874274186191308636935232309742600657257783870282807784519336918511713958804608229440141151963841588389502276162366733982719267670094167338480873020791643860930493832853048467543729024717103511475500012196697609001154401

n: 19121666910896626046955740146145445167107966318588247850703213187413786998275793199086039214034176975548304646377239346659251146907978120368785564098586810434787236158559918254406674657325596697756783544837638305550511428490013226728316473496958326626971971356583273462837171624519736741863228128961806679762818157523548909347743452236866043900099524145710863666750741485246383193807923839936945961137020344124667295617255208668901346925121844295216273758788088883216826744526129511322932544118330627352733356335573936803659208844366689011709371897472708945066317041109550737511825722041213430818433084278617562166603
e: 3
c: 38999477927573480744724357594313956376612559501982863881503907194813646795174312444340693051072410232762895994061399222849450325021561935979706475527169503326744567478138877010606365500800690273

n: 13418736740762596973104019538568029846047274590543735090579226390035444037972048475994990493901009703925021840496230977791241064367082248745077884860140229573097744846674464511874248586781278724368902508880232550363196125332007334060198960815141256160428342285352881398476991478501510315021684774636980366078533981139486237599681094475934234215605394201283718335229148367719703118256598858595776777681347337593280391052515991784851827621657319164805164988688658013761897959597961647960373018373955633439309271548748272976729429847477342667875183958981069315601906664672096776841682438185369260273501519542893405128843
e: 3
c: 38999477927573480744724357594313956376612559501982863881503907194813646795174312444340693051072410232762895994061399222849450325021561935979706475527169503326744567478138877010606365500800690273

n: 11464859840071386874187998795181332312728074122716799062981080421188915868236220735190397594058648588181928124991332518259177909372407829352545954794824083851124711687829216475448282589408362385114764290346196664002188337713751542277587753067638161636766297892811393667196988094100002752743054021009539962054210885806506140497869746682404059274443570436700825435628817817426475943873865847012459799284263343211713809567841907491474908123827229392305117614651611218712810815944801398564599148842933378612548977451706147596637225675719651726550873391280782279097513569748332831819616926344025355682272270297510077861213
e: 3
c: 38999477927573480744724357594313956376612559501982863881503907194813646795174312444340693051072410232762895994061399222849450325021561935979706475527169503326744567478138877010606365500800690273

n: 21079224330416020275858215994125438409920350750828528428653429418050688406373438072692061033602698683604056177670991486330201941071320198633550189417515090152728909334196025991131427459901311579710493651699048138078456234816053539436726503461851093677741327645208285078711019158565296646858341000160387962592778531522953839934806024839570625179579537606629110275080930433458691144426869886809362780063401674963129711723354189327628731665487157177939180982782708601880309816267314061257447780050575935843160596133370063252618488779123249496279022306973156821343257109347328064771311662968182821013519854248157720756807
e: 3
c: 301927034179130315172951479434750678833634853032331571873622664841337454556713005601858152523700291841415874274186191308636935232309742600657257783870282807784519336918511713958804608229440141151963841588389502276162366733982719267670094167338480873020791643860930493832853048467543729024717103511475500012196697609001154401

n: 22748076750931308662769068253035543469890821090685595609386711982925559973042348231161108618506912807763679729371432513862439311860465982816329852242689917043600909866228033526990181831690460395726449921264612636634984917361596257010708960150801970337017805161196692131098507198455206977607347463663083559561805065823088182032466514286002822511854823747204286303638719961067031142962653536148315879123067183501832837303731109779836127520626791254669462630052241934836308543513534520718206756591694480011760892620054163997231711364648699030108110266218981661196887739673466188945869132403569916138510676165684240183111
e: 3
c: 5065488652323342174251548936130018278628515304559137485528400780060697119682927936946069625772269234638180036633146283242714689277793018059046463458498115311853401434289264038408827377579534270489217094049453933816452196508276029690068611901872786195723358744119490651499187556193711866091991489262948739533990000464588752544599393

n: 15211900116336803732344592760922834443004765970450412208051966274826597749339532765578227573197330047059803101270880541680131550958687802954888961705393956657868884907645785512376642155308131397402701603803647441382916842882492267325851662873923175266777876985133649576647380094088801184772276271073029416994360658165050186847216039014659638983362906789271549086709185037174653379771757424215077386429302561993072709052028024252377809234900540361220738390360903961813364846209443618751828783578017709045913739617558501570814103979018207946181754875575107735276643521299439085628980402142940293152962612204167653199743
e: 3
c: 301927034179130315172951479434750678833634853032331571873622664841337454556713005601858152523700291841415874274186191308636935232309742600657257783870282807784519336918511713958804608229440141151963841588389502276162366733982719267670094167338480873020791643860930493832853048467543729024717103511475500012196697609001154401

n: 21920948973299458738045404295160882862610665825700737053514340871547874723791019039542757481917797517039141169591479170760066013081713286922088845787806782581624491712703646267369882590955000373469325726427872935253365913397944180186654880845126957303205539301069768887632145154046359203259250404468218889221182463744409114758635646234714383982460599605335789047488578641238793390948534816976338377433533003184622991479234157434691635609833437336353417201442828968447500119160169653140572098207587349003837774078136718264889636544528530809416097955593693611757015411563969513158773239516267786736491123281163075118193
e: 3
c: 86893891006724995283854813014390877172735163869036169496565461737741926829273252426484138905500712279566881578262823696620415864916590651557711035982810690227377784525466265776922625254135896966472905776613722370871107640819140591627040592402867504449339363559108090452141753194477174987394954897424151839006206598186417617292433784471465084923195909989

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>好！那既然看加密腳本已經發現了他的弱點，那就直接來寫 Exploit 吧。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes


<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>cipher<span class="token punctuation">:</span> <span class="token builtin">dict</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    e <span class="token operator">=</span> cipher<span class="token punctuation">[</span><span class="token string">"e"</span><span class="token punctuation">]</span>
    n <span class="token operator">=</span> cipher<span class="token punctuation">[</span><span class="token string">"n"</span><span class="token punctuation">]</span>
    c <span class="token operator">=</span> cipher<span class="token punctuation">[</span><span class="token string">"c"</span><span class="token punctuation">]</span>
    k <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        m<span class="token punctuation">,</span> is_root <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>k <span class="token operator">*</span> n <span class="token operator">+</span> c<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
        <span class="token keyword">if</span> is_root<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            k <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r"encrypted-messages.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token builtin">file</span> <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n\n"</span><span class="token punctuation">)</span>
<span class="token builtin">file</span><span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>

ciphers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    c <span class="token operator">=</span> c<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> c<span class="token punctuation">:</span>
        key<span class="token punctuation">,</span> value <span class="token operator">=</span> item<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">": "</span><span class="token punctuation">)</span>
        cipher<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    ciphers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>

plaintext <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> cipher <span class="token keyword">in</span> ciphers<span class="token punctuation">:</span>
    plaintext <span class="token operator">+=</span> decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Voila! Flag 就出來啦~</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;1_gu3ss_p30pl3_p4d_m3ss4g3s_f0r_4_r34s0n&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="substitution0">substitution0</h1><p>這題給了一個加密後的密文，如下。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">DECKFMYIQJRWTZPXGNABUSOLVH

Ifnfuxpz Wfyndzk dnpaf, oqbi d yndsf dzk abdbfwv dqn, dzk enpuyib tf bif effbwf
mnpt d ywdaa cdaf qz oiqci qb oda fzcwpafk. Qb oda d efdubqmuw acdndedfua, dzk, db
bidb bqtf, uzrzpoz bp zdbundwqaba—pm cpunaf d ynfdb xnqhf qz d acqfzbqmqc xpqzb
pm sqfo. Bifnf ofnf bop npuzk ewdcr axpba zfdn pzf flbnftqbv pm bif edcr, dzk d
wpzy pzf zfdn bif pbifn. Bif acdwfa ofnf flcffkqzywv idnk dzk ywpaav, oqbi dww bif
dxxfdndzcf pm eunzqaifk ypwk. Bif ofqyib pm bif qzafcb oda sfnv nftdnrdewf, dzk,
bdrqzy dww biqzya qzbp cpzaqkfndbqpz, Q cpuwk idnkwv ewdtf Juxqbfn mpn iqa pxqzqpz
nfaxfcbqzy qb.

Bif mwdy qa: xqcpCBM&#123;5UE5717U710Z_3S0WU710Z_59533D2F&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最後一行看起來很像 Flag，但因為他給的是很大段的文字，所以可以直接去用暴力破解。我推薦使用<a target="_blank" rel="noopener" href="https://planetcalc.com/8047/">這個網站</a>，直接把整段輸入進去，他就會幫你找出最可能的解。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240906212752945.png" alt="Pwned"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;5UB5717U710N_3V0LU710N_59533A2E&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="substitution1">substitution1</h1><p>這題照理說應該跟上一題一樣，但是我覺得他題目可能有改過然後答案忘了改，因為我看了好多人的 writeup 都是這樣解，可是每個人的 Flag 都不一樣 XD，所以就先跳過了。</p><h1 id="substitution2">substitution2</h1><p>這題也一樣用那個線上工具。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;N6R4M_4N41Y515_15_73D10U5_42EA1770&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="ReadMyCert">ReadMyCert</h1><p>這題給了一個 CSR (Certificate Signing Request) 文件，要我們去檢查這份文件。因為 CSR 文件的編碼方式是一種特定格式，不是單純的 Base64 編碼，我們可以用以下命令查看他。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">openssl req <span class="token parameter variable">-in</span> <span class="token operator">&lt;</span>yourcsr.csr<span class="token operator">></span> <span class="token parameter variable">-noout</span> <span class="token parameter variable">-text</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但為了方便，我們可以直接使用<a target="_blank" rel="noopener" href="https://www.sslshopper.com/csr-decoder.html">線上的 CSR Decoder</a>幫我們解碼。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240906220109679.png" alt="Pwned"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;read_mycert_693f7c03&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="transposition-trial">transposition-trial</h1><p>先看題目敘述。</p><blockquote><p>Our data got corrupted on the way here. Luckily, nothing got replaced, but every block of 3 got scrambled around! The first word seems to be three letters long, maybe you can use that to recover the rest of the message.</p></blockquote><p>這代表每三個字為一個區塊，並且每個區塊都被相同的方式打亂了。密文長下面這樣。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">heTfl g as iicpCTo&#123;7F4NRP051N5_16_35P3X51N3_V091B0AE&#125;2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我們可以發現前三個字是<code>The</code>，所以能推測出他打亂的方式是每個 Block 中的最後一個變為第一個，其餘不變。那就來構造 Exploit 吧。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cipher <span class="token operator">=</span> <span class="token string">"heTfl g as iicpCTo&#123;7F4NRP051N5_16_35P3X51N3_V091B0AE&#125;2"</span>

flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    block <span class="token operator">=</span> cipher<span class="token punctuation">[</span>i <span class="token punctuation">:</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span>
    flag <span class="token operator">+=</span> block<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> block<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>這樣就出來啦！</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;7R4N5P051N6_15_3XP3N51V3_109AB02E&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="spelling-quiz">spelling-quiz</h1><p>這題給了三個文件，<code>encrypt.py</code>、<code>flag.txt</code>和<code>study-guide.txt</code>。先來看看加密腳本。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> os

files <span class="token operator">=</span> <span class="token punctuation">[</span>
    os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> path<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> files
    <span class="token keyword">if</span> <span class="token builtin">file</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"txt"</span>
<span class="token punctuation">]</span>

alphabet <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span>
random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>shuffled <span class="token operator">:=</span> alphabet<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
dictionary <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>alphabet<span class="token punctuation">,</span> shuffled<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> filename <span class="token keyword">in</span> files<span class="token punctuation">:</span>
    text <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    encrypted <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>dictionary<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token keyword">if</span> c <span class="token keyword">in</span> dictionary <span class="token keyword">else</span> c <span class="token keyword">for</span> c <span class="token keyword">in</span> text<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以看出他就是一個 Substitution Cipher。然後因為我們確定<code>study-guide.txt</code>裡面都是正常的單字（題目說的），所以我們可以直接把<code>flag.txt</code>接在<code>study-guide.txt</code>後面，接著拿去給一些線上工具解密就可以了（Frequency Attack）。這邊我用的是<a target="_blank" rel="noopener" href="https://www.guballa.de/substitution-solver">這個工具</a>。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240907030426060.png" alt="Pwned"></p><p>最後記得用<code>picoCTF&#123;&#125;</code>包起來。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;perhaps_the_dog_jumped_over_was_just_tired&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="rail-fence">rail-fence</h1><p>這題給了一個密文，如下。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Ta _7N6D8Dhlg:W3D_H3C31N__387ef sHR053F38N43DFD i33___N6<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>他就是一個經典的柵欄密碼，可以直接拿去 <a target="_blank" rel="noopener" href="https://www.dcode.fr/rail-fence-cipher">線上工具</a> 解密，記得要把下面這個選項開啟。然後就可以解出 Flag 啦。</p><p><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/image-20240916092440581.png" alt="Pwned"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;WH3R3_D035_7H3_F3NC3_8361N_4ND_3ND_83F6D8D7&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Dachshund-Attacks">Dachshund Attacks</h1><p>TODO: Wiener’s attack</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> gmpy2


<span class="token keyword">def</span> <span class="token function">continued_fraction</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the continued fraction representation of a rational number n/d"""</span>
    cf <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> d <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        cf<span class="token punctuation">.</span>append<span class="token punctuation">(</span>n <span class="token operator">//</span> d<span class="token punctuation">)</span>
        n<span class="token punctuation">,</span> d <span class="token operator">=</span> d<span class="token punctuation">,</span> n <span class="token operator">%</span> d
    <span class="token keyword">return</span> cf


<span class="token keyword">def</span> <span class="token function">convergents</span><span class="token punctuation">(</span>cf<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the convergents from a continued fraction"""</span>
    n0<span class="token punctuation">,</span> d0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>
    n1<span class="token punctuation">,</span> d1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>
    convergents <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> q <span class="token keyword">in</span> cf<span class="token punctuation">:</span>
        n2 <span class="token operator">=</span> q <span class="token operator">*</span> n1 <span class="token operator">+</span> n0
        d2 <span class="token operator">=</span> q <span class="token operator">*</span> d1 <span class="token operator">+</span> d0
        convergents<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span> d2<span class="token punctuation">)</span><span class="token punctuation">)</span>
        n0<span class="token punctuation">,</span> d0 <span class="token operator">=</span> n1<span class="token punctuation">,</span> d1
        n1<span class="token punctuation">,</span> d1 <span class="token operator">=</span> n2<span class="token punctuation">,</span> d2

    <span class="token keyword">return</span> convergents


<span class="token keyword">def</span> <span class="token function">wiener_attack</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Performs Wiener's attack using gmpy2 to recover d"""</span>
    cf <span class="token operator">=</span> continued_fraction<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    convs <span class="token operator">=</span> convergents<span class="token punctuation">(</span>cf<span class="token punctuation">)</span>

    <span class="token keyword">for</span> k<span class="token punctuation">,</span> d <span class="token keyword">in</span> convs<span class="token punctuation">:</span>
        <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        <span class="token comment"># Calculate phi using the convergent d</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            phi <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> k
            <span class="token comment"># Calculate the discriminant of the quadratic equation</span>
            b <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span>
            discriminant <span class="token operator">=</span> b<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> n
            <span class="token keyword">if</span> discriminant <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                sqrt_disc <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>discriminant<span class="token punctuation">)</span>
                <span class="token keyword">if</span> sqrt_disc <span class="token operator">*</span> sqrt_disc <span class="token operator">==</span> discriminant<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Private key found: d = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>d<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> d
    <span class="token keyword">return</span> <span class="token boolean">None</span>


r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"mercury.picoctf.net"</span><span class="token punctuation">,</span> <span class="token number">37455</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"e: "</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"n: "</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"c: "</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


d <span class="token operator">=</span> wiener_attack<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="waves-over-lambda">waves over lambda</h1><p>這題連接上去後會吐密文，然後是個 Substitution cipher，直接拿去<a target="_blank" rel="noopener" href="https://www.guballa.de/substitution-solver">線上的詞頻分析</a>破解他。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">frequency_is_c_over_lambda_agflcgtyue<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然後這題並沒有用 <code>picoCTF&#123;&#125;</code> 包起來。</p></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="頭像"><img class="post-copyright__author_img_back" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" title="頭像" alt="頭像"><img class="post-copyright__author_img_front" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" title="頭像" alt="頭像"></a><div class="post-copyright__author_name">CX330</div><div class="post-copyright__author_desc">Hack the planet!</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="This article is original. Please be mindful of the copyright agreement." href="https://blog.cx330.tw/posts/624b1c44/">Original</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://blog.cx330.tw/posts/624b1c44/")'>All-in-One PicoCTF Writeups: Crypto</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="Support the author"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>Support</div><div class="reward-main"><div class="reward-all"><span class="reward-title">Thank's for supporting me!</span><ul class="reward-group"><li class="reward-item"><a href="https://buymeacoffee.com/cx330" target="_blank"><img class="post-qr-code-img" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/buymeacoffee.png" alt="Buy Me a Coffee"></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://blog.cx330.tw" target="_blank"><img class="post-qr-code-img" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="CX330"></a><div class="post-qr-code-desc">CX330</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">Sponsor List</div><div class="reward-dec">Really thanks for your coffee🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display:none"></div></div><div class="shareRight"><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="Copy link" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stated additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E8%B3%87%E5%AE%89/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>資安<span class="tagsPageCount">11</span></a><a class="post-meta__box__tags" href="/tags/PicoCTF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>PicoCTF<span class="tagsPageCount">13</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/4376026b/"><img class="prev-cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">All-in-One PicoCTF Writeups: Misc (General Skills)</div></div></a></div><div class="next-post pull-right"><a href="/posts/83db1007/"><img class="next-cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">All-in-One PicoCTF Writeups: Forensics</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/83db1007/" title="All-in-One PicoCTF Writeups: Forensics"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Forensics</div></div></a></div><div><a href="/posts/4376026b/" title="All-in-One PicoCTF Writeups: Misc (General Skills)"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Misc (General Skills)</div></div></a></div><div><a href="/posts/4f98706e/" title="All-in-One PicoCTF Writeups: Web"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Web</div></div></a></div><div><a href="/posts/6526bdbd/" title="All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)</div></div></a></div><div><a href="/posts/461e0005/" title="All-in-One PicoCTF Writeups: Reverse"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Reverse</div></div></a></div><div><a href="/posts/d01f5ccf/" title="2024 AIS3 Pre-exam Writeup"><img class="cover" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/24/8/Blog_cover%20(16)%20(1)_2fdc2382942f5aef8475bf32d3e8ab3d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-02</div><div class="title">2024 AIS3 Pre-exam Writeup</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display:none">匿名評論</a><a href="/privacy" style="margin-left:4px">Privacy policy</a></div><div class="comment-tips" id="comment-tips"><span>✅ No need to delete blank lines, comment directly for the best display</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div><script>document.addEventListener("DOMContentLoaded",(function(){document.documentElement.lang="en"})),document.addEventListener("pjax:complete",(function(){document.documentElement.lang="en"}))</script></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-status"><img class="g-status" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/vampire.png" alt="status"></div></div><div class="author-info__description">This is CX330's blog. I share something about hacking, CTF, developing, and other interesting stuff. GLHF!</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">CX330</h1><div class="author-info__desc">Hack the planet!</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/CX330Blake" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://www.facebook.com/profile.php?id=100011698690769" target="_blank" title="Facebook"><i class="fa-brands fa-facebook faa-tada"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fontawesome fa-solid fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">0xDEADBEEF</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Easy1"><span class="toc-number">2.</span> <span class="toc-text">Easy1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Caesar"><span class="toc-number">3.</span> <span class="toc-text">Caesar</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#New-Caesar"><span class="toc-number">4.</span> <span class="toc-text">New Caesar</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rotation"><span class="toc-number">5.</span> <span class="toc-text">rotation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mind-your-Ps-and-Qs"><span class="toc-number">6.</span> <span class="toc-text">Mind your Ps and Qs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#No-padding-no-problem"><span class="toc-number">7.</span> <span class="toc-text">No padding, no problem</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#interencdec"><span class="toc-number">8.</span> <span class="toc-text">interencdec</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Easy-peasy"><span class="toc-number">9.</span> <span class="toc-text">Easy peasy</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Custom-encryption"><span class="toc-number">10.</span> <span class="toc-text">Custom encryption</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mini-RSA"><span class="toc-number">11.</span> <span class="toc-text">Mini RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#miniRSA"><span class="toc-number">12.</span> <span class="toc-text">miniRSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#b00tl3gRSA2"><span class="toc-number">13.</span> <span class="toc-text">b00tl3gRSA2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#b00tl3gRSA3"><span class="toc-number">14.</span> <span class="toc-text">b00tl3gRSA3</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vigenere"><span class="toc-number">15.</span> <span class="toc-text">Vigenere</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pixelated"><span class="toc-number">16.</span> <span class="toc-text">Pixelated</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HideToSee"><span class="toc-number">17.</span> <span class="toc-text">HideToSee</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#college-rowing-team"><span class="toc-number">18.</span> <span class="toc-text">college-rowing-team</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#substitution0"><span class="toc-number">19.</span> <span class="toc-text">substitution0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#substitution1"><span class="toc-number">20.</span> <span class="toc-text">substitution1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#substitution2"><span class="toc-number">21.</span> <span class="toc-text">substitution2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ReadMyCert"><span class="toc-number">22.</span> <span class="toc-text">ReadMyCert</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#transposition-trial"><span class="toc-number">23.</span> <span class="toc-text">transposition-trial</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#spelling-quiz"><span class="toc-number">24.</span> <span class="toc-text">spelling-quiz</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rail-fence"><span class="toc-number">25.</span> <span class="toc-text">rail-fence</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dachshund-Attacks"><span class="toc-number">26.</span> <span class="toc-text">Dachshund Attacks</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#waves-over-lambda"><span class="toc-number">27.</span> <span class="toc-text">waves over lambda</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/f9317c8b/" title="[HTB] Locked Away Writeup 🔒"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/help-you-at-solving-hackthebox-htb-challenges-machines.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="[HTB] Locked Away Writeup 🔒"></a><div class="content"><a class="title" href="/posts/f9317c8b/" title="[HTB] Locked Away Writeup 🔒">[HTB] Locked Away Writeup 🔒</a><time datetime="2024-10-11T06:30:53.000Z" title="Created 2024-10-11 12:00:53">2024-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e5109b78/" title="Intro to Fermat's Little Theorem"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/fermatlittle.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Intro to Fermat's Little Theorem"></a><div class="content"><a class="title" href="/posts/e5109b78/" title="Intro to Fermat's Little Theorem">Intro to Fermat's Little Theorem</a><time datetime="2024-10-08T13:02:24.000Z" title="Created 2024-10-08 18:32:24">2024-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bd7b2870/" title="[HTB] CubeMadness1 Writeup"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/help-you-at-solving-hackthebox-htb-challenges-machines.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="[HTB] CubeMadness1 Writeup"></a><div class="content"><a class="title" href="/posts/bd7b2870/" title="[HTB] CubeMadness1 Writeup">[HTB] CubeMadness1 Writeup</a><time datetime="2024-10-07T05:20:06.000Z" title="Created 2024-10-07 10:50:06">2024-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/517a12d7/" title="Intro to Extended Euclidean Algorithm"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/24/9/euclidean_9fab94cfbbb8a5c35339bd17b312eeb9.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Intro to Extended Euclidean Algorithm"></a><div class="content"><a class="title" href="/posts/517a12d7/" title="Intro to Extended Euclidean Algorithm">Intro to Extended Euclidean Algorithm</a><time datetime="2024-09-30T08:42:22.924Z" title="Created 2024-09-30 14:12:22">2024-09-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ad637ee9/" title="一些關於明道辯論社的榮耀以及我的高中三年的時光碎片"><img src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/CX330Blake/MyBlogPhotos/main/image/MD_Debate.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="一些關於明道辯論社的榮耀以及我的高中三年的時光碎片"></a><div class="content"><a class="title" href="/posts/ad637ee9/" title="一些關於明道辯論社的榮耀以及我的高中三年的時光碎片">一些關於明道辯論社的榮耀以及我的高中三年的時光碎片</a><time datetime="2024-09-23T18:15:29.000Z" title="Created 2024-09-23 23:45:29">2024-09-23</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/CX330Blake" title="GitHub"><i class="fa-brands fa-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100011698690769" title="Facebook"><i class="fa-brands fa-facebook"></i></a><a class="deal_link" href="mailto:cx330tw@gmail.com" title="Email"><i class="fa-solid fa-envelope"></i></a><img class="footer_mini_logo" title="Back to top" alt="Back to top" onclick="anzhiyu.scrollToDest(0,500)" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><i class="fa-brands fa-linkedin-in"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://discord.com/users/718263896187732049" title="Discord"><i class="fa-brands fa-discord"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://x.com/CX330Blake" title="X"><i class="fa-brands fa-x-twitter"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">Articles</div><div class="footer-links"><a class="footer-item" title="Archives" href="/archives/">Archives</a><a class="footer-item" title="Categories" href="/categories/">Categories</a><a class="footer-item" title="Tags" href="/tags/">Tags</a></div></div><div class="footer-group"><div class="footer-title">Social center</div><div class="footer-links"><a class="footer-item" title="Sites" href="/link/">Sites</a><a class="footer-item" title="Message board" href="/comments/">Message board</a></div></div><div class="footer-group"><div class="footer-title">My</div><div class="footer-links"><a class="footer-item" title="Music bar" href="/music/?id=12295857597&amp;server=netease">Music bar</a><a class="footer-item" title="Talks" href="/essay/">Talks</a><a class="footer-item" title="Books" href="/notyet/">Books</a><a class="footer-item" title="Photos" href="/album/">Photos</a></div></div><div class="footer-group"><div class="footer-title">About</div><div class="footer-links"><a class="footer-item" title="Whoami" href="/about/">Whoami</a><a class="footer-item" title="Subscribe" href="/subscribe/">Subscribe</a><a class="footer-item" title="Portfolio" target="_blank" rel="noopener" href="https://cx330.tw/">Portfolio</a><a class="footer-item" title="Support me" target="_blank" rel="noopener" href="https://buymeacoffee.com/cx330">Support me</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">Link exchange</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="換一批友情鏈接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/" title="CX330" target="_blank">CX330</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType(){window.typed=new Typed("#footer-type-tips",{strings:["Yes, I am a criminal. My crime is that of curiosity","Join the dark side","Build the universe with me","Hack the planet!","Why? Because I can.","Why? Because it's there."],startDelay:300,typeSpeed:200,loop:!0,backSpeed:50})}"function"==typeof Typed?subtitleType():getScript("https://cdn.jsdelivr.net/npm/typed.js@2.1.0/dist/typed.umd.min.js").then(subtitleType)</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="Theme">Theme</a><a class="footer-bar-link cc" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en" title="Copyright"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">67</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">38</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">10</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Contact</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://x.com/CX330Blake" title="X"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/x.png" alt="X"><span class="back-menu-item-text">X</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100011698690769" title="Facebook"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/fb.png" alt="Facebook"><span class="back-menu-item-text">Facebook</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/linkedin.png" alt="LinkedIn"><span class="back-menu-item-text">LinkedIn</span></a><a class="back-menu-item" href="/assets/Resume.pdf" title="Resume"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="Resume"><span class="back-menu-item-text">Resume</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Others</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://cx330.tw" title="Portfolio"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="Portfolio"><span class="back-menu-item-text">Portfolio</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://admin.cx330.tw" title="Admin"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="Admin"><span class="back-menu-item-text">Admin</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Useful Tools</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://revshells.cx330.tw" title="RevShells"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="RevShells"><span class="back-menu-item-text">RevShells</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://ohmycv.cx330.tw" title="OhMyCV"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="OhMyCV"><span class="back-menu-item-text">OhMyCV</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gtfobins.cx330.tw" title="GTFOBins"><img class="back-menu-item-icon" src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/hacker.png" alt="GTFOBins"><span class="back-menu-item-text">GTFOBins</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articles</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-solid fa-file-zipper faa-tada"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-solid fa-icons faa-tada"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-solid fa-hashtag faa-tada"></i><span> Tags</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="fa-solid fa-dice faa-tada"></i><span> Random</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>My</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/assets/Resume.pdf"><i class="fa-solid fa-file faa-tada"></i><span> Resume</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="fa-solid fa-music faa-tada"></i><span> Music bar</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="fa-solid fa-medal faa-tada"></i><span> Collections</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://cx330tw.notion.site/Bullet-Journal-c79ab73909d94fa387d4b58e85d90494"><i class="fa-solid fa-clipboard-list faa-tada"></i><span> Notes</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>About</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="fa-solid fa-id-badge faa-tada"></i><span> Whoami</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/subscribe/"><i class="fa-solid fa-bell faa-tada"></i><span> Subscribe</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://cx330.tw/"><i class="fa-solid fa-user faa-tada"></i><span> Portfolio</span></a></li></ul></div></div><span class="sidebar-menu-item-title">Tags</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size:.88rem">AI<sup>1</sup></a><a href="/tags/AIS3/" style="font-size:.88rem">AIS3<sup>1</sup></a><a href="/tags/Assembly-Code/" style="font-size:.88rem">Assembly Code<sup>1</sup></a><a href="/tags/Blog/" style="font-size:.88rem">Blog<sup>1</sup></a><a href="/tags/Byte-Code/" style="font-size:.88rem">Byte Code<sup>1</sup></a><a href="/tags/CCEP/" style="font-size:.88rem">CCEP<sup>1</sup></a><a href="/tags/CRT/" style="font-size:.88rem">CRT<sup>1</sup></a><a href="/tags/CTF/" style="font-size:.88rem">CTF<sup>33</sup></a><a href="/tags/Crypto/" style="font-size:.88rem">Crypto<sup>7</sup></a><a href="/tags/Cryptography/" style="font-size:.88rem">Cryptography<sup>2</sup></a><a href="/tags/CyberSec/" style="font-size:.88rem">CyberSec<sup>29</sup></a><a href="/tags/GDSC/" style="font-size:.88rem">GDSC<sup>1</sup></a><a href="/tags/GamePwn/" style="font-size:.88rem">GamePwn<sup>1</sup></a><a href="/tags/HITCON/" style="font-size:.88rem">HITCON<sup>1</sup></a><a href="/tags/HTB/" style="font-size:.88rem">HTB<sup>14</sup></a><a href="/tags/HackTheBox/" style="font-size:.88rem">HackTheBox<sup>10</sup></a><a href="/tags/Hacker/" style="font-size:.88rem">Hacker<sup>1</sup></a><a href="/tags/Hacking/" style="font-size:.88rem">Hacking<sup>1</sup></a><a href="/tags/HacktTheBox/" style="font-size:.88rem">HacktTheBox<sup>1</sup></a><a href="/tags/Hardware/" style="font-size:.88rem">Hardware<sup>2</sup></a><a href="/tags/Machine-Code/" style="font-size:.88rem">Machine Code<sup>1</sup></a><a href="/tags/Math/" style="font-size:.88rem">Math<sup>2</sup></a><a href="/tags/Misc/" style="font-size:.88rem">Misc<sup>1</sup></a><a href="/tags/NCKU/" style="font-size:.88rem">NCKU<sup>1</sup></a><a href="/tags/PicoCTF/" style="font-size:.88rem">PicoCTF<sup>13</sup></a><a href="/tags/Pwn/" style="font-size:.88rem">Pwn<sup>15</sup></a><a href="/tags/Registers/" style="font-size:.88rem">Registers<sup>1</sup></a><a href="/tags/Reverse/" style="font-size:.88rem">Reverse<sup>1</sup></a><a href="/tags/SCIST/" style="font-size:.88rem">SCIST<sup>2</sup></a><a href="/tags/SQLi/" style="font-size:.88rem">SQLi<sup>1</sup></a><a href="/tags/Security/" style="font-size:.88rem">Security<sup>1</sup></a><a href="/tags/TechStreak30/" style="font-size:.88rem">TechStreak30<sup>9</sup></a><a href="/tags/Web/" style="font-size:.88rem">Web<sup>3</sup></a><a href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/" style="font-size:.88rem">密碼學<sup>1</sup></a><a href="/tags/%E7%AD%86%E8%A8%98/" style="font-size:.88rem">筆記<sup>1</sup></a><a href="/tags/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC/" style="font-size:.88rem">網頁開發<sup>1</sup></a><a href="/tags/%E8%B3%87%E5%AE%89/" style="font-size:.88rem">資安<sup>11</sup></a><a href="/tags/%E9%A7%AD%E5%AE%A2/" style="font-size:.88rem">駭客<sup>1</sup></a></div></div><hr></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">简</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="Bullet screen"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">Play music</a><div id="console-music-bg"></div><meting-js id="12295857597" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span> Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Copy</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>Paste</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>Quote it</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>New tab</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>Copy URL</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>Copy image</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>Downlaod</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>New tab</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>Site search</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>Google it</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>Play music</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>Prev track</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>Next track</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/playlist?id=7032963191&amp;userid=6279304773&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>See playlist</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Song name</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>Random post</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>Categories</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>Tags</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Share</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">Bullet screen off</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">Light / Dark</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>Simp / Trad</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script>document.querySelectorAll("#article-container span.katex-display").forEach(a=>{anzhiyu.wrap(a,"div",{class:"katex-wrap"})})</script><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then(({svg:e})=>{d.insertAdjacentHTML("afterend",e)})})},n=()=>{window.loadMermaid?t():getScript("https://cdn.jsdelivr.net/npm/mermaid@10.2.4/dist/mermaid.min.js").then(t)};anzhiyu.addGlobalFn("themeChange",t,"mermaid"),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{const t=()=>{"object"==typeof twikoo?setTimeout(o,0):getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js").then(o)},o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://comments.cx330.tw/",region:"",onCommentLoaded:()=>{anzhiyu.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://comments.cx330.tw/",region:"",urls:[window.location.pathname],includeReply:!1}).then(o=>{t.textContent=o[0].count}).catch(t=>{console.error(t)})})()};t()})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener("load",()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'><div class='name'><span>${e[n].nick} </span></div></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <time datetime="${e[n].date}">${anzhiyu.diffDate(e[n].date,!0)}</time></div>\n        </div>`}else t+="No Comment";let n=document.querySelector("#card-newest-comments .aside-list");n&&(n.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"https://comments.cx330.tw/",region:"",pageSize:6,includeReply:!0}).then((function(t){const n=t.map(e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[image]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[link]")).replace(/<pre><code>.*?<\/pre>/gi,"[code]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t});saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),10/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").textContent="Unable to get the data, please make sure the settings are correct."}))};"object"==typeof twikoo?t():getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)})</script><script async data-pjax src= "/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.0.0/waterfall/waterfall.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]','meta[property="og:type"]','meta[property="og:site_name"]','meta[property="og:description"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(anzhiyu.removeGlobalFnEvent("pjax"),anzhiyu.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","G-PM5RRNPNEB",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>